using Mbs.Numerics.Random;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators
{
    [TestClass]
    public class FractionalBrownianMotionGeneratorTests
    {
        private static readonly double[] ReferenceNormalVariates =
        {
           0.870327472686767578, 0.872923791408538818, 1.94679379463195801, 0.982529520988464355, 0.353964567184448242, -0.126996397972106934, -0.858933150768280029, 0.8771248459815979, 0.931963205337524414, -1.16762077808380127, 0.917911767959594727, 0.735452592372894287, -2.82496857643127441, 0.0138504812493920326, 0.0535906925797462463, 0.754720628261566162, 0.177422583103179932, -0.618633925914764404, 1.01561653614044189, -0.502439200878143311, 1.16913700103759766, -0.670636653900146484, -0.332363426685333252, 1.69178831577301025, 1.51098597049713135, 0.0272739138454198837, 0.351906269788742065, 0.174040630459785461, -1.38039755821228027, 0.81287539005279541, 2.07710671424865723, 0.912619411945343018, -1.12699770927429199, -0.285450637340545654, 1.73047554492950439, 0.317222416400909424, 1.42345750331878662, 1.80037438869476318, -0.52325129508972168, 0.159051001071929932, -0.615600466728210449, -0.0484943725168704987, -0.412370592355728149, 0.350198715925216675, 1.39032626152038574, -0.0754250586032867432, -1.22852277755737305, 1.1050184965133667, 0.308081328868865967, -0.543738305568695068, -2.82706117630004883, -1.17946982383728027, 1.59492182731628418, -0.188286960124969482, -1.10924732685089111, 2.08511018753051758, -1.63332867622375488, -1.13278508186340332, 0.559592068195343018, -0.664163172245025635, 0.415496736764907837, -0.606696069240570068, 0.604893147945404053, -0.496832937002182007, 1.11255717277526855, 1.38928747177124023, -0.116069011390209198, 1.05707275867462158, 1.86125171184539795, 0.223920613527297974, 0.312662363052368164, 0.125260010361671448, 0.317196279764175415, 1.54571020603179932, -0.980655014514923096, -1.36546850204467773, -0.163782835006713867, 0.178817808628082275, 1.08213651180267334, -1.12910091876983643, 0.993131160736083984, -0.721206128597259521, -0.110664695501327515, 1.02527141571044922, 0.799244880676269531, 0.706906020641326904, -0.264671057462692261, -0.768427133560180664, 0.566841483116149902, 0.874387681484222412, 0.431388407945632935, 1.67625689506530762, 0.951827883720397949, -0.603936195373535156, -0.348645150661468506, 0.171555608510971069, -0.502745509147644043, 1.15916788578033447, -0.464192748069763184, -0.00222183368168771267, -0.904798507690429688, -0.315004676580429077, -0.198766604065895081, -1.64410209655761719, 0.476624220609664917, 0.220209613442420959, -0.304318785667419434, -0.690752804279327393, 0.850282073020935059, 1.57088911533355713, -0.0859528630971908569, 0.764994442462921143, 2.90490508079528809, 0.512958407402038574, -0.156104549765586853, -1.00061452388763428, 0.678928256034851074, -1.18796956539154053, -0.372942239046096802, -0.484741896390914917, -0.4131050705909729, 0.618231356143951416, -1.43419301509857178, 1.13526690006256104, -1.0914684534072876, 0.0890651196241378784, -0.339216142892837524, 0.720278441905975342, 1.02349197864532471, 0.368755847215652466, -0.011719919741153717, 0.426307946443557739, 1.25117707252502441, -1.11640405654907227, 1.1889108419418335, 0.668041348457336426, 0.252903550863265991, 0.484917879104614258, 1.24716031551361084, 0.903980910778045654, -0.56255030632019043, -0.718787848949432373, 0.544737517833709717, 0.974768996238708496, -2.27300095558166504, 0.266398847103118896, 0.563491880893707275, 0.75543898344039917, 0.478320837020874023, -0.965509116649627686, 0.171768516302108765, -0.619298636913299561, 2.43214750289916992, -0.784179866313934326, -0.493452221155166626, -0.330218046903610229, 0.104146227240562439, -2.12589097023010254, -1.84358525276184082, 1.77698862552642822, -1.04937493801116943, 1.64797580242156982, 1.90155088901519775, -0.651177048683166504, -1.41112840175628662, -0.230858147144317627, 1.36645424365997314, -0.0383150689303874969, 0.848843216896057129, -0.323533385992050171, 0.304122895002365112, -2.3044285774230957, 0.69829028844833374, -0.550501227378845215, 2.09074711799621582, 1.91455507278442383, 0.0129563063383102417, -1.28405916690826416, -0.666581213474273682, -0.550853073596954346, 0.979559838771820068, 0.878649294376373291, 1.70208871364593506, -0.0991632044315338135, -0.414393514394760132, 0.365694880485534668, 1.76882553100585938, 0.363445043563842773, 2.25905418395996094, -2.54938960075378418, -1.37550973892211914, 0.806594252586364746, -0.275259673595428467, 1.11017656326293945, -0.301673769950866699, 0.0106007736176252365, 0.794883608818054199, 0.542295753955841064, 0.931381046772003174, 1.51793777942657471, -0.387484550476074219, 0.413242518901824951, -1.06394243240356445, 1.08176875114440918, 0.343272864818572998, 0.734676003456115723, -1.31797099113464355, 0.671307384967803955, -1.10123324394226074, 1.15801572799682617, 0.299462676048278809, 1.46627461910247803, 0.0161528866738080978, -0.580783247947692871, -2.25738787651062012, -0.87828218936920166, -1.87202942371368408, 1.09397125244140625, -0.605221569538116455, 0.0501569509506225586, -0.740556716918945313, 1.13957059383392334, -0.376897633075714111, -2.11834430694580078, -0.602122664451599121, -0.963766813278198242, -0.430991560220718384, 0.541830539703369141, 0.935856997966766357, 0.540648937225341797, -0.713665544986724854, 0.42097705602645874, 0.684159696102142334, -0.779258906841278076, 1.23366808891296387, -0.0763688385486602783, -0.351617902517318726, -0.158942103385925293, -1.16228783130645752, -0.381254404783248901, 0.195617228746414185, 1.65819299221038818, -0.285907357931137085, -0.661535084247589111, 1.09275209903717041, 0.566246688365936279, 0.279147475957870483, 1.21731185913085938, 0.487738370895385742, 0.455638527870178223, 1.11526143550872803, -1.03416383266448975, -0.974649608135223389, -1.93523800373077393, 0.13398173451423645, -1.40237140655517578, -1.40808582305908203, 0.885036766529083252, 0.814822793006896973, 0.711565494537353516
        };

        private static readonly int ReferenceNormalVariatesLength = ReferenceNormalVariates.Length;

        private static readonly ReferenceDataInfo[] ReferenceDataHosking =
        {
            new ReferenceDataInfo
            {
                Name = "(1) MaxValue=100, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.495151929240945921, 0.564736466438531592, 1.1985016019386312, 0.761396023815859357, 0.386976183116742589, 0.0733321142847053603, -0.388786695614026456, 0.505178996630074595, 0.62910609717252397, -0.51332483004526186, 0.516224328140854061, 0.517302052602570339, -1.4600382555285063, -0.126331536556653828, 0.00301759416741444794, 0.4216619041504725, 0.162457170084458924, -0.298591015407785487, 0.557254191087688144, -0.194691169781880447, 0.665138659961688861, -0.265234508668050817, -0.176091934258519073, 0.949354322432958475, 0.992037256824770397, 0.20629170906659075, 0.30874578626461785, 0.209615642490674936, -0.67790512579104456, 0.426288023790969195, 1.24614419412960142, 0.725288607992003898, -0.443756798103099259, -0.123134053789831957, 1.00978918760576919, 0.359846370284298167, 0.930435252256022527, 1.21680484587056359, -0.0239646259923695891, 0.217402313592784613, -0.216238580396167168, 0.0341640678977961007, -0.159440907157158751, 0.23654844919173193, 0.861163657292917994, 0.131667424163289637, -0.584680363042364259, 0.614949307537375645, 0.295370808565315002, -0.199224680549843519, -1.54476095042613726, -0.823045747401273897, 0.763014835196728525, -0.0359391379548656617, -0.608644080203419091, 1.10269306783005261, -0.774070245524703715, -0.693701929448515386, 0.22288837844972792, -0.361716454991905634, 0.186175084313442457, -0.324226146135118409, 0.300744389075473906, -0.244099679815629467, 0.602563320382045187, 0.861871072781483782, 0.0814975438944753466, 0.66220267824719603, 1.17991885298916355, 0.350495501537871346, 0.32144320709396168, 0.201407532883996293, 0.286832392246148093, 0.979718889733299125, -0.343590272470530644, -0.711338217694732489, -0.124167576307093172, 0.110231772818229615, 0.647915195226198337, -0.511822193401461067, 0.546011266961740627, -0.303343155181052537, -0.0525953250803732966, 0.597845978910561016, 0.557128235929765014, 0.524575229686835898, -0.0108261154660011707, -0.357772573001749472, 0.328106096264816793, 0.570429186682219092, 0.368204503779944403, 1.0563906631173765, 0.746957464605087607, -0.136089715348549134, -0.104885101303299366, 0.161610785029399517, -0.196523032264017766, 0.686833276886347432, -0.118905270094635876, 0.0565427429368644818, -0.443253879097356474, -0.184083746270992443, -0.107155379719583582, -0.912222905233943449, 0.16591371027979232, 0.133338822557098141, -0.144321799522785454, -0.388812098704741205, 0.436565836199496904, 0.939437242540797635, 0.104019422913925755, 0.503922887607908154, 1.74798980451030928, 0.588010206113583678, 0.115184064114660478, -0.430807729574886333, 0.415272987630558477, -0.551264753166056609, -0.213101110086290929, -0.263085926376449508, -0.237492078962556058, 0.335628033450157126, -0.743223500501721479, 0.569517505037123617, -0.534214411727463978, 0.0103002766156140204, -0.181894164328842006, 0.392204270368765706, 0.635459375099247326, 0.321739865272338388, 0.0885177997507087116, 0.304807478431338541, 0.79010034930802131, -0.465928154290239704, 0.679894661992871963, 0.507701712187438647, 0.277111887872222407, 0.38460954704323308, 0.823612735855563383, 0.694403877782893142, -0.124566700511007808, -0.314900993857468225, 0.340717522523690919, 0.646952451587514576, -1.1214753047010011, 0.0804230051830607945, 0.349004781944824538, 0.503893575122537851, 0.385322386885354251, -0.424783968577668924, 0.108076317435153751, -0.292424933272376231, 1.36791960577218941, -0.224850873527730283, -0.219915780865414134, -0.156724722847725151, 0.0789004960262642552, -1.14779745451797033, -1.15298102092657406, 0.826967944809607114, -0.52132078204657073, 0.866082615856617943, 1.17591101908551443, -0.168767082305161048, -0.736751067913317903, -0.179827365919252413, 0.752934804938661051, 0.090517794495219836, 0.534000985160988595, -0.0680472938126026744, 0.218274859977195645, -1.21956920981837991, 0.272255911719109511, -0.282349505866868133, 1.14816319965690439, 1.23474462835160548, 0.233236315629242769, -0.592987917389661834, -0.374536575723354193, -0.321323129480666714, 0.52733591484120268, 0.576366703491842269, 1.07224551061071383, 0.148313381911808734, -0.120981647121086805, 0.264163791210917265, 1.08431330248086066, 0.412154573353338549, 1.42015306996029134, -1.14321546254304152, -0.792966915283839779, 0.399290713265071651, -0.0794161837210104471, 0.657529006131045479, -0.0401694768668378888, 0.0660649455551749754, 0.507721855147992507, 0.423247072710841665, 0.646282161328610494, 1.01248880149792675, 0.00827537299863908941, 0.345931803251066983, -0.460629364979139644, 0.633027959742278656, 0.33448195212724352, 0.537292560345124848, -0.584372856657239037, 0.388344408946092456, -0.513132583446812895, 0.646191576853099248, 0.293479614396090771, 0.928927219958377015, 0.205145530999737091, -0.199362117681038009, -1.20564352231186733, -0.591787031997439539, -1.12161409789500222, 0.457682654708413128, -0.312981381740759623, -0.0084929130833795545, -0.418348282452808695, 0.587629162580288411, -0.138538714428427384, -1.18055958908114844, -0.481509652850878711, -0.637638501680065639, -0.362559709231268346, 0.210022843969435796, 0.51204044872604515, 0.355888368436475144, -0.341232262999200731, 0.212006880629182493, 0.415102793369609369, -0.366390720261667135, 0.671804160437395104, 0.0567561713074197921, -0.151247581408358117, -0.0779096548904772007, -0.642209374923815801, -0.285134676768338868, 0.0605690264379301624, 0.925175183082022734, -0.0360070618084477115, -0.335166397067951427, 0.595320801824970602, 0.408049772568546465, 0.248653578612203913, 0.762343557315043108, 0.423562091880631986, 0.382158702874817791, 0.747817730203230391, -0.406990751505967585, -0.51408604630931265, -1.10376279185450299, -0.0505572066334513681, -0.811561933409065905 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-4
            },
            new ReferenceDataInfo
            {
                Name = "(2) MaxValue=100, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.495151929240945921, 1.05988839567947757, 2.25838999761810877, 3.01978602143396824, 3.40676220455071066, 3.48009431883541609, 3.09130762322138963, 3.59648661985146401, 4.22559271702398753, 3.71226788697872578, 4.22849221511958007, 4.74579426772215029, 3.28575601219364399, 3.15942447563699025, 3.1624420698044049, 3.58410397395487745, 3.74656114403933627, 3.44797012863155095, 4.00522431971923876, 3.81053314993735848, 4.47567180989904756, 4.21043730123099635, 4.03434536697247736, 4.98369968940543551, 5.97573694623020568, 6.18202865529679624, 6.49077444156141414, 6.70039008405208936, 6.02248495826104513, 6.44877298205201477, 7.69491717618161619, 8.42020578417361953, 7.97644898607051989, 7.85331493228068833, 8.86310411988645797, 9.22295049017075641, 10.1533857424267797, 11.3701905882973442, 11.3462259623049739, 11.5636282758977593, 11.347389695501592, 11.3815537633993884, 11.2221128562422301, 11.4586613054339619, 12.3198249627268801, 12.4514923868901697, 11.866812023847805, 12.4817613313851812, 12.7771321399504956, 12.5779074594006524, 11.0331465089745144, 10.2101007615732406, 10.9731155967699685, 10.9371764588151024, 10.3285323786116834, 11.4312254464417364, 10.6571552009170318, 9.96345327146851645, 10.1863416499182442, 9.82462519492633923, 10.0108002792397812, 9.68657413310466353, 9.98731852218013749, 9.74321884236450764, 10.345782162746552, 11.2076532355280349, 11.2891507794225099, 11.9513534576697058, 13.1312723106588685, 13.4817678121967397, 13.8032110192907016, 14.0046185521746978, 14.2914509444208466, 15.2711698341541453, 14.9275795616836149, 14.216241343988882, 14.0920737676817893, 14.2023055405000189, 14.8502207357262179, 14.3383985423247573, 14.8844098092864972, 14.5810666541054452, 14.5284713290250718, 15.1263173079356328, 15.6834455438653979, 16.208020773552235, 16.1971946580862323, 15.8394220850844825, 16.1675281813493008, 16.7379573680315197, 17.1061618718114659, 18.1625525349288424, 18.9095099995339311, 18.7734202841853808, 18.6685351828820814, 18.8301459679114807, 18.6336229356474625, 19.3204562125338093, 19.201550942439173, 19.2580936853760392, 18.8148398062786839, 18.6307560600076911, 18.5236006802881086, 17.6113777750541658, 17.7772914853339579, 17.9106303078910543, 17.7663085083682688, 17.3774964096635287, 17.814062245863024, 18.753499488403822, 18.8575189113177473, 19.3614417989256538, 21.1094316034359615, 21.6974418095495452, 21.8126258736642065, 21.3818181440893191, 21.7970911317198777, 21.2458263785538222, 21.0327252684675301, 20.7696393420910823, 20.5321472631285253, 20.8677752965786816, 20.1245517960769611, 20.6940693011140837, 20.1598548893866187, 20.1701551660022318, 19.9882610016733899, 20.3804652720421551, 21.0159246471414036, 21.3376645124137418, 21.4261823121644497, 21.7309897905957889, 22.5210901399038086, 22.0551619856135694, 22.7350566476064415, 23.2427583597938785, 23.5198702476661019, 23.904479794709335, 24.7280925305648971, 25.42249640834779, 25.2979297078367829, 24.9830287139793157, 25.3237462365030055, 25.9706986880905184, 24.8492233833895177, 24.9296463885725785, 25.2786511705174028, 25.7825447456399424, 26.1678671325252949, 25.7430831639476274, 25.8511594813827799, 25.5587345481104045, 26.9266541538825948, 26.7018032803548628, 26.4818874994894493, 26.3251627766417258, 26.4040632726679902, 25.2562658181500197, 24.103284797223445, 24.9302527420330513, 24.4089319599864822, 25.2750145758431017, 26.4509255949286164, 26.2821585126234538, 25.5454074447101362, 25.3655800787908845, 26.1185148837295458, 26.2090326782247658, 26.7430336633857557, 26.6749863695731513, 26.8932612295503475, 25.6736920197319662, 25.9459479314510766, 25.6635984255842082, 26.8117616252411111, 28.0465062535927174, 28.2797425692219591, 27.6867546518322989, 27.3122180761089446, 26.990894946628277, 27.5182308614694797, 28.0945975649613224, 29.1668430755720358, 29.3151564574838446, 29.1941748103627567, 29.4583386015736757, 30.5426519040545372, 30.9548064774078746, 32.3749595473681637, 31.2317440848251238, 30.4387771695412823, 30.838067882806353, 30.7586516990853411, 31.4161807052163873, 31.3760112283495509, 31.4420761739047272, 31.9497980290527188, 32.3730451017635588, 33.0193272630921726, 34.031816064590096, 34.0400914375887353, 34.3860232408398048, 33.9253938758606637, 34.5584218356029425, 34.8929037877301838, 35.4301963480753059, 34.8458234914180665, 35.2341679003641559, 34.7210353169173445, 35.367226893770443, 35.660706508166534, 36.5896337281249089, 36.7947792591246454, 36.5954171414436047, 35.3897736191317378, 34.7979865871342966, 33.6763724892392915, 34.1340551439477053, 33.8210737622069431, 33.8125808491235631, 33.3942325666707518, 33.9818617292510368, 33.8433230148226087, 32.6627634257414599, 32.1812537728905781, 31.5436152712105127, 31.181055561979246, 31.3910784059486829, 31.9031188546747266, 32.2590072231112046, 31.9177749601120055, 32.1297818407411881, 32.5448846341108009, 32.178493913849131, 32.8502980742865276, 32.9070542455939474, 32.7558066641855916, 32.6778970092951155, 32.0356876343712997, 31.7505529576029595, 31.8111219840408879, 32.7362971671229133, 32.7002901053144654, 32.3651237082465144, 32.9604445100714827, 33.3684942826400288, 33.617147861252235, 34.3794914185672766, 34.80305351044791, 35.1852122133227283, 35.933029943525959, 35.5260391920199936, 35.0119531457106774, 33.9081903538561775, 33.8576331472227281, 33.0460712138136614 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-4
            },
            new ReferenceDataInfo
            {
                Name = "(3) MaxValue=1, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.0312419746388111763, 0.0356324621195183641, 0.0756203388114456421, 0.0480408413284632574, 0.0244165464876420872, 0.00462694360941957438, -0.0245307821033855303, 0.0318746398200880354, 0.0396939112468274111, -0.0323886071621104915, 0.0325715531239825148, 0.0326395529404270995, -0.0921221860547760257, -0.0079709810829888747, 0.00019039732025907398, 0.0266050675311243871, 0.0102503544628257288, -0.0188398194167340785, 0.0351603624609145848, -0.0122841823479317731, 0.0419674122600541474, -0.0167351661253702134, -0.0111106499224135971, 0.0599002082253092608, 0.0625933193191572507, 0.01301612689409367, 0.0194805421420972576, 0.0132258529147425818, -0.0427729217978628853, 0.0268969559474859336, 0.0786263831567423771, 0.045762617408037061, -0.0279991610926164751, -0.00776923355943136447, 0.0637133904296547787, 0.022704771021541708, 0.0587064955974218733, 0.0767751954301121586, -0.00151206567776065309, 0.0137171586468353597, -0.0136437320460932408, 0.00215560695574344447, -0.010060041138139391, 0.0149251981342923088, 0.0543357534368390724, 0.00830765283046164607, -0.0368908369234925496, 0.038800678207371625, 0.0186366381009338694, -0.012570227539464407, -0.097467826713757505, -0.051930675916602366, 0.0481429814214720114, -0.00226760630469093625, -0.0384028452578739077, 0.0695752289854767586, -0.0488405306557398236, -0.0437696327265621604, 0.0140633059382136646, -0.0228227653896482113, 0.0117468536806785723, -0.0204572868176461364, 0.0189756881098379036, -0.0154016485764934992, 0.0380191752509423109, 0.054380388336650036, 0.0051421473877316156, 0.0417821643374522642, 0.0744478466184158166, 0.0221147710902588786, 0.020281695234920287, 0.0127079562106793484, 0.0180979004522530754, 0.0618160829003205625, -0.0216790805907232029, -0.0448824072863942061, -0.0078344444217265264, 0.0069551546654734106, 0.0408806851028288079, -0.0322937971994613771, 0.0344509819058445715, -0.0191396591659280108, -0.00331854066447848442, 0.0377215311261569139, 0.0351524152277179133, 0.033098459390329335, -0.000683081706546404812, -0.022573923258902992, 0.0207020951207011472, 0.0359916484843009407, 0.0232321335930640999, 0.0666537447534210209, 0.047129829830688405, -0.00858668054073859557, -0.00661780249938658232, 0.0101969511761509282, -0.012399765056649999, 0.0433362500484839042, -0.00750241534636115863, 0.00356760589330702184, -0.027967429048581266, -0.0116148991709111062, -0.00676104738346352055, -0.0575573741860415933, 0.0104684474050993903, 0.00841311093967423394, -0.00910608993774995358, -0.0245323849300514291, 0.0275454420699209578, 0.0592744827859336895, 0.00656318188561327582, 0.0317953846987876557, 0.110290700523227689, 0.0371009358176677823, 0.00726762312202224904, -0.0271821301034111465, 0.0262019541509733306, -0.0347824544763184265, -0.0134457710525827442, -0.0165995997476596178, -0.0149847371477294725, 0.0211766972718820598, -0.0468942326231839776, 0.0359341252613208581, -0.0337066506606609265, 0.000649903518079925384, -0.011476745890137004, 0.024746416492566814, 0.0400947759837664147, 0.0203004131005649763, 0.00558509558699366807, 0.0192320517168741156, 0.0498519618272262183, -0.0293980790949527372, 0.0428984530457281049, 0.0320338124109833602, 0.0174845780895750494, 0.0242672218464128307, 0.0519664504695493135, 0.043813922672264291, -0.00785962745650850038, -0.0198689094858481782, 0.0214978223229418432, 0.0408199400858608938, -0.0707603080154259184, 0.00507434857854208599, 0.0220207130426795378, 0.031793535205994726, 0.0243121989997952745, -0.0268020564791523822, 0.00681915462500830207, -0.01845076593573362, 0.0863098921920413403, -0.0141871310065108478, -0.0138757477104129792, -0.00988866149423949306, 0.00497828474509017394, -0.0724211233903784002, -0.0727481843199893341, 0.0521781498427312737, -0.0328931176262441879, 0.0546461187401350926, 0.0741949693947193956, -0.0106484830086934611, -0.0464858497353533573, -0.0113463397265279511, 0.0475069745090809861, 0.00571128672429077611, 0.0336931843546984452, -0.00429349398030632722, 0.0137722126017997375, -0.0769496150036812626, 0.0171781867077323257, -0.0178150494437053844, 0.0724442003485402247, 0.0779071191815912112, 0.0147162166345771207, -0.0374150081665021242, -0.0236316603229112347, -0.0202741188497186746, 0.0332726468477238593, 0.0363662804682015686, 0.067654118000574498, 0.00935794176019515492, -0.00763342587983607476, 0.0166676084210260582, 0.0684155441917872337, 0.0260051955118389515, 0.0896056009777539408, -0.0721320192414853234, -0.0500328299128141862, 0.025193540811733188, -0.00501082243893598983, 0.0414872755627145109, -0.00253452264530585865, 0.0041684162610721746, 0.0320350833458734677, 0.0267050849056647902, 0.0407776476296819873, 0.0638837245509065316, 0.000522140737180441404, 0.0218268211950537888, -0.0290637480916835673, 0.0399413640460702796, 0.0211043844290756677, 0.0339008687084323898, -0.0368714345822756112, 0.0245028757012356706, -0.0323764772217862221, 0.0407719321356700207, 0.0185173118158428497, 0.058611345192030595, 0.0129438079471573281, -0.0125788992361975521, -0.07607096352276424, -0.0373392374206919647, -0.070769065273937809, 0.0288778232429465556, -0.0197477901494891341, -0.000535866588599025391, -0.0263959921364274007, 0.0370768935960778534, -0.00874120193634603596, -0.0744882743327269503, -0.0303812051904370148, -0.0402322695758383433, -0.0228759711352072084, 0.013251545591113318, 0.032307568179463203, 0.0224550379880066979, -0.0215303002512942585, 0.013376729841331831, 0.0261912156190799092, -0.023117691589848683, 0.0423879769080324487, 0.00358107231309925294, -0.00954307723244694935, -0.0049157668959063797, -0.0405206721802215605, -0.0179907818472969348, 0.00382164720790270336, 0.0583746076696409696, -0.00227189201011923549, -0.0211475699852988648, 0.0375622032233302802, 0.0257462000915596873, 0.015688980165665313, 0.048100626650508356, 0.026724961271547918, 0.0241125840335890199, 0.047184108920423587, -0.0256793803798203504, -0.0324366366613645513, -0.0696427240084561416, -0.0031899440841778883, -0.0512060962384995599 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-5
            },
            new ReferenceDataInfo
            {
                Name = "(4) MaxValue=1, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.0312419746388111763, 0.0668744367583295474, 0.142494775569775189, 0.190535616898238447, 0.214952163385880524, 0.219579106995300088, 0.195048324891914565, 0.226922964712002601, 0.266616875958829991, 0.234228268796719485, 0.266799821920702007, 0.299439374861129093, 0.207317188806353081, 0.199346207723364199, 0.199536605043623277, 0.226141672574747654, 0.236392027037573393, 0.217552207620839322, 0.252712570081753907, 0.240428387733822135, 0.282395799993876262, 0.265660633868506024, 0.254549983946092406, 0.314450192171401688, 0.377043511490558925, 0.390059638384652574, 0.409540180526749842, 0.422766033441492439, 0.379993111643629533, 0.406890067591115456, 0.48551645074785782, 0.531279068155894874, 0.503279907063278409, 0.495510673503847032, 0.559224063933501769, 0.581928834955043439, 0.640635330552465354, 0.717410525982577485, 0.715898460304816853, 0.729615618951652167, 0.715971886905558907, 0.718127493861302368, 0.70806745272316296, 0.722992650857455232, 0.777328404294294284, 0.785636057124755927, 0.748745220201263328, 0.787545898408634981, 0.806182536509568837, 0.793612308970104374, 0.696144482256346842, 0.644213806339744455, 0.692356787761216452, 0.690089181456525536, 0.651686336198651572, 0.721261565184128317, 0.672421034528388528, 0.628651401801826326, 0.642714707740040025, 0.6198919423503918, 0.631638796031070426, 0.61118150921342429, 0.630157197323262142, 0.614755548746768632, 0.652774723997710971, 0.707155112334361013, 0.712297259722092679, 0.754079424059544978, 0.828527270677960836, 0.85064204176821967, 0.870923737003139964, 0.883631693213819291, 0.901729593666072415, 0.963545676566393006, 0.941866595975669796, 0.896984188689275541, 0.889149744267549003, 0.896104898933022365, 0.936985584035851193, 0.904691786836389844, 0.939142768742234457, 0.920003109576306488, 0.916684568911828035, 0.954406100037984984, 0.989558515265702932, 1.02265697465603234, 1.02197389294948593, 0.999399969690582979, 1.02010206481128418, 1.05609371329558521, 1.0793258468886493, 1.14597959164207031, 1.19310942147275867, 1.18452274093202004, 1.17790493843263344, 1.18810188960878427, 1.17570212455213419, 1.21903837460061815, 1.21153595925425694, 1.2151035651475639, 1.18713613609898272, 1.17552123692807164, 1.16876018954460803, 1.11120281535856646, 1.1216712627636658, 1.13008437370334014, 1.12097828376559017, 1.09644589883553878, 1.12399134090545982, 1.18326582369139355, 1.18982900557700688, 1.22162439027579461, 1.33191509079902226, 1.36901602661668997, 1.37628364973871231, 1.34910151963530112, 1.37530347378627438, 1.34052101930995593, 1.32707524825737311, 1.31047564850971354, 1.29549091136198413, 1.31666760863386623, 1.26977337601068219, 1.30570750127200297, 1.27200085061134205, 1.27265075412942208, 1.26117400823928505, 1.28592042473185186, 1.32601520071561829, 1.34631561381618337, 1.35190070940317697, 1.371132761120051, 1.42098472294727718, 1.39158664385232433, 1.43448509689805248, 1.46651890930903583, 1.48400348739861099, 1.50827070924502382, 1.56023715971457322, 1.60405108238683747, 1.59619145493032888, 1.57632254544448069, 1.59782036776742253, 1.63864030785328341, 1.56787999983785742, 1.57295434841639947, 1.59497506145907897, 1.62676859666507378, 1.65108079566486898, 1.62427873918571652, 1.63109789381072479, 1.6126471278749912, 1.69895702006703253, 1.68476988906052161, 1.67089414135010861, 1.6610054798558691, 1.6659837646009592, 1.59356264121058078, 1.52081445689059147, 1.57299260673332264, 1.5400994891070785, 1.59474560784721353, 1.66894057724193301, 1.65829209423323953, 1.61180624449788623, 1.60045990477135835, 1.64796687928043939, 1.65367816600473017, 1.68737135035942853, 1.68307785637912222, 1.69685006898092205, 1.61990045397724081, 1.63707864068497311, 1.61926359124126762, 1.69170779158980777, 1.76961491077139899, 1.7843311274059761, 1.74691611923947399, 1.72328445891656279, 1.70301034006684415, 1.73628298691456795, 1.77264926738276962, 1.84030338538334415, 1.84966132714353937, 1.8420279012637033, 1.8586955096847293, 1.9271110538765166, 1.9531162493883556, 2.04272185036610932, 1.97058983112462394, 1.92055700121180983, 1.94575054202354303, 1.940739719584607, 1.98222699514732148, 1.97969247250201552, 1.98386088876308775, 2.01589597210896132, 2.04260105701462624, 2.08337870464430841, 2.14726242919521493, 2.14778456993239519, 2.16961139112744883, 2.14054764303576528, 2.18048900708183568, 2.20159339151091116, 2.2354942602193435, 2.1986228256370679, 2.22312570133830345, 2.19074922411651718, 2.23152115625218705, 2.2500384680680301, 2.30864981326006058, 2.32159362120721813, 2.30901472197102064, 2.23294375844825632, 2.19560452102756454, 2.12483545575362687, 2.15371327899657361, 2.13396548884708448, 2.13342962225848565, 2.10703363012205847, 2.14411052371813637, 2.1353693217817904, 2.06088104744906353, 2.03049984225862667, 1.99026757268278831, 1.96739160154758119, 1.98064314713869449, 2.01295071531815761, 2.03540575330616447, 2.01387545305487015, 2.02725218289620202, 2.05344339851528179, 2.03032570692543324, 2.07271368383346566, 2.07629475614656478, 2.06675167891411782, 2.06183591201821148, 2.02131523983798989, 2.00332445799069303, 2.00714610519859571, 2.06552071286823669, 2.06324882085811767, 2.04210125087281869, 2.07966345409614917, 2.10540965418770876, 2.1210986343533742, 2.16919926100388238, 2.19592422227543027, 2.22003680630901945, 2.26722091522944291, 2.2415415348496226, 2.20910489818825795, 2.13946217417980167, 2.13627223009562384, 2.08506613385712436 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-5
            }
        };

        private static readonly ReferenceDataInfo[] ReferenceDataPaxson =
        {
            new ReferenceDataInfo
            {
                Name = "(1) MaxValue=100, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.88884154631512502, 0.0589342094175980616, -0.321532769135939422, -0.0450109304187231996, 0.254747479757555462, -0.478958710312134606, 0.545365383022022532, -0.114364721362648636, -0.00922980416574240015, -0.24472931880010465, -0.224308142888634765, 0.193956501263545078, 0.123964828802498442, 0.0650605488238848451, 0.912895229612288195, 0.625861142713073249, -0.224913376578547403, -0.0398344694012822131, 0.143590497494975933, -0.116847495650934774, -0.250928003713551562, -0.132829285570399858, 0.634878616443431576, 0.432413845959655097, 0.0910496995465772813, -0.488377737633597708, -0.388810741502974178, 1.37994575317073909, -0.0291348856437087834, -0.945927308032541658, -0.0399000461119232777, 0.807042910908401412, -0.92289814734550768, 0.0733397821074055489, -0.543016929592902042, -0.0836175879531423499, -0.157758023706722567, 0.0265943836860886088, -1.1172287265286811, -0.197988735323757659, -0.348102963078103511, 0.555794023754564548, -1.27685206364463544, 0.209743885152289311, 0.916708696365172826, -0.613278171096352409, 0.12231328296586183, -0.716666888431402027, -0.734498173847776381, -0.0136513544519430274, 0.00572997436118297641, 0.268115751816162207, -0.377752188381081877, 0.575699204084486937, -0.0599401842031789256, 0.781591837072067475, -0.585596498869584425, 0.213355220100829912, -0.0224831480541200189, 0.0756614000225870609, 0.296249833793088668, -0.591076595293078433, -0.0782749799018655074, 0.288372305666538209, -0.961303452775174372, 0.345053292125308331, -0.215893589392170376, 0.107037862950613127, -1.485946072692097, -0.379963016111406204, -0.736813115656016704, -1.15670749997930589, 0.0954316137412033888, -0.489837530563440093, -1.52195215695230268, -0.283321462304724103, 0.574546588516797185, -0.556011022584869896, 0.354305881231101072, 0.115966540711318997, -0.937370441391113807, 0.537127530605110537, 1.05096325141270586, -0.538012494555476395, 0.731605064116683468, -0.858626320136409382, -1.26428216628765444, 0.161258621505077859, -1.08631759117240345, 0.324064448811920591, 0.0211836813437361118, -0.317709697721970885, 0.308577953065468036, 0.0829281639394763709, 0.6848498071673782, 0.942659551997062306, 0.354288517103012568, 0.200696352301780401, 0.207407707531794661, -0.213121197160151599, 0.404818329547499856, 0.165467301507016107, -0.208618430442354869, 0.997359624668852307, -0.150361119950800093, -0.879999026728889744, -0.512792910447737449, -0.333366060084768767, -0.462832486453004843, -0.482821463251600136, 0.752783785921418924, -0.213258903664805072, 0.0807124418165549584, 0.27658653546011186, 0.699910734473298768, -0.19476343915668215, 0.759393173973285984, 0.384148589512347038, -0.554136918847519366, -0.284898518357668606, 0.139626599797541301, -0.0968642902663930522, 0.584558418462853502, 0.180323387675968894, 1.36674193903834329, 0.929260566271598809, 0.0962171359611281585, 0.125045935305620581, -0.545382730141554029, -0.4110305715433617, 0.451185494119129171, 0.780404423783876422, -0.543935754376209224, -0.441556932697804938, 0.305782197535868216, 0.203005862045809504, -0.843298946927447113, -0.829535910186297354, -0.284471591162479609, -0.609822771819763965, -0.490336868998647923, -1.06904618006079999, 0.155929666696422164, 1.07518426137137735, 0.63511336853304512, 0.121245343349249912, -0.0738916787783117229, -0.296463240304737807, -0.87295617758216093, -0.458315539510195546, -0.433464884876364198, -1.58398181678560612, -0.188788841272387292, 0.518251026200811205, 0.497664648988024427, -1.03347451373527788, 0.967324746020722381, -0.230369222894053122, 0.00793121841243951339, 0.6031929565836055, 0.749579492812400994, 0.30086735128055625, 1.26610335493148241, 0.915340913244228727, -0.0331262942800529606, 0.195975275202709243, -0.339624949815907184, -0.617652861145046139, -0.387792997005864615, 0.489233092630207478, 0.388229912288674317, 0.738542514227220059, 0.203675296359574126, 0.054218119569402444, -0.479484070295812581, -0.413362452660558821, -0.0572150534275169403, 0.0343609886121656397, -0.358407319641804556, -0.168535663418307419, 0.0320986253762194432, -0.0947520049688457683, -0.42366593729679719, -0.421255030662558594, -0.266293462434535666, -0.780871922943852881, -0.0259568557325164789, -0.622081047645813401, 0.46915490339380661, 0.545515426334223341, -1.11953696062932706, 0.119393735862099268, 0.177400874634101924, -0.829292694545917586, -0.79072248472649187, -1.12247187327327014, -1.07592819791167327, 0.149343361809299968, 0.364941493376637949, 0.579415957261187442, 1.37997620400793197, -0.26124592782508671, 0.281299114277191065, -0.604911616608041824, -0.0262157959567172714, -0.247626373703521974, 0.405103591898746118, 0.121710253374896563, 0.424763901836837487, 0.426107716183887819, 0.345835729312315765, 0.00346916046497403822, 0.656763734796867227, 0.705553948450191704, 0.148276782907018956, -0.103518742517523105, -0.182794189505901261, 0.263090728383293004, 0.576687584286714072, -0.289497853062580135, -0.421193003383359799, -0.980716586033670845, -0.369448818727831307, 0.244194877925971804, -0.131967141075321787, -0.047468328035058599, 0.666009950401793227, 0.330937752836032162, -0.672908753410238925, 0.262634164649524049, 0.35628340187225449, -0.14149966160059621, 0.758310612109622362, 1.46211928758889664, 0.481595328750673679, -0.655630546510793444, -0.0290619793203605037, 0.224344876785796149, 1.04434253947089406, 0.529574687088495755, 0.453303291053697988, 0.629876195445836062, 0.254182657114595256, 0.70312261978534385, -0.611649040766105934, 0.228148502619863969, -1.02846331714165307, -0.321291635266052145, 0.922374648662063978, -0.729204090890277601, 1.25684629851677832, 0.277506182867104045, 0.0414746768982859823, 0.882276357208392259, -0.0273107935409716042, 0.911572038263684825 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-4
            },
            new ReferenceDataInfo
            {
                Name = "(2) MaxValue=100, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.88884154631512502, 0.947775755732723102, 0.62624298659678368, 0.581232056178060508, 0.835979535935615914, 0.357020825623481308, 0.902386208645503896, 0.78802148728285526, 0.778791683117112887, 0.534062364317008265, 0.3097542214283735, 0.503710722691918633, 0.627675551494417117, 0.692736100318301906, 1.60563132993059021, 2.23149247264366357, 2.0065790960651162, 1.96674462666383398, 2.11033512415880997, 1.99348762850787509, 1.74255962479432358, 1.60973033922392372, 2.24460895566735541, 2.67702280162701056, 2.76807250117358805, 2.27969476353999045, 1.89088402203701622, 3.27082977520775531, 3.24169488956404672, 2.29576758153150529, 2.25586753541958185, 3.06291044632798304, 2.14001229898247525, 2.21335208108988102, 1.67033515149697909, 1.58671756354383664, 1.42895953983711399, 1.45555392352320268, 0.338325196994521571, 0.140336461670763912, -0.207766501407339599, 0.348027522347224949, -0.928824541297410544, -0.719080656145121289, 0.197628040220051537, -0.415650130876300872, -0.293336847910439014, -1.01000373634184104, -1.74450191018961753, -1.75815326464156052, -1.75242329028037758, -1.48430753846421526, -1.86205972684529719, -1.28636052276081037, -1.3463007069639894, -0.564708869891921927, -1.15030536876150635, -0.936950148660676385, -0.95943329671479638, -0.883771896692209347, -0.587522062899120678, -1.178598658192199, -1.2568736380940646, -0.968501332427526451, -1.92980478520270093, -1.58475149307739249, -1.80064508246956279, -1.69360721951894977, -3.17955329221104677, -3.5595163083224528, -4.29632942397846929, -5.45303692395777517, -5.35760531021657194, -5.84744284078001186, -7.36939499773231432, -7.65271646003703854, -7.07816987152024168, -7.63418089410511147, -7.27987501287400995, -7.16390847216269133, -8.10127891355380569, -7.56415138294869482, -6.51318813153598875, -7.05120062609146547, -6.31959556197478189, -7.17822188211119094, -8.44250404839884538, -8.28124542689376675, -9.36756301806616953, -9.04349856925424866, -9.02231488791051284, -9.34002458563248439, -9.03144663256701641, -8.9485184686275403, -8.26366866146016221, -7.32100910946310002, -6.96672059236008767, -6.76602424005830727, -6.55861653252651244, -6.77173772968666388, -6.3669194001391638, -6.20145209863214752, -6.41007052907450259, -5.4127109044056505, -5.56307202435645021, -6.44307105108534017, -6.95586396153307795, -7.28923002161784694, -7.75206250807085162, -8.23488397132245176, -7.48210018540103317, -7.6953590890658381, -7.61464664724928308, -7.33806011178917128, -6.63814937731587218, -6.83291281647255389, -6.07351964249926812, -5.68937105298692103, -6.24350797183444062, -6.5284064901921095, -6.38877989039456828, -6.48564418066096149, -5.90108576219810832, -5.7207623745221392, -4.35402043548379591, -3.42475986921219722, -3.32854273325106886, -3.20349679794544828, -3.7488795280870022, -4.15991009963036351, -3.70872460551123417, -2.92832018172735786, -3.4722559361035672, -3.91381286880137225, -3.60803067126550392, -3.40502480921969441, -4.24832375614714142, -5.07785966633343833, -5.3623312574959181, -5.97215402931568207, -6.46249089831433032, -7.53153707837513053, -7.37560741167870848, -6.30042315030733135, -5.6653097817742859, -5.54406443842503638, -5.61795611720334787, -5.91441935750808589, -6.78737553509024671, -7.24569107460044215, -7.67915595947680618, -9.26313777626241297, -9.45192661753480046, -8.93367559133398892, -8.43601094234596438, -9.4694854560812427, -8.50216071006052054, -8.73252993295457358, -8.7245987145421342, -8.12140575795852904, -7.37182626514612771, -7.07095891386557174, -5.80485555893408911, -4.88951464568986083, -4.92264093996991381, -4.72666566476720451, -5.06629061458311192, -5.68394347572815839, -6.07173647273402306, -5.58250338010381597, -5.1942734678151421, -4.45573095358792237, -4.25205565722834855, -4.19783753765894652, -4.67732160795475949, -5.09068406061531853, -5.1478991140428354, -5.11353812543066955, -5.47194544507247382, -5.6404811084907811, -5.60838248311456145, -5.70313448808340695, -6.1268004253802042, -6.5480554560427624, -6.81434891847729851, -7.59522084142115173, -7.62117769715366844, -8.24325874479948162, -7.77410384140567512, -7.22858841507145211, -8.34812537570077851, -8.22873163983867961, -8.05133076520457713, -8.88062345975049539, -9.67134594447698781, -10.7938178177502575, -11.8697460156619314, -11.7204026538526307, -11.3554611604759934, -10.7760452032148066, -9.39606899920687511, -9.65731492703196182, -9.37601581275477081, -9.98092742936281319, -10.0071432253195312, -10.254769599023053, -9.8496660071243074, -9.72795575374941102, -9.30319185191257425, -8.87708413572868693, -8.5312484064163705, -8.5277792459513968, -7.87101551115452924, -7.16546156270433787, -7.01718477979731858, -7.12070352231484183, -7.30349771182074292, -7.04040698343744964, -6.46371939915073579, -6.75321725221331626, -7.17441025559667622, -8.15512684163034685, -8.52457566035817749, -8.28038078243220532, -8.41234792350752691, -8.45981625154258587, -7.79380630114079231, -7.4628685483047601, -8.1357773017149988, -7.87314313706547431, -7.51685973519322026, -7.65835939679381639, -6.90004878468419403, -5.43792949709529694, -4.95633416834462359, -5.61196471485541704, -5.6410266941757774, -5.41668181738998111, -4.37233927791908705, -3.84276459083059141, -3.38946129977689337, -2.75958510433105708, -2.50540244721646177, -1.80227982743111781, -2.41392886819722374, -2.18578036557735977, -3.21424368271901262, -3.53553531798506482, -2.61316066932300073, -3.34236476021327844, -2.08551846169650013, -1.80801227882939619, -1.76653760193111031, -0.884261244722718054, -0.91157203826368971, -4.88498130835068878e-15 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-4
            },
            new ReferenceDataInfo
            {
                Name = "(3) MaxValue=1, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.056082110172666004, 0.00371849722731672737, -0.020287346217737541, -0.00283999771295803454, 0.0160734793340849003, -0.0302202515974202661, 0.0344102293842998841, -0.00721592608931940181, -0.00058236127264890507, -0.0154413761106560691, -0.0141528870182296741, 0.012237827898191566, 0.00782165191901661866, 0.00410504311163423403, 0.0575997949864805667, 0.0394891684619579977, -0.0141910746824073977, -0.00251338510322105402, 0.00905994789920198593, -0.00737257855650747494, -0.0158324866878818589, -0.00838096132927007575, 0.0400581325898406795, 0.0272834691963171339, 0.00574484766416278637, -0.0308145520440539396, -0.0245322992964091477, 0.087068690794732978, -0.00183828700774886023, -0.0596839782347510298, -0.00251752271394163748, 0.0509209651948330164, -0.0582309364274811725, 0.00462742741632446008, -0.0342620519903725565, -0.00527591312467536998, -0.00995385837084370589, 0.00167799217086618438, -0.0704923670467524771, -0.0124922446676869973, -0.0219638121189446971, 0.0350682321306141492, -0.080563918737127399, 0.0132339444796647117, 0.0578404084720469253, -0.0386952366262624178, 0.00771744642147946438, -0.0452186236801560421, -0.0463437017296544351, -0.00086134223535558373, 0.000361536940687160304, 0.0169169602779236303, -0.0238345517652509137, 0.0363241641028508797, -0.00378196994524914072, 0.0493151109986387642, -0.0369486411863651498, 0.0134618043105806801, -0.00141859073917825914, 0.00477391160379051719, 0.0186921008432785855, -0.03729441189505147, -0.00493881734581215568, 0.0181950624204989565, -0.0606541473802664974, 0.0217713908903532961, -0.0136219645853181068, 0.0067536325766153725, -0.0937568588066577807, -0.0239740455646337766, -0.046489764683249786, -0.0729833092527266136, 0.00602132775856092147, -0.0309066587511043697, -0.0960286891376527368, -0.0178763757490033905, 0.0362514389770712681, -0.0350819238311866274, 0.0223551897955290325, 0.00731699405757680645, -0.0591440764494363808, 0.0338904560357804266, 0.0663112982257630657, -0.0339462934861887861, 0.0461611588463324216, -0.0541756582854069219, -0.0797708118314524733, 0.0101747311599380517, -0.068542006258825991, 0.0204470844062806939, 0.00133659993269583501, -0.0200461267190259682, 0.0194699525831321454, 0.00523241341018701369, 0.0432111015698101383, 0.0594777967676955108, 0.0223540941931142344, 0.0126630837495192699, 0.013086541636898574, -0.0134470384612608972, 0.0255423098208198279, 0.0104402809157170366, -0.013162933088153415, 0.0629291380272821305, -0.00948714529572246452, -0.0555241849050014946, -0.0323550453044373978, -0.0210339764010910278, -0.0292027556591552967, -0.0304639748311270851, 0.0474974458532724866, -0.0134557271543102788, 0.00509261079550856269, 0.0174514305932889011, 0.0441613818396454291, -0.0122887422372129872, 0.0479144700466569984, 0.0242381373924522338, -0.0349636758794467165, -0.0179758812589296199, 0.0088098428627055355, -0.00611172353614419968, 0.0368831427406863602, 0.0113776365835701748, 0.086235586444534329, 0.0586323779224888625, 0.00607089085995231315, 0.00788986512784764157, -0.0344113239135472801, -0.0259342757921175622, 0.0284678801237389645, 0.0492401902851270085, -0.0343200259149043646, -0.0278603589691826456, 0.0192935523346549308, 0.012808803963033643, -0.0532085664156285512, -0.0523401775042106332, -0.0179489439739933358, -0.0384772156710949109, -0.0309381648764119332, -0.0674522538897856933, 0.0098384968424456154, 0.0678395406381782362, 0.0400729444453480493, 0.00765006398702319963, -0.00466224974211470154, -0.0187055658838670806, -0.0550798111654820302, -0.0289177555743360092, -0.0273497852687003482, -0.0999424960823958042, -0.0119117705956718212, 0.0326994291265798945, 0.0314005165367151409, -0.0652078334774369994, 0.0610340652999212391, -0.0145353153127197512, 0.000500426050800524915, 0.0380589026095148261, 0.0472952686261722682, 0.0189834465004769283, 0.0798857210665031847, 0.0577541071914653564, -0.00209012786714116335, 0.0123652039225676507, -0.0214288856455063723, -0.0389712609078671918, -0.0244680839598835874, 0.0308685212957788141, 0.0244956514505440294, 0.0465988823562532156, 0.0128510424127253279, 0.00342093207462197679, -0.030253399571440024, -0.0260814075438525819, -0.003610025817491847, 0.00216803181284461969, -0.022613973064345684, -0.0106338814640622899, 0.00202528634288439693, -0.00597844734393170128, -0.0267315134743499223, -0.0265793955495770388, -0.0168019815910130758, -0.049269687487979559, -0.00163776687640440816, -0.0392506605874059014, 0.0296016731995217865, 0.0344196964772822064, -0.0706380067726107008, 0.00753323545271197825, 0.0111932384767596642, -0.0523248316347516285, -0.0498912159183807491, -0.0708231872414210595, -0.0678864798605709197, 0.00942292909829406389, 0.0230262515551559535, 0.0365586753742968007, 0.0870706121126702259, -0.0164835036876780951, 0.0177487742148966926, -0.0381673427260230888, -0.00165410490002849183, -0.0156241679175234197, 0.0255603086583820818, 0.00767939782654362274, 0.0268007903534016496, 0.0268855793065905756, 0.0218207593393269714, 0.000218889227455569188, 0.0414389902058325266, 0.0445174445701648144, 0.00935563251910788082, -0.00653159108827852577, -0.0115335336397052665, 0.0165999027338082361, 0.0363865266776242716, -0.0182660796601082746, -0.0265754818928401783, -0.0618790332811485974, -0.0233106445585856727, 0.0154076551711836134, -0.00832656368915280637, -0.00299504902039152837, 0.0420223869702900724, 0.020880760571766542, -0.0424576720129201529, 0.0165710955097037559, 0.0224799629127687244, -0.00892802507283581639, 0.0478461650107837241, 0.0922534903010362312, 0.0303866109742590776, -0.0413674908586548137, -0.00183368692973129581, 0.0141552047704502099, 0.0658935595432256771, 0.0334139038269286592, 0.0286015040767373455, 0.0397425011629791991, 0.0160378414345944548, 0.0443640381023717237, -0.0385924454515639698, 0.0143951973360161804, -0.064891648347898831, -0.0202721316991167078, 0.0581979058935667218, -0.0460096676772223101, 0.0793016402931906728, 0.0175094564218662881, 0.00261687519989165429, 0.0556678747441865657, -0.00172319457682582576, 0.0575163072565251787 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-6
            },
            new ReferenceDataInfo
            {
                Name = "(4) MaxValue=1, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.056082110172666004, 0.0598006073999827331, 0.0395132611822451921, 0.0366732634692871554, 0.0527467428033720556, 0.0225264912059517895, 0.0569367205902516771, 0.0497207945009322735, 0.0491384332282833666, 0.0336970571176272993, 0.0195441700993976251, 0.0317819979975891911, 0.0396036499166058098, 0.0437086930282400421, 0.101308488014720616, 0.140797656476678607, 0.1266065817942712, 0.12409319669105015, 0.133153144590252126, 0.125780566033744656, 0.109948079345862801, 0.101567118016592725, 0.141625250606433412, 0.168908719802750545, 0.174653567466913323, 0.143839015422859373, 0.119306716126450219, 0.206375406921183197, 0.204537119913434345, 0.144853141678683323, 0.142335618964741673, 0.193256584159574696, 0.135025647732093523, 0.139653075148417988, 0.105391023158045438, 0.100115110033370064, 0.0901612516625263649, 0.0918392438333925504, 0.0213468767866400733, 0.00885463211895307599, -0.0131091799999916211, 0.0219590521306225264, -0.0586048666065048726, -0.0453709221268401575, 0.0124694863452067678, -0.02622575028105565, -0.0185083038595761848, -0.0637269275397322199, -0.110070629269386655, -0.110931971504742238, -0.110570434564055076, -0.0936534742861314384, -0.117488026051382352, -0.0811638619485314794, -0.0849458318937806184, -0.0356307208951418541, -0.072579362081507004, -0.0591175577709263239, -0.0605361485101045815, -0.0557622369063140652, -0.0370701360630354831, -0.0743645479580869462, -0.079303365303899101, -0.0611083028834001479, -0.121762450263666638, -0.0999910593733133457, -0.113613023958631459, -0.106859391382016083, -0.20061625018867385, -0.224590295753307634, -0.271080060436557413, -0.344063369689284027, -0.338042041930723125, -0.368948700681827502, -0.464977389819480225, -0.482853765568483639, -0.446602326591412357, -0.481684250422598992, -0.459329060627069963, -0.452012066569493165, -0.511156143018929532, -0.477265686983149084, -0.410954388757385991, -0.444900682243574763, -0.398739523397242335, -0.45291518168264927, -0.53268599351410173, -0.522511262354163675, -0.59105326861298968, -0.570606184206708944, -0.569269584274013085, -0.589315710993039032, -0.569845758409906922, -0.564613344999719935, -0.521402243429909817, -0.461924446662214327, -0.43957035246910009, -0.426907268719580846, -0.413820727082682249, -0.427267765543943134, -0.401725455723123293, -0.391285174807406266, -0.404448107895559683, -0.341518969868277567, -0.351006115164000043, -0.406530300069001538, -0.438885345373438929, -0.459919321774529932, -0.489122077433685243, -0.519586052264812359, -0.472088606411539879, -0.485544333565850139, -0.480451722770341594, -0.463000292177052686, -0.418838910337407277, -0.431127652574620268, -0.38321318252796327, -0.358975045135511039, -0.393938721014957749, -0.411914602273887376, -0.403104759411181846, -0.409216482947326043, -0.372333340206639662, -0.360955703623069502, -0.274720117178535173, -0.216087739256046296, -0.210016848396093969, -0.202126983268246324, -0.236538307181793611, -0.262472582973911184, -0.234004702850172219, -0.184764512565045225, -0.219084538479949575, -0.246944897449132228, -0.227651345114477294, -0.214842541151443661, -0.268051107567072233, -0.320391285071282894, -0.33834022904527622, -0.37681744471637113, -0.407755609592783064, -0.475207863482568771, -0.465369366640123183, -0.397529826001944975, -0.357456881556596939, -0.349806817569573714, -0.354469067311688424, -0.373174633195555494, -0.428254444361037545, -0.457172199935373558, -0.484521985204073913, -0.584464481286469661, -0.596376251882141495, -0.563676822755561635, -0.532276306218846473, -0.597484139696283445, -0.536450074396362164, -0.550985389709081952, -0.550484963658281479, -0.512426061048766646, -0.465130792422594364, -0.446147345922117411, -0.366261624855614198, -0.308507517664148856, -0.310597645531290045, -0.298232441608722421, -0.3196613272542288, -0.358632588162095978, -0.383100672121979569, -0.352232150826200741, -0.327736499375656687, -0.281137617019403485, -0.268286574606678152, -0.264865642532056189, -0.29511904210349621, -0.321200449647348785, -0.324810475464840653, -0.322642443651996014, -0.345256416716341719, -0.355890298180404019, -0.353865011837519616, -0.359843459181451331, -0.386574972655801263, -0.41315436820537832, -0.429956349796391413, -0.479226037284370965, -0.480863804160775399, -0.520114464748181349, -0.490512791548659566, -0.456093095071377352, -0.526731101843988081, -0.519197866391276075, -0.508004627914516393, -0.56032945954926805, -0.610220675467648799, -0.681043862709069803, -0.74893034256964075, -0.739507413471346631, -0.716481161916190712, -0.679922486541893911, -0.592851874429223713, -0.60933537811690186, -0.591586603902005126, -0.629753946628028194, -0.63140805152805668, -0.647032219445580092, -0.62147191078719799, -0.613792512960654402, -0.586991722607252742, -0.560106143300662218, -0.538285383961335295, -0.538066494733879686, -0.496627504528047159, -0.452110059957882338, -0.442754427438774467, -0.449286018527052966, -0.460819552166758239, -0.444219649432950003, -0.407833122755325739, -0.426099202415434031, -0.452674684308274233, -0.51455371758942281, -0.537864362148008479, -0.522456706976824892, -0.530783270665977747, -0.53377831968636924, -0.491755932716079147, -0.470875172144312626, -0.513332844157232793, -0.496761748647529033, -0.474281785734760319, -0.483209810807596118, -0.435363645796812415, -0.34311015549577617, -0.312723544521517072, -0.354091035380171892, -0.355924722309903185, -0.341769517539452949, -0.275875957996227272, -0.242462054169298613, -0.213860550092561275, -0.174118048929582075, -0.158080207494987635, -0.113716169392615918, -0.152308614844179901, -0.137913417508163716, -0.202805065856062561, -0.223077197555179269, -0.164879291661612554, -0.210888959338834864, -0.131587319045644191, -0.114077862623777906, -0.111460987423886257, -0.0557931126796996912, -0.0575163072565255187, -3.40005801291454191e-16 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-6
            }
        };

        private static readonly ReferenceDataInfo[] ReferenceDataCirculant =
        {
            new ReferenceDataInfo
            {
                Name = "(1) MaxValue=100, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 1.24922073172192127, -0.33321331347469002, 0.14747523690334044, 0.264543440429287846, -0.460583384621015501, -0.338446214078123919, 0.0770996999323452364, 0.229458990530465812, 0.388173816421544859, -0.524165811485353572, 0.0653237009606879443, -0.414983140130586847, 0.796570558551018326, -0.0217695374366337832, 0.244459437601361212, -0.207815094355373264, 0.00517758410417082718, 2.62865266773134579e-306, 0.195686765544009572, -0.480303907238441463, -0.316260208032832113, 0.16762102148753566, 0.0991914325683123238, 0.0213372295838253762, 0.153739876537336256, 0.0347000373827846265, 0.0433640777680532052, -0.179530656042028697, 1.20620515053946553, 0.385593353407084005, 0.693867676013666501, 0.685114560108432968, -0.290899959522374518, -0.134807827864565133, 0.239665806204635401, 0.0685754364303165359, 0.207832330901812939, -0.0708613355490638752, 0.423871674021403355, -0.152016723539786153, -0.310796487208531924, -0.0799057706182499383, 0.0143566518743500141, -0.375110488289166433, 0.765613213205451393, 0.179533660186668664, 0.756874876796041485, 0.492167674763807961, 0.149941829210601812, -0.0859471946050539698, 0.764795971658527973, -1.05532089153269593, -0.505335131583384389, 0.212069571008829477, 0.494103624835507238, 1.96214182997262143, 0.0661447240158723471, -0.140570796302141032, 0.548548652609528897, -1.26901979159568734, -0.0593413849646229896, 0.0421611864547746101, 1.16404186232508522, 0.976037414682809357, -0.887519608106130287, -0.0865086146751073148, 0.252796751049434665, 0.36522223379679597, -0.48380186444107004, -0.0806552186747393068, 0.162213063728327084, 0.0533732394217462519, -0.11553866077754392, -0.0550744847227162965, 0.915917720939708024, 0.198913303663922764, -0.936666093691411183, -0.141407210583213733, -0.273861837949780307, -0.302068894191355686, -0.323856589053788002, -0.254124950730575117, 0.459197320139542176, 0.85699920955235187, -0.963160049486586956, -0.171185336661998616, -1.70572038175125829, 0.763989298944433459, 0.648519440256842605, 0.316922445052243151, 0.575654469673667624, -0.364457658202819557, 0.0832681174439975774, 0.14945283656821387, 0.951291160321148133, -0.950297499041824367, -0.491760267250557881, -0.373649928608784154, -0.234884123241795972, -0.3837019782940993, -0.0978282253547970021, -0.400391004499410563, 0.487202194160913704, -0.0377084341629857628, -0.252825616351205429, -0.522016083459470037, 0.0421453389975238318, 0.42213375423865318, -0.082507848656983962, -0.444287942234193212, 0.563831528627181, 1.03718859132330965, -0.156468486931759992, 0.0422046947046249149, -0.36535724272032627, 0.588626148417825235, -0.00683170614814294745, 0.157425551298034316, -0.0828223429823279345, 0.506552495784803325, 0.074207448219556521, 0.569265465965280049, 0.823046986652290924, -0.410580470047325619, -0.0561875849018149201, -0.38181844878273663, 1.29734881054502815, 0.404465041867992092, -0.0174419524380732584, -0.245057503002678784, -0.0701951198901754614, 0.616727163841390369, 0.0295296859900284411, 0.198636975544325828, 1.16151394075864256, 0.706436339655589052, 0.224606074741191986, 0.607964196674118051, -0.771674431361984658, 0.333959567985840644, 0.114295007124697826, 1.13408138781253509, -0.963993642881939117, -0.595192489167068017, -0.184542549129257077, 0.0779397163900167195, 0.75193308424684091, -0.19278816769045487, 0.353184914397778049, -0.144568837333699823, -2.17141668848656977, -0.239221574339315679, -0.421613989369636732, 0.237892225113671502, -0.29928918106719743, -0.463789127835584569, -0.367371403420290676, -0.648030706156781378, 0.624892091702905272, -0.0271311000583468603, 0.349925289277917551, -0.754842957845980211, -1.76257405377423781, 0.188109989349775963, -0.719201620469326675, 0.83835739579869939, 0.301478308416213536, -0.131962238058950854, -0.590204131925549658, 0.611018176982217165, 1.85525731227652746, -0.211762541390649289, 0.741849819815568412, -0.974857047356585404, -0.0703451352087953174, -0.0136768082583528273, 0.682619328887547949, -0.723272237539176688, -1.2600600966743547, -0.0423346182734305465, -0.170889968238935125, 0.196474431203770422, -0.781961072666348511, -0.183545410908801304, -0.463662742265640471, -0.581760195349233622, -0.589276724277532971, -0.1770292682179751, -0.803465676109699767, -1.36533571231974626, -0.00812208150596002015, -0.0695394177575592437, -0.390079080652206034, 0.0437370896567552334, 0.0812187989354958007, -0.0538447120809609006, -0.271136058117956324, 0.341501022895258854, 0.0476419278733206594, -0.0222643457421243494, -0.532532124201282153, -0.382124361191082396, 0.475398140640384992, 0.00291205580180247964, 0.181391149640404703, -0.995845907710405265, 0.0601870732517222687, -0.319123887047450094, 0.180178927759417462, 1.60310093530806985, 0.27894739699563964, 0.192481589644221157, 0.512498551629295807, 0.275684421723548345, -0.0884841839535586844, 0.055946588174150623, 0.469710749142184081, 0.410777190740431897, -0.546347510861394769, 0.0826436056979337336, -1.09707228760886677, -0.12464694979079198, 0.113112287820917451, 0.14085498165572391, -0.187989014817099537, -0.571666405276031964, -0.21745021726284719, -0.21493501569381801, -0.995267823956533126, 0.0800362309680940492, 0.077456083632359285, 0.121377120530015772, -1.09318622937393384, -0.64122347347639852, 0.364014269261049628, -0.226741443266539389, 0.741124903028005044, 0.286912690537520276, -0.00559732656606628728, 0.129287717225086335, -0.253899659938877809, -0.138610140208514504, -0.02607623322397494, 0.11796947271018908, -0.858049085578823756, -0.471053500631254229, -0.034033008001358285, 0.00651355908978520567, -1.94488110561232785, -1.05949668226112048, 0.0790641918366047358, -0.782586241073565114, -0.125665018499581532, 0.0631834223242800502, 0.121630365088214482, -0.343529382709495235 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-5
            },
            new ReferenceDataInfo
            {
                Name = "(2) MaxValue=100, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 1.24922073172192127, 0.916007418247231309, 1.06348265515057183, 1.32802609557985973, 0.867442710958844287, 0.528996496880720368, 0.606096196813065591, 0.835555187343531403, 1.22372900376507632, 0.699563192279722745, 0.764886893240410703, 0.349903753109823856, 1.14647431166084224, 1.12470477422420845, 1.36916421182556958, 1.1613491174701962, 1.166526701574367, 1.166526701574367, 1.36221346711837654, 0.881909559879935134, 0.565649351847103077, 0.733270373334638736, 0.832461805902951046, 0.853799035486776381, 1.00753891202411272, 1.04223894940689732, 1.08560302717495061, 0.906072371132921939, 2.11227752167238769, 2.49787087507947181, 3.1917385510931382, 3.87685311120157117, 3.5859531516791967, 3.45114532381463146, 3.69081113001926697, 3.75938656644958336, 3.96721889735139621, 3.89635756180233228, 4.32022923582373597, 4.16821251228394996, 3.85741602507541792, 3.77751025445716815, 3.79186690633151802, 3.41675641804235175, 4.18236963124780292, 4.36190329143447197, 5.11877816823051379, 5.61094584299432153, 5.76088767220492315, 5.6749404775998693, 6.4397364492583975, 5.3844155577257018, 4.87908042614231707, 5.09114999715114624, 5.58525362198665309, 7.5473954519592743, 7.61354017597514687, 7.4729693796730059, 8.02151803228253435, 6.75249824068684745, 6.69315685572222474, 6.73531804217699914, 7.89935990450208436, 8.87539731918489316, 7.9878777110787631, 7.90136909640365559, 8.15416584745308981, 8.51938808124988611, 8.03558621680881657, 7.95493099813407767, 8.11714406186240467, 8.17051730128415166, 8.05497864050660795, 7.99990415578389147, 8.91582187672359971, 9.11473518038752317, 8.17806908669611232, 8.03666187611289828, 7.76280003816311837, 7.46073114397176251, 7.1368745549179744, 6.88274960418739923, 7.34194692432694129, 8.19894613387929283, 7.23578608439270621, 7.06460074773070801, 5.3588803659794495, 6.12286966492388274, 6.77138910518072556, 7.08831155023296855, 7.66396601990663662, 7.29950836170381745, 7.38277647914781543, 7.53222931571602938, 8.48352047603717807, 7.53322297699535337, 7.04146270974479549, 6.6678127811360115, 6.43292865789421597, 6.04922667960011662, 5.95139845424531977, 5.55100744974590921, 6.03820964390682313, 6.00050120974383727, 5.74767559339263201, 5.22565950993316175, 5.26780484893068568, 5.68993860316933908, 5.60743075451235473, 5.16314281227816174, 5.72697434090534241, 6.76416293222865228, 6.60769444529689221, 6.64989914000151749, 6.2845418972811915, 6.87316804569901674, 6.86633633955087408, 7.02376189084890878, 6.94093954786658074, 7.44749204365138429, 7.52169949187094122, 8.09096495783622061, 8.91401194448851086, 8.50343147444118586, 8.44724388953937044, 8.06542544075663415, 9.36277425130166208, 9.76723929316965389, 9.74979734073158077, 9.50473983772890207, 9.43454471783872606, 10.0512718816801172, 10.0808015676701448, 10.2794385432144715, 11.4409524839731134, 12.1473888236287024, 12.3719948983698949, 12.9799590950440127, 12.2082846636820275, 12.5422442316678673, 12.6565392387925648, 13.7906206266051008, 12.8266269837231626, 12.231434494556094, 12.0468919454268377, 12.1248316618168541, 12.8767647460636958, 12.6839765783732403, 13.037161492771018, 12.8925926554373174, 10.7211759669507476, 10.4819543926114314, 10.0603404032417938, 10.2982326283554659, 9.99894344728826923, 9.5351543194526851, 9.16778291603239381, 8.51975220987561244, 9.14464430157851815, 9.11751320152017186, 9.46743849079808975, 8.71259553295210942, 6.95002147917787205, 7.13813146852764824, 6.41892984805832167, 7.25728724385702151, 7.55876555227323532, 7.42680331421428441, 6.83659918228873487, 7.44761735927095181, 9.30287467154747993, 9.09111213015683006, 9.83296194997239859, 8.85810490261581407, 8.78775976740701914, 8.77408295914866621, 9.45670228803621349, 8.73343005049703613, 7.47336995382268121, 7.43103533554925022, 7.26014536731031512, 7.45661979851408585, 6.67465872584773745, 6.49111331493893573, 6.02745057267329543, 5.44569037732406169, 4.85641365304652872, 4.67938438482855368, 3.8759187087188538, 2.51058299639910754, 2.50246091489314759, 2.43292149713558814, 2.04284241648338227, 2.08657950614013732, 2.16779830507563309, 2.113953592994672, 1.84281753487671573, 2.18431855777197459, 2.23196048564529503, 2.20969613990317049, 1.67716401570188833, 1.29503965451080605, 1.77043779515119093, 1.77334985095299347, 1.95474100059339806, 0.958895092882992794, 1.01908216613471514, 0.699958279087265045, 0.880137206846682507, 2.48323814215475247, 2.762185539150392, 2.95466712879461335, 3.46716568042390927, 3.74285010214745739, 3.65436591819389855, 3.71031250636804932, 4.18002325551023368, 4.59080044625066552, 4.04445293538927064, 4.12709654108720425, 3.03002425347833748, 2.90537730368754543, 3.01848959150846285, 3.15934457316418671, 2.9713555583470872, 2.39968915307105535, 2.18223893580820816, 1.96730392011439026, 0.972036096157857132, 1.05207232712595111, 1.12952841075831034, 1.25090553128832616, 0.157719301914392318, -0.483504171562006202, -0.119489902300956574, -0.346231345567495963, 0.394893557460509081, 0.681806247998029358, 0.676208921431963095, 0.805496638657049457, 0.551596978718171593, 0.412986838509657117, 0.386910605285682163, 0.504880077995871202, -0.353169007582952554, -0.824222508214206728, -0.858255516215565062, -0.851741957125779825, -2.79662306273810746, -3.85611974499922816, -3.77705555316262354, -4.55964179423618887, -4.68530681273576999, -4.62212339041149001, -4.50049302532327555, -4.84402240803277095 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-5
            },
            new ReferenceDataInfo
            {
                Name = "(3) MaxValue=1, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.0788204995556867349, -0.0210243387415436599, 0.00930505838531190885, 0.0166915626672917636, -0.0290608469272175436, -0.0213545124484108076, 0.00486466219295322855, 0.0144778835332208516, 0.024492112040607996, -0.0330726268482104263, 0.00412164688897739134, -0.0261836660100846982, 0.0502602044314454793, -0.00137356495315806059, 0.015424347758207637, -0.0131122460077367099, 0.00032668347171904851, 2.07288003477355201e-297, 0.0123470001937566465, -0.0303051277854628071, -0.0199546701025149244, 0.010576171459683292, 0.00625855628884884954, 0.00134628817167746777, 0.00970033042407104397, 0.00218942434404052234, 0.00273608833543634387, -0.0113276185989065383, 0.0761063998682712795, 0.0243292958314946413, 0.0437800906278226071, 0.0432278063510732613, -0.0183545465969633115, -0.0085057989084569019, 0.0151218900645581373, 0.00432681752666428179, 0.0131133335602936704, -0.0044710480104357261, 0.0267444945840918762, -0.00959160682012431473, -0.0196099326242867647, -0.00504171328379344336, 0.00090584349422664738, -0.0236678717577601082, 0.0483069279903059617, 0.0113278081476189865, 0.0477555762367003755, 0.0310536809107963691, 0.00946068983852239864, -0.00542290136735272457, 0.0482553635346813919, -0.066586246729593998, -0.0318844912696401236, 0.0133806853368784832, 0.0311758311024249307, 0.123802779853303208, 0.00417344994164300757, -0.00886941763462650683, 0.0346110801168696344, -0.0800697357798023091, -0.00374418826750553841, 0.00266019102456388793, 0.0734460762316414412, 0.0615837975281578534, -0.0559987015104745772, -0.00545832457900659838, 0.0159503966735371795, 0.0230439650781550688, -0.0305258339642303991, -0.00508900025934828047, 0.0102349523930021606, 0.00336762374118505792, -0.00728999665889969693, -0.00347496506292600468, 0.0577905012966468887, 0.0125505809861570991, -0.059099635114016863, -0.00892219180799360204, -0.017279513802725837, -0.0190592587329046249, -0.020433969342179132, -0.0160342004079123621, 0.0289733921707666688, 0.0540729945480776589, -0.0607712907133468455, -0.0108010645434202506, -0.107623680249551545, 0.0482044659273264259, 0.0409188103868238715, 0.0199964544336333275, 0.036321341552345128, -0.0229957236195120936, 0.00525386302623295689, 0.00942983648861125262, 0.0600224144343713406, -0.059959718646159843, -0.0310279752345282121, -0.0235757166720212234, -0.0148201862661202013, -0.0242099581296241623, -0.00617254372850726228, -0.0252629644952705214, 0.0307403802652693632, -0.00237924134839836944, -0.0159522179509524707, -0.0329369881795538166, 0.00265919111760951673, 0.0266348392589875124, -0.00520589330873842768, -0.0280326740216656038, 0.0355753644036814129, 0.0654421759306507839, -0.00987249410092970979, 0.00266293620954274109, -0.0230524835653422473, 0.0371397991497315061, -0.000431051516950128378, 0.00993288078003381689, -0.00522573655917574036, 0.0319613017580193809, 0.00468217344692628285, 0.0359182226709732905, 0.0519307541080554561, -0.0259058763076490083, -0.00354519693624045411, -0.0240911154517502168, 0.0818571760366028217, 0.0255200188752098441, -0.00110051279928765353, -0.0154620831339517192, -0.00442901264413739053, 0.0389128533566164697, 0.00186319722556023111, 0.0125331458605024912, 0.0732865751637797602, 0.0445731196913398339, 0.0141716852472822293, 0.0383599475072535431, -0.0486893650015420981, 0.021071424218009855, 0.00721152741827441046, 0.0715556980878609278, -0.0608238869008576044, -0.0375541072419409358, -0.0116438476742201646, 0.0049176636482984341, 0.0474437702063188194, -0.0121641110333171598, 0.0222844615698886382, -0.00912167696986602473, -0.137007130752746092, -0.0150938609287505753, -0.0266020443128366403, 0.0150099846630206493, -0.01888387069178106, -0.0292631156497925315, -0.0231795685140028379, -0.040887973349830721, 0.0394280254767538502, -0.00171185668456409518, 0.0220787931289258277, -0.0476273708182074137, -0.111210904441908232, 0.0118689379350332084, -0.0453785544597178139, 0.052896775617847766, 0.0190219952896674808, -0.0083262543297338721, -0.037239363178098242, 0.0385526406377828465, 0.11705882270814584, -0.0133613130776221081, 0.04680755923139409, -0.0615093213847913087, -0.00443847797084416344, -0.000862948261965507655, 0.0430703679045738932, -0.0456353930333966429, -0.0795044172483106437, -0.00267113383253864004, -0.0107824280558343078, 0.0123966985370587406, -0.0493384081896442658, -0.0115809325058543171, -0.0292551412594332788, -0.0367065867981830884, -0.0371808477114139169, -0.011169791697008543, -0.0506952569379159196, -0.0861468595369240253, -0.000512468697865222397, -0.00438764063650083809, -0.024612326086559104, 0.00275962379451184098, 0.00512455976982111733, -0.00339737165489036692, -0.0171075287222933053, 0.0215472578543262211, 0.00300600242968673045, -0.00140478524660396769, -0.0336005054936437467, -0.0241104172198315543, 0.0299955948389278755, 0.000183738299568343271, 0.0114450078089319111, -0.0628336289440424856, 0.00379754759109415547, -0.0201353560331656231, 0.0113685217790370618, 0.101148830907569376, 0.0176003908858031015, 0.0121447672663244043, 0.0323364725185965735, 0.0173945110645247758, -0.00558297457358343172, 0.00352999107070890586, 0.0296367446952554674, 0.0259182885442616751, -0.0344721974616469182, 0.00521445899894364302, -0.0692205817292501357, -0.00786469084375540813, 0.00713690287515653717, 0.00888734851823018771, -0.0118613049580444836, -0.0360697117001503031, -0.0137201811640807123, -0.0135614826737980067, -0.0627971543250194636, 0.00504994477538320274, 0.00488714848425091716, 0.00765837856502710971, -0.0689753880308092704, -0.0404584660043034033, 0.0229677476685849931, -0.0143064178927062094, 0.0467618200742690796, 0.0181029669319221279, -0.000353167430631362318, 0.00815750347342466056, -0.0160199855199458438, -0.00874570859839915622, -0.00164529908690454153, 0.00744337052309495314, -0.0541392372470472713, -0.0297214665866395202, -0.00214733763532101935, 0.000410977794640569796, -0.122713701772685674, -0.0668497213125051615, 0.00498861325246966955, -0.0493778536494512976, -0.00792892663665503185, 0.00398660443648982989, 0.00767435721642162078, -0.0216752387065303129 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-5
            },
            new ReferenceDataInfo
            {
                Name = "(4) MaxValue=1, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.0788204995556867349, 0.0577961608141430716, 0.0671012191994549839, 0.0837927818667467406, 0.0547319349395292004, 0.0333774224911183928, 0.0382420846840716214, 0.0527199682172924747, 0.0772120802579004673, 0.0441394534096900409, 0.0482611002986674323, 0.022077434288582734, 0.0723376387200282134, 0.0709640737668701532, 0.0863884215250777937, 0.0732761755173410856, 0.0736028589890601326, 0.0736028589890601326, 0.0859498591828167791, 0.055644731397353972, 0.0356900612948390511, 0.0462662327545223448, 0.0525247890433711978, 0.0538710772150486628, 0.0635714076391197119, 0.0657608319831602395, 0.0684969203185965825, 0.0571693017196900424, 0.133275701587961315, 0.157604997419455967, 0.20138508804727856, 0.244612894398351821, 0.22625834780138851, 0.217752548892931608, 0.232874438957489743, 0.237201256484154022, 0.250314590044447671, 0.245843542034011958, 0.272588036618103824, 0.262996429797979492, 0.243386497173692734, 0.238344783889899298, 0.239250627384125947, 0.215582755626365835, 0.263889683616671811, 0.275217491764290778, 0.322973068000991126, 0.354026748911787481, 0.363487438750309866, 0.358064537382957127, 0.406319900917638532, 0.33973365418804452, 0.307849162918404418, 0.32122984825528289, 0.352405679357707835, 0.47620845921101107, 0.480381909152654052, 0.471512491518027543, 0.506123571634897185, 0.426053835855094876, 0.422309647587589321, 0.424969838612153206, 0.498415914843794661, 0.559999712371952563, 0.504001010861477972, 0.498542686282471392, 0.514493082956008596, 0.537537048034163689, 0.507011214069933325, 0.501922213810584994, 0.5121571662035872, 0.515524789944772244, 0.50823479328587251, 0.504759828222946516, 0.562550329519593384, 0.575100910505750518, 0.516001275391733683, 0.507079083583740098, 0.489799569781014243, 0.470740311048109594, 0.45030634170593048, 0.434272141298018111, 0.463245533468784776, 0.5173185280168624, 0.456547237303515541, 0.445746172760095316, 0.338122492510543771, 0.386326958437870183, 0.427245768824694061, 0.447242223258327409, 0.48356356481067253, 0.460567841191160454, 0.465821704217393384, 0.475251540706004616, 0.535273955140376012, 0.475314236494216169, 0.444286261259687953, 0.420710544587666713, 0.405890358321546518, 0.381680400191922342, 0.375507856463415057, 0.350244891968144512, 0.380985272233413885, 0.378606030885015543, 0.362653812934063069, 0.329716824754509252, 0.332376015872118791, 0.35901085513110631, 0.353804961822367869, 0.325772287800702276, 0.361347652204383696, 0.426789828135034466, 0.416917334034104747, 0.419580270243647468, 0.396527786678305239, 0.433667585828036772, 0.433236534311086663, 0.443169415091120455, 0.437943678531944713, 0.46990498028996408, 0.474587153736890366, 0.510505376407863642, 0.562436130515919119, 0.536530254208270163, 0.532985057272029716, 0.508893941820279472, 0.59075111785688228, 0.616271136732092106, 0.615170623932804417, 0.599708540798852718, 0.595279528154715298, 0.634192381511331726, 0.636055578736892002, 0.648588724597394473, 0.721875299761174261, 0.766448419452514074, 0.780620104699796258, 0.818980052207049836, 0.770290687205507751, 0.791362111423517645, 0.798573638841792111, 0.870129336929652997, 0.809305450028795392, 0.771751342786854422, 0.760107495112634313, 0.7650251587609328, 0.812468928967251647, 0.800304817933934487, 0.822589279503823101, 0.813467602533957113, 0.676460471781211048, 0.661366610852460513, 0.634764566539623876, 0.64977455120264449, 0.630890680510863389, 0.601627564861070829, 0.578447996347068005, 0.537560022997237263, 0.5769880484739911, 0.575276191789427016, 0.597354984918352816, 0.549727614100145368, 0.438516709658237136, 0.450385647593270322, 0.405007093133552487, 0.457903868751400267, 0.476925864041067737, 0.468599609711333853, 0.431360246533235625, 0.469912887171018478, 0.586971709879164361, 0.573610396801542244, 0.620417956032936369, 0.558908634648145108, 0.554470156677300929, 0.553607208415335394, 0.596677576319909253, 0.551042183286512666, 0.471537766038202022, 0.468866632205663381, 0.458084204149829088, 0.470480902686887803, 0.421142494497243558, 0.409561561991389267, 0.380306420731955974, 0.343599833933772913, 0.306418986222358969, 0.295249194525350422, 0.244553937587434489, 0.158407078050510464, 0.157894609352645238, 0.153506968716144387, 0.128894642629585277, 0.131654266424097111, 0.136778826193918235, 0.133381454539027861, 0.116273925816734555, 0.137821183671060776, 0.140827186100747515, 0.139422400854143536, 0.105821895360499796, 0.081711478140668245, 0.111707072979596117, 0.111890811279164462, 0.123335819088096377, 0.0605021901440538912, 0.0642997377351480492, 0.0441643817019824261, 0.0555329034810194896, 0.156681734388588872, 0.174282125274391964, 0.186426892540716371, 0.218763365059312931, 0.236157876123837707, 0.230574901550254285, 0.234104892620963179, 0.263741637316218636, 0.289659925860480283, 0.255187728398833358, 0.260402187397776985, 0.191181605668526849, 0.183316914824771443, 0.190453817699927974, 0.199341166218158172, 0.187479861260113678, 0.151410149559963375, 0.137689968395882656, 0.124128485722084653, 0.0613313313970651891, 0.0663812761724483918, 0.0712684246566993029, 0.0789268032217264187, 0.00995141519091714832, -0.030507050813386255, -0.00753930314480126193, -0.0218457210375074713, 0.0249160990367616082, 0.0430190659686837396, 0.0426658985380523742, 0.0508234020114770313, 0.0348034164915311875, 0.026057707893132033, 0.024412408806227491, 0.031855779329322445, -0.0222834579177248263, -0.0520049245043643499, -0.0541522621396853671, -0.0537412843450447986, -0.176454986117730472, -0.243304707430235634, -0.238316094177765975, -0.287693947827217245, -0.295622874463872254, -0.291636270027382405, -0.283961912810960782, -0.305637151517491101 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-5
            }
        };

        private static readonly ReferenceDataInfo[] ReferenceDataApproximateCirculant =
        {
            new ReferenceDataInfo
            {
                Name = "(1) MaxValue=100, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 1.25132677728203778, -0.33109022288734441, 0.149612611416425068, 0.266692945120684644, -0.458420830119535327, -0.336268191115944859, 0.0792944771527997888, 0.231669964142878493, 0.39040853434540379, -0.521913498911498075, 0.0675946725141669397, -0.41269969035395887, 0.798870838456801513, -0.0194536765722773952, 0.246795758236278445, -0.205462000160837405, 0.00755387797664188419, -0.107804687462681251, 0.198094002845797146, -0.477881922352598354, -0.313825446543403275, 0.170066988499615407, 0.101648749587937709, 0.0238064002048507528, 0.156218431000594266, 0.0371858815779730206, 0.0458589772969468998, -0.177031880466239189, 1.20870297658539849, 0.388090208139117765, 0.696369290779987327, 0.687617785469340492, -0.28838872784900893, -0.132285620372991269, 0.242196930532153437, 0.0711173820355661679, 0.210388753727109606, -0.0682930875870184917, 0.426452569847543317, -0.14942215363742728, -0.308186280539994972, -0.077286699359942021, 0.0169872559792558324, -0.37247245496930903, 0.768261923644149469, 0.182189187012167408, 0.759539227449184784, 0.494836502282741453, 0.152609732984197222, -0.0832857611006039278, 0.767457150768268259, -1.05266477730922414, -0.502679427016061942, 0.214725662622579916, 0.496757492283951108, 1.9647957628046524, 0.0687905126332552241, -0.137927941077335997, 0.551188763614106403, -1.26638124111417238, -0.0567051761484856712, 0.0447876581705207583, 1.16666268873871282, 0.978652236665709552, -0.88490971104559657, -0.0839014506149513145, 0.255396355136076836, 0.367819857401536277, -0.481209624215644283, -0.0780635086843908116, 0.164801921900508713, 0.0559661820039122071, -0.112935948532738833, -0.052466565017101556, 0.918531177351894379, 0.201537478097919942, -0.934028611683623833, -0.138760199734588613, -0.271205248561871781, -0.299398957482857497, -0.321177822492541731, -0.25143926184449561, 0.461886816257480293, 0.859695073922134401, -0.96046032320632202, -0.16847332895054512, -1.70300668344489092, 0.766711610353459694, 0.651250537378991412, 0.319667233553130536, 0.578412118166152678, -0.361685949867422807, 0.0860598004324274607, 0.152255414113089488, 0.95411339378142912, -0.947459267765229485, -0.488904424556982464, -0.37078205706732198, -0.231999524553148956, -0.380801609970249588, -0.0949086283278787468, -0.397456123624734814, 0.490155417512133706, -0.0347399394750507254, -0.249837802089105526, -0.519011800987182248, 0.0451664580164717125, 0.425172755937396563, -0.0794465386589117417, -0.441206438989598326, 0.566931998945308768, 1.04030925376935479, -0.153327083277743859, 0.0453685410853505999, -0.362173703259377033, 0.591832069176093545, -0.00360899258676258914, 0.160669348294018605, -0.0795607262359569606, 0.509834322509717053, 0.0775039785810378301, 0.572576678311603637, 0.826370768505577558, -0.407238445024480256, -0.0528209896581326652, -0.378435738406664113, 1.30075348179664285, 0.407883912651228919, -0.014001285164777456, -0.241599009703710565, -0.0667155114672684096, 0.620231401990866238, 0.0330582008570942595, 0.202188409389496782, 1.16509070425704242, 0.710039525987755549, 0.228230299642498108, 0.611612568319844452, -0.768007148062373912, 0.337641311779115105, 0.117982809131848346, 1.13778436875880606, -0.960280894994944845, -0.591474637457132135, -0.180820894505218155, 0.0816634962230235045, 0.755665603304446654, -0.189047469452064909, 0.35693351023031189, -0.140810180502518756, -2.16764693869459357, -0.235438469697747649, -0.417825214351620344, 0.241694451343974798, -0.295477240276792452, -0.45996810857364101, -0.363540961502961613, -0.644195276464867961, 0.628734694394554317, -0.0232859096033187149, 0.353777113439832591, -0.750984613530375933, -1.75871504169989068, 0.19197307840867997, -0.715339010201171188, 0.842225625454096849, 0.305345865341108968, -0.128087889015024853, -0.586326649462052596, 0.61489251217975438, 1.8591304092418055, -0.207891245448905027, 0.745727345905150774, -0.97098283384293016, -0.0664643004653782399, -0.00979664326854344514, 0.686505387397117306, -0.719379366404290677, -1.25616202212096506, -0.0384342746989798714, -0.166988450712819897, 0.200380538179594114, -0.778052202045566577, -0.179627784572242905, -0.459739191102816913, -0.577826089830498435, -0.585330738724713862, -0.173070727214984427, -0.79949171044343037, -1.36134685476698669, -0.00412352593443775055, -0.0655315704505446267, -0.386058706127438644, 0.047768385057931087, 0.0852601129213873821, -0.0497928208283392112, -0.267075006526542924, 0.3455690989735552, 0.0517126761564719595, -0.0181850833154821416, -0.528444834612565084, -0.378026625729584398, 0.4795056552949849, 0.00702427749626807329, 0.185514660436300077, -0.991718569799374117, 0.0643229013719845283, -0.314982959782141025, 0.184326331096823531, 1.60725189955376968, 0.283095495308342437, 0.196629588468935745, 0.516640802672590382, 0.279821092618802225, -0.0843455641426070768, 0.0600859002832107025, 0.473851348294251518, 0.414922840385571978, -0.542201513454199979, 0.0867921864575404572, -1.09292344989438095, -0.12050029827137583, 0.11725040235844067, 0.144989643446336997, -0.183856970692339111, -0.567539966329341339, -0.213332978158251169, -0.210823109781161616, -0.991162507681909166, 0.0841346807265106744, 0.081541694985493296, 0.125457747190246938, -1.08911411640901701, -0.637157562803629229, 0.368075798189822168, -0.222685146572590781, 0.745176574966976757, 0.290963749630193891, -0.00154070346135836626, 0.13334580881431557, -0.249839031155854568, -0.134552315355849633, -0.0220195193575677649, 0.122027532455364907, -0.853985539176715713, -0.466992047297720758, -0.02998118377468377, 0.0105636632740593959, -1.94083171079708716, -1.0554498691189047, 0.0831034425315676506, -0.778551342471739627, -0.121635205804861923, 0.0672052206818442299, 0.125647983937377139, -0.339519244267544096 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-5
            },
            new ReferenceDataInfo
            {
                Name = "(2) MaxValue=100, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 1.25132677728203778, 0.920236554394693318, 1.06984916581111844, 1.33654211093180297, 0.878121280812267591, 0.541853089696322732, 0.621147566849122534, 0.852817530992000972, 1.24322606533740476, 0.721312566425906687, 0.788907238940073641, 0.376207548586114771, 1.17507838704291623, 1.15562471047063875, 1.40242046870691728, 1.1969584685460799, 1.20451234652272188, 1.09670765906004064, 1.29480166190583779, 0.816919739553239488, 0.503094293009836213, 0.673161281509451648, 0.774810031097389329, 0.798616431302240137, 0.954834862302834431, 0.99202074388080741, 1.0378797211777544, 0.860847840711515211, 2.0695508172969137, 2.45764102543603169, 3.15401031621601913, 3.84162810168535973, 3.5532393738363508, 3.42095375346335961, 3.66315068399551302, 3.73426806603107941, 3.94465681975818905, 3.87636373217117036, 4.30281630201871401, 4.1533941483812864, 3.84520786784129154, 3.76792116848134961, 3.78490842446060549, 3.41243596949129646, 4.18069789313544593, 4.36288708014761362, 5.12242630759679862, 5.61726280987953963, 5.76987254286373652, 5.68658678176313259, 6.45404393253140096, 5.40137915522217682, 4.89869972820611466, 5.11342539082869418, 5.61018288311264524, 7.57497864591729808, 7.64376915855055294, 7.50584121747321653, 8.05702998108732338, 6.79064873997315122, 6.73394356382466519, 6.7787312219951863, 7.94539391073389911, 8.92404614739960778, 8.03913643635401165, 7.95523498573906007, 8.21063134087513724, 8.57845119827667268, 8.0972415740610284, 8.01917806537663758, 8.18397998727714615, 8.23994616928105827, 8.12701022074831947, 8.07454365573121713, 8.99307483308311184, 9.19461231118103228, 8.26058369949740801, 8.1218234997628187, 7.85061825120094703, 7.55121929371808953, 7.23004147122554741, 6.97860220938105158, 7.44048902563853165, 8.30018409956066527, 7.3397237763543437, 7.17125044740379813, 5.46824376395890699, 6.23495537431236713, 6.88620591169135832, 7.20587314524448885, 7.78428526341064142, 7.42259931354321889, 7.50865911397564645, 7.6609145280887363, 8.61502792187016553, 7.66756865410493571, 7.17866422954795347, 6.80788217248063177, 6.57588264792748323, 6.19508103795723386, 6.10017240962935503, 5.70271628600462055, 6.19287170351675442, 6.1581317640417037, 5.90829396195259804, 5.38928216096541579, 5.43444861898188769, 5.85962137491928381, 5.78017483626037176, 5.3389683972707731, 5.90590039621608209, 6.94620964998543666, 6.79288256670769286, 6.83825110779304346, 6.4760774045336662, 7.06790947370975964, 7.0643004811229968, 7.22496982941701571, 7.14540910318105915, 7.65524342569077643, 7.73274740427181406, 8.30532408258341803, 9.13169485108899615, 8.72445640606451533, 8.67163541640638336, 8.29319967799971991, 9.59395315979636365, 10.0018370724475929, 9.9878357872828154, 9.74623677757910478, 9.67952126611183594, 10.2997526681027018, 10.3328108689597968, 10.534999278349293, 11.700089982606336, 12.4101295085940908, 12.6383598082365882, 13.2499723765564319, 12.4819652284940581, 12.819606540273174, 12.9375893494050231, 14.0753737181638297, 13.1150928231688848, 12.5236181857117526, 12.3427972912065336, 12.4244607874295578, 13.1801263907340047, 12.9910789212819395, 13.3480124315122506, 13.2072022510097327, 11.0395553123151391, 10.8041168426173915, 10.3862916282657718, 10.6279860796097463, 10.3325088393329541, 9.87254073075931338, 9.50899976925635215, 8.86480449279148353, 9.49353918718603751, 9.47025327758271906, 9.82403039102255171, 9.073045777492176, 7.31433073579228576, 7.50630381420096615, 6.79096480399979541, 7.63319042945389192, 7.93853629479500089, 7.8104484057799759, 7.22412175631792319, 7.83901426849767802, 9.6981446777394833, 9.49025343229057761, 10.2359807781957279, 9.26499794435279789, 9.19853364388741923, 9.18873700061887533, 9.87524238801599274, 9.15586302161170273, 7.89970099949073745, 7.86126672479175781, 7.69427827407893794, 7.89465881225853217, 7.11660661021296548, 6.93697882564072277, 6.47723963453790574, 5.8994135447074072, 5.314082805982693, 5.14101207876770872, 4.34152036832427868, 2.98017351355729199, 2.97604998762285433, 2.91051841717230975, 2.52445971104487121, 2.57222809610280212, 2.65748820902418936, 2.60769538819585023, 2.34062038166930719, 2.68618948064286256, 2.73790215679933446, 2.7197170734838525, 2.1912722388712873, 1.81324561314170296, 2.29275126843668797, 2.29977554593295608, 2.48529020636925635, 1.49357163656988234, 1.55789453794186694, 1.24291157815972597, 1.42723790925654948, 3.03448980881031893, 3.31758530411866115, 3.51421489258759667, 4.03085569526018705, 4.31067678787898956, 4.22633122373638237, 4.28641712401959296, 4.76026847231384487, 5.17519131269941646, 4.63298979924521603, 4.71978198570275609, 3.62685853580837492, 3.50635823753699905, 3.62360863989543969, 3.7685982833417766, 3.58474131264943763, 3.01720134632009618, 2.80386836816184504, 2.59304525838068356, 1.6018827506987745, 1.68601743142528515, 1.76755912641077839, 1.89301687360102533, 0.803902757192008321, 0.166745194388379092, 0.53482099257820126, 0.312135846005610507, 1.05731242097258726, 1.34827617060278104, 1.34673546714142267, 1.48008127595573824, 1.23024224479988376, 1.09568992944403409, 1.07367041008646624, 1.19569794254183126, 0.341712403365115547, -0.125279643932605211, -0.155260827707288995, -0.144697164433229608, -2.08552887523031671, -3.14097874434922142, -3.05787530181765366, -3.83642664428939328, -3.95806185009425526, -3.89085662941241095, -3.76520864547503376, -4.10472788974257785 },
                MaxValue = 100,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-4
            },
            new ReferenceDataInfo
            {
                Name = "(3) MaxValue=1, Hurst=0.6, cumulative=false",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.0789533820470832703, -0.0208903807816354127, 0.00943991760000545931, 0.0168271872444949074, -0.0289243989626627798, -0.0212170884899674679, 0.0050031432736275909, 0.01461738653714122, 0.0246331132092980284, -0.0329305155321565068, 0.00426493550705470733, -0.0260395900693531912, 0.0504053422815368898, -0.00122744401104206945, 0.0155717596245738017, -0.0129637758013070991, 0.000476617478866937837, -0.00680201593239705433, 0.0124988865993036005, -0.0301523108702685359, -0.0198010470381336581, 0.0107305015447460902, 0.00641360251097373123, 0.00150208230548853601, 0.00985671663829972532, 0.0023462705092592794, 0.00289350585358590876, -0.011169956518731327, 0.0762640020371628119, 0.0244868367146223245, 0.0439379318488096332, 0.0433857491937086268, -0.018196098590163183, -0.00834665837434575217, 0.0152815932129821367, 0.0044872034515544227, 0.013274632936015442, -0.00430900251902584415, 0.0269073381017760037, -0.00942790052655825654, -0.0194452397174743087, -0.00487646105917880629, 0.0010718233922676543, -0.023501423107945358, 0.0484740503207757509, 0.0114953605630202464, 0.0479236853979875116, 0.0312220725432185604, 0.00962902318655404349, -0.00525497626570488319, 0.0484232725851081805, -0.0664186572518861984, -0.0317169276394879546, 0.0135482733880092909, 0.0313432788182121877, 0.123970231694515903, 0.00434038791765099016, -0.00870266474317764847, 0.0347776598597277498, -0.0799032544992929611, -0.00357785473609301087, 0.00282591018647584047, 0.0736114391990700528, 0.0617487816416197668, -0.0558340281386064743, -0.00529382364780457606, 0.0161144206026579383, 0.0232078640473156669, -0.0303622746633414597, -0.0049254744140309727, 0.0103982983007577176, 0.00353122735778836237, -0.00712577661825686704, -0.00331041645371878048, 0.0579553992484216698, 0.0127161551993898673, -0.0589332212496420857, -0.00875517671440772562, -0.0171118943441689354, -0.0188907971153522043, -0.0202649505985824999, -0.0158647448951462905, 0.0291430879036230737, 0.0542430920904613326, -0.0606009495008849042, -0.0106299484250374013, -0.107452457461840942, 0.0483762321650751531, 0.0410911309655947257, 0.0201696388800012977, 0.0364953374093279423, -0.0228208406464145384, 0.00543000631473398217, 0.00960666717715270846, 0.0602004853273315418, -0.0597806383592297541, -0.0308477837423090616, -0.0233947662108100959, -0.0146381803932722262, -0.0240269572600610958, -0.00598832960980160128, -0.0250777860309654051, 0.0309267160616036284, -0.00219194199585806418, -0.0157636996156910111, -0.0327474307704755038, 0.00284981084096491265, 0.0268265873031585042, -0.00501273770603699598, -0.027838244311243935, 0.0357709908555379763, 0.0656390764196483484, -0.00967428493018187077, 0.00286256142061533554, -0.0228516158049094052, 0.0373420790745565973, -0.000227712037879242661, 0.0101375505338957249, -0.00501994245507550452, 0.032168371025558945, 0.00489017045121414081, 0.0361271460458779253, 0.0521404705652335765, -0.0256950087842889204, -0.00333277913675111359, -0.0238776808561469885, 0.0820719962697775141, 0.0257357350382610497, -0.000883421370687790804, -0.0152438669591697645, -0.00420946419510255521, 0.0391339558363384202, 0.00208583146260850425, 0.0127572261873071056, 0.0735122536836581714, 0.0448004653793209334, 0.0144003583792349406, 0.0385901441957799754, -0.0484579750683242078, 0.021303726546695944, 0.00744421199441445275, 0.071789340390312914, -0.0605896283461073645, -0.0373195266577337134, -0.0114090271423545608, 0.00515261827178472003, 0.0476792762375996826, -0.0119280889306175326, 0.0225209819770911465, -0.00888452175656459162, -0.136769275620936104, -0.0148551631628971292, -0.0263629887704165886, 0.0152498889195591611, -0.0186433534879380976, -0.0290220256331201742, -0.0229378839679684823, -0.0406459740964957017, 0.0396704773157753876, -0.00146924156871158069, 0.0223218268033864853, -0.0473839257498610208, -0.110967417240833532, 0.0121126823764428643, -0.0451348402279620822, 0.0531408444089686779, 0.0192660216343632784, -0.00808179943129938051, -0.0369947105742545815, 0.0387970946625692745, 0.117303198605758441, -0.0131170508169121177, 0.0470522145878576395, -0.0612648750377387877, -0.00419361385243687251, -0.00061812640215399325, 0.0433155616203431473, -0.0453897694700295187, -0.0792584653714313858, -0.00242503879010906153, -0.0105362589420622474, 0.0126431572255308669, -0.0490917751269637492, -0.0113337469948562603, -0.0290075819171705454, -0.0364583615210824843, -0.0369318728548375316, -0.0109200246450822484, -0.0504445166555314364, -0.085895179640024133, -0.000260176897348805001, -0.00413476256710923386, -0.0243586576031627963, 0.00301398133862595431, 0.00537954944389599978, -0.00314171460040269619, -0.0168512936895017784, 0.0218039361022767456, 0.00326284928236517504, -0.00114740118778876798, -0.0333426149551418957, -0.0238518675913146454, 0.0302547614928158556, 0.00044320194759372842, 0.0117051837511032673, -0.062573211527230832, 0.00405850070389287328, -0.0198740811860651199, 0.0116302052386628649, 0.10141073904531929, 0.017862118195405674, 0.012406488298659292, 0.0325978308904413122, 0.0176555173528305624, -0.00532184531701031683, 0.00379116400833963158, 0.0298979988398100048, 0.0261798613533859581, -0.0342106027102203822, 0.00547621674888795155, -0.0689588077665490018, -0.00760305482063785166, 0.00739800025113159128, 0.0091482280406030847, -0.0116005905992211007, -0.0358093510041539442, -0.0134604009388781219, -0.0133020389502577982, -0.0625381263795306563, 0.00530853947298880625, 0.00514493313324607387, 0.00791584870116256341, -0.0687184550725325333, -0.0402019243842049873, 0.0232240128193277676, -0.0140504828736624492, 0.0470174632910009271, 0.0183585714806666946, -9.72118164610116748e-05, 0.00841355174270441014, -0.0157637771645602262, -0.00848967715905884004, -0.00138933774605811658, 0.00769941678315076358, -0.0538828448023426568, -0.0294652062056338683, -0.00189168480988471271, 0.000666522092738345987, -0.122458202232748045, -0.0665943846651231575, 0.00524347274168802772, -0.0491232687587458278, -0.00767466264499374641, 0.00424036275766217965, 0.00792785182844174541, -0.0214222160762971708 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = false,
                Epsilon = 1e-6
            },
            new ReferenceDataInfo
            {
                Name = "(4) MaxValue=1, Hurst=0.6, cumulative=true",
                ExpectedArrayLength = 256,
                ExpectedArray = new[] { 0.0789533820470832703, 0.0580630012654478611, 0.0675029188654533152, 0.0843301061099482191, 0.0554057071472854393, 0.0341886186573179679, 0.0391917619309455623, 0.0538091484680867788, 0.0784422616773848003, 0.0455117461452282934, 0.0497766816522830016, 0.0237370915829298104, 0.0741424338644667003, 0.072914989853424636, 0.0884867494779984359, 0.0755229736766913351, 0.0759995911555582798, 0.0691975752231612229, 0.0816964618224648165, 0.0515441509521962771, 0.0317431039140626189, 0.0424736054588087109, 0.0488872079697824438, 0.0503892902752709829, 0.0602460069135707099, 0.062592277422829995, 0.0654857832764159098, 0.0543158267576845794, 0.130579828794847391, 0.155066665509469709, 0.199004597358279356, 0.24239034655198799, 0.2241942479618248, 0.215847589587479044, 0.231129182800461186, 0.235616386252015614, 0.248891019188031054, 0.244582016669005198, 0.271489354770781177, 0.262061454244222947, 0.242616214526748641, 0.237739753467569842, 0.238811576859837504, 0.215310153751892136, 0.263784204072667894, 0.275279564635688145, 0.323203250033675671, 0.354425322576894242, 0.364054345763448306, 0.358799369497743437, 0.407222642082851638, 0.340803984830965412, 0.309087057191477443, 0.322635330579486734, 0.353978609397698929, 0.477948841092214805, 0.482289229009865816, 0.473586564266688159, 0.508364224126415909, 0.428460969627122934, 0.424883114891029923, 0.427709025077505745, 0.501320464276575839, 0.563069245918195627, 0.507235217779589131, 0.501941394131784513, 0.518055814734442399, 0.541263678781758073, 0.510901404118416558, 0.505975929704385541, 0.51637422800514321, 0.519905455362931535, 0.512779678744674672, 0.509469262290955904, 0.567424661539377539, 0.580140816738767384, 0.521207595489125319, 0.512452418774717589, 0.495340524430548657, 0.47644972731519647, 0.456184776716613949, 0.440320031821467672, 0.46946311972509075, 0.523706211815552103, 0.463105262314667199, 0.452475313889629804, 0.345022856427788849, 0.393399088592863988, 0.434490219558458735, 0.454659858438460018, 0.49115519584778794, 0.468334355201373398, 0.473764361516107402, 0.483371028693260096, 0.543571514020591673, 0.483790875661361919, 0.452943091919052854, 0.429548325708242751, 0.414910145314970502, 0.390883188054909403, 0.38489485844510779, 0.359817072414142403, 0.390743788475746034, 0.388551846479887997, 0.372788146864196979, 0.340040716093721496, 0.342890526934686413, 0.369717114237844924, 0.364704376531807928, 0.336866132220563996, 0.372637123076101973, 0.438276199495750307, 0.428601914565568454, 0.431464475986183815, 0.408612860181274407, 0.445954939255831018, 0.445727227217951771, 0.455864777751847472, 0.450844835296771995, 0.483013206322330912, 0.487903376773545061, 0.524030522819422973, 0.576170993384656605, 0.550475984600367729, 0.547143205463616611, 0.523265524607469668, 0.605337520877247126, 0.631073255915508224, 0.630189834544820471, 0.614945967585650677, 0.61073650339054808, 0.649870459226886465, 0.651956290689495011, 0.664713516876802135, 0.738225770560460348, 0.783026235939781268, 0.797426594319016191, 0.836016738514796187, 0.787558763446472021, 0.80886248999316801, 0.816306701987582484, 0.888096042377895412, 0.82750641403178804, 0.790186887374054292, 0.778777860231699703, 0.783930478503484407, 0.831609754741084117, 0.819681665810466531, 0.842202647787557712, 0.833318126030993089, 0.696548850410056986, 0.681693687247159841, 0.655330698476743301, 0.670580587396302441, 0.651937233908364333, 0.622915208275244159, 0.599977324307275683, 0.559331350210779954, 0.599001827526555397, 0.597532585957843865, 0.619854412761230322, 0.572470487011369267, 0.461503069770535734, 0.473615752146978597, 0.428480911919016494, 0.481621756327985151, 0.500887777962348402, 0.492805978531049016, 0.455811267956794441, 0.494608362619363695, 0.611911561225122136, 0.598794510408209968, 0.645846724996067656, 0.584581849958328847, 0.580388236105891964, 0.57977010970373799, 0.623085671324081103, 0.577695901854051619, 0.498437436482620233, 0.496012397692511153, 0.485476138750448927, 0.498119295975979814, 0.449027520849016093, 0.437693773854159807, 0.40868619193698924, 0.372227830415906735, 0.335295957561069224, 0.324375932915986986, 0.273931416260455529, 0.188036236620431396, 0.187776059723082589, 0.183641297155973354, 0.159282639552810551, 0.16229662089143651, 0.167676170335332497, 0.164534455734929808, 0.147683162045428029, 0.169487098147704768, 0.172749947430069939, 0.171602546242281162, 0.138259931287139259, 0.114408063695824611, 0.144662825188640459, 0.145106027136234189, 0.15681121088733746, 0.0942379993601066279, 0.0982965000639994951, 0.0784224188779343717, 0.0900526241165972297, 0.191463363161916533, 0.209325481357322207, 0.221731969655981492, 0.254329800546422791, 0.271985317899253343, 0.266663472582243044, 0.270454636590582664, 0.300352635430392645, 0.326532496783778603, 0.292321894073558242, 0.297798110822446171, 0.22883930305589717, 0.221236248235259308, 0.228634248486390912, 0.237782476526993997, 0.226181885927772885, 0.190372534923618941, 0.176912133984740816, 0.163610095034483011, 0.101071968654952354, 0.106380508127941156, 0.111525441261187228, 0.119441289962349789, 0.050722834889817256, 0.0105209105056122687, 0.0337449233249400363, 0.0196944404512775853, 0.0667119037422785055, 0.0850704752229451966, 0.0849732634064841869, 0.0933868151491885901, 0.0776230379846283569, 0.0691333608255695203, 0.0677440230795113979, 0.075443439862662165, 0.0215605950603195082, -0.00790461114531436013, -0.00979629595519907262, -0.00912977386246072685, -0.131587976095208781, -0.198182360760331938, -0.192938888018643923, -0.242062156777389736, -0.249736819422383488, -0.245496456664721308, -0.237568604836279562, -0.258990820912576747 },
                MaxValue = 1,
                HurstExponent = 0.6,
                IsCumulative = true,
                Epsilon = 1e-5
            }
        };

        [TestMethod]
        public void FractionalBrownianMotionGenerator_GenerateHosking_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataHosking)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.GenerateHosking(nrg, rdi.ExpectedArrayLength, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        [TestMethod]
        public void FractionalBrownianMotionGenerator_GeneratePaxson_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataPaxson)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.GeneratePaxson(nrg, actualArray.Length, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        [Ignore]
        [TestMethod]
        public void FractionalBrownianMotionGenerator_GenerateCirculant_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataCirculant)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.GenerateCirculant(nrg, actualArray.Length, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        [TestMethod]
        public void FractionalBrownianMotionGenerator_GenerateApproximateCirculant_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataApproximateCirculant)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.GenerateApproximateCirculant(nrg, actualArray.Length, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        [TestMethod]
        public void FractionalBrownianMotionGenerator_Generate_Hosking_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataHosking)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.Generate(FractionalBrownianMotionAlgorithm.Hosking, nrg, rdi.ExpectedArrayLength, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        [TestMethod]
        public void FractionalBrownianMotionGenerator_Generate_Paxson_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataPaxson)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.Generate(FractionalBrownianMotionAlgorithm.Paxson, nrg, actualArray.Length, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        [Ignore]
        [TestMethod]
        public void FractionalBrownianMotionGenerator_Generate_Circulant_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataCirculant)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.Generate(FractionalBrownianMotionAlgorithm.Circulant, nrg, actualArray.Length, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        [TestMethod]
        public void FractionalBrownianMotionGenerator_Generate_ApproximateCirculant_ReferenceImplementationConformance()
        {
            foreach (var rdi in ReferenceDataApproximateCirculant)
            {
                INormalRandomGenerator nrg = new ReferenceNormalRandom();
                double[] actualArray = new double[rdi.ExpectedArrayLength];
                FractionalBrownianMotionGenerator.Generate(FractionalBrownianMotionAlgorithm.ApproximateCirculant, nrg, actualArray.Length, actualArray, rdi.MaxValue, rdi.HurstExponent, rdi.IsCumulative);
                for (int i = 0; i < rdi.ExpectedArrayLength; ++i)
                {
                    Assert.AreEqual(rdi.ExpectedArray[i], actualArray[i], rdi.Epsilon, Invariant($"{rdi.Name}, i={i}, exp={rdi.ExpectedArray[i]}, act={actualArray[i]}"));
                }
            }
        }

        private class ReferenceDataInfo
        {
            public string Name { get; set; }

            public int ExpectedArrayLength { get; set; }

            public double[] ExpectedArray { get; set; }

            public double MaxValue { get; set; }

            public double HurstExponent { get; set; }

            public bool IsCumulative { get; set; }

            public double Epsilon { get; set; }
        }

        private class ReferenceNormalRandom : INormalRandomGenerator
        {
            private int index = -1;

            public bool CanReset => true;

            public double NextDouble()
            {
                return NextDoubleStandard();
            }

            public double NextDouble(double mean, double stdDev)
            {
                return mean + NextDoubleStandard() * stdDev;
            }

            public double NextDoubleStandard()
            {
                if (++index == ReferenceNormalVariatesLength)
                {
                    index = 0;
                }

                return ReferenceNormalVariates[index];
            }

            public void Reset()
            {
                index = -1;
            }
        }
    }
}
