using System.Linq;
using Mbs.Numerics.RandomGenerators.MersenneTwister;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators.MersenneTwister
{
    [TestClass]
    public class MersenneTwisterSfmt1279UniformRandomTests
    {
        private const int Seed = 12345;
        private const int Count = 5000;

        private static readonly ulong[] ExpectedULong =
        {
            243307689UL, 3927268025UL, 1225611617UL, 570598983UL, 3842545525UL,
            2650524507UL, 1977115969UL, 1192210573UL, 3351391148UL, 3300947918UL,
            3372624199UL, 3407802072UL, 2630055668UL, 1419320069UL, 1694567123UL,
            363293933UL, 1331811503UL, 3765039298UL, 3154732976UL, 1386095844UL,
            2088338954UL, 3179212843UL, 1879834946UL, 1381367989UL, 2758426993UL,
            3290922490UL, 459138429UL, 2772088455UL, 284265626UL, 697699287UL,
            2148849595UL, 828780633UL, 3291316348UL, 576422791UL, 275230034UL,
            1474356354UL, 3722028763UL, 2138031578UL, 4177103613UL, 4137339754UL,
            1232401741UL, 4043538928UL, 3427323307UL, 3595434744UL, 1906729682UL,
            3659489301UL, 1834256938UL, 3029202183UL, 97587821UL, 2048440394UL,
            1397222890UL, 1811198800UL, 996357950UL, 1380272924UL, 1277165935UL,
            3490746181UL, 1680324265UL, 2623226542UL, 1602432444UL, 2419914264UL,
            2277911980UL, 708544804UL, 3187699868UL, 3677337889UL, 4055859070UL,
            1658078881UL, 1619018022UL, 3363378158UL, 1921644290UL, 2011581383UL,
            138070253UL, 675769351UL, 1612877422UL, 273511944UL, 468596116UL,
            182470517UL, 1706841301UL, 373389314UL, 2364268025UL, 2312437139UL,
            448125051UL, 3371514413UL, 3852314136UL, 279816466UL, 3571256055UL,
            2020707519UL, 3176603579UL, 3648714571UL, 73041169UL, 1264080802UL,
            1750460123UL, 2183872120UL, 455542005UL, 3869855862UL, 374947339UL,
            1520351483UL, 2830648441UL, 3198824746UL, 3507964709UL, 571754801UL,
            1289854592UL, 2337973476UL, 146275613UL, 3969269402UL, 3262119711UL,
            1216813420UL, 2294680347UL, 2840195745UL, 1850086589UL, 1856100637UL,
            4211340098UL, 1377510072UL, 3853102437UL, 1902663352UL, 3538391489UL,
            2996326854UL, 3231264057UL, 1101032772UL, 758447978UL, 187810425UL,
            2439774579UL, 1017833835UL, 59587497UL, 1928607216UL, 1617764019UL,
            339047277UL, 930821830UL, 2586071960UL, 1063510137UL, 515302564UL,
            2412582028UL, 4002288056UL, 2144553442UL, 3999925578UL, 3233514864UL,
            619406521UL, 2768097132UL, 2582590481UL, 2898912566UL, 3470045815UL,
            4106179272UL, 3524913242UL, 3519280152UL, 1599328782UL, 461871261UL,
            1873369485UL, 522553804UL, 4255857469UL, 1790117270UL, 967937857UL,
            3501055558UL, 537302922UL, 3413332073UL, 1622333710UL, 1603949374UL,
            3517907836UL, 1815470840UL, 4135030570UL, 1503354583UL, 3071191368UL,
            2538465807UL, 2338077641UL, 131769633UL, 695477236UL, 2245554640UL,
            2740236084UL, 311302898UL, 248798748UL, 2430599814UL, 3077330694UL,
            1940402939UL, 1142414789UL, 2907537091UL, 1195230066UL, 2697684038UL,
            1797253757UL, 2515741922UL, 103457008UL, 2258780711UL, 1138069055UL,
            2175573922UL, 1664952435UL, 665429891UL, 843477118UL, 1418756165UL,
            2374105774UL, 2150500853UL, 1571861609UL, 2878173292UL, 2234696811UL,
            1862239359UL, 2279641173UL, 1412473876UL, 703013607UL, 3897836242UL,
            2284477080UL, 3560958856UL, 1867204569UL, 3484825299UL, 1771788197UL,
            2158473514UL, 1161647906UL, 813597051UL, 204314377UL, 1659259675UL,
            272217365UL, 3808336509UL, 1932286213UL, 2684787307UL, 2761326701UL,
            566346011UL, 2523251293UL, 3652281601UL, 3937549568UL, 2460713748UL,
            1715085688UL, 1074092064UL, 1658456308UL, 458444117UL, 4110560247UL,
            1887246870UL, 2203038418UL, 235896608UL, 3259567594UL, 2778304053UL,
            2638655950UL, 1507956570UL, 1989069120UL, 1953523639UL, 1634682606UL,
            2658186222UL, 1706309507UL, 2499417418UL, 1100978532UL, 1454354270UL,
            424020092UL, 842389406UL, 3125613306UL, 1985184029UL, 1335501806UL,
            3094759426UL, 2118755645UL, 3554268828UL, 2362609340UL, 359804516UL,
            1940034183UL, 110009715UL, 3588492799UL, 2092384927UL, 4096477125UL,
            576242245UL, 3368796173UL, 2327930223UL, 1259021278UL, 1329869184UL,
            3927489155UL, 4236819987UL, 404005503UL, 1329834932UL, 685658901UL,
            2492965223UL, 4266282709UL, 1178383025UL, 3090023471UL, 57331106UL,
            1980118524UL, 955118412UL, 2997154768UL, 2724738534UL, 3009083860UL,
            569830663UL, 3676347180UL, 723796622UL, 3505006386UL, 1638332449UL,
            1185444609UL, 1747872198UL, 3449879675UL, 4160951800UL, 3093444586UL,
            389983725UL, 1488273052UL, 2327551721UL, 3110370112UL, 2688115225UL,
            1163526508UL, 2076072949UL, 884974157UL, 610684798UL, 1580810842UL,
            3055229619UL, 671133067UL, 436611424UL, 848802126UL, 1082755279UL,
            1204462154UL, 989074252UL, 986665864UL, 286230035UL, 2492361985UL,
            3095172407UL, 854557911UL, 1505130850UL, 221230931UL, 214812920UL,
            2039406056UL, 3922867961UL, 2413954396UL, 3761826283UL, 3010868473UL,
            4162989495UL, 1929326878UL, 1922083823UL, 2533458315UL, 2503189307UL,
            2338900678UL, 2102656874UL, 1658135241UL, 4055553566UL, 1680235492UL,
            2308340235UL, 2987180055UL, 389060953UL, 1846235420UL, 3981604027UL,
            53813536UL, 1224570427UL, 2847702043UL, 3542845181UL, 383885763UL,
            1130173784UL, 3187625887UL, 3206056132UL, 712901702UL, 3507774978UL,
            3753119158UL, 2424089455UL, 1811631923UL, 2260041572UL, 2466447016UL,
            3850375562UL, 873876296UL, 3500042922UL, 3840692059UL, 3334991895UL,
            1719151437UL, 604450411UL, 3300111865UL, 3143257251UL, 3913191458UL,
            3689590482UL, 2231740425UL, 1146268819UL, 3535629137UL, 4206151297UL,
            572287146UL, 2566544038UL, 548851452UL, 3598942369UL, 2656958901UL,
            1084324546UL, 2426482567UL, 42148969UL, 142282925UL, 4133002117UL,
            3483160256UL, 149104302UL, 2001829841UL, 2337060178UL, 2383916317UL,
            2035481560UL, 2041759447UL, 2495503243UL, 768395644UL, 3167810051UL,
            3638841514UL, 1940382470UL, 3033981507UL, 157556709UL, 778957423UL,
            4019145337UL, 3274590968UL, 3559746317UL, 3266470743UL, 1150215464UL,
            1574599700UL, 2135553359UL, 2712354080UL, 1516502257UL, 1558537014UL,
            600268054UL, 1109893079UL, 995498023UL, 2455773654UL, 2331891975UL,
            1806115915UL, 2358087283UL, 3236532773UL, 3576921624UL, 3889611971UL,
            903148351UL, 1981654469UL, 4262286007UL, 338938067UL, 1807836874UL,
            2052603591UL, 889693974UL, 1440199441UL, 1102024144UL, 761032860UL,
            2638670359UL, 1193628098UL, 974077300UL, 1487266359UL, 331191160UL,
            651970989UL, 635783103UL, 2613516326UL, 1261675221UL, 1407602233UL,
            4065786152UL, 2230985684UL, 2561318852UL, 116914299UL, 4113660294UL,
            372587256UL, 2923425930UL, 2125443286UL, 551419957UL, 3830182440UL,
            2960138236UL, 2041060611UL, 1664933527UL, 920683498UL, 1493156584UL,
            656673121UL, 3886029759UL, 970612110UL, 998770833UL, 668426918UL,
            3881762784UL, 3412024868UL, 797208815UL, 512631264UL, 2479235109UL,
            4196671971UL, 2612943159UL, 3447997343UL, 981308402UL, 1465942691UL,
            4258902547UL, 2491408924UL, 3462040745UL, 2122826714UL, 2575985604UL,
            1936785778UL, 2657831725UL, 1501699308UL, 477453942UL, 772382821UL,
            3548450617UL, 300349179UL, 2127078044UL, 296131829UL, 3658712744UL,
            650332035UL, 1834152944UL, 243879565UL, 190176099UL, 2203454009UL,
            99956383UL, 685426307UL, 128058728UL, 2929998788UL, 1945236876UL,
            4150233994UL, 3860976209UL, 661234083UL, 1471520997UL, 1666382364UL,
            3080172348UL, 259318961UL, 572929904UL, 1100426287UL, 4191359454UL,
            3235499964UL, 1046235034UL, 2630718304UL, 3129838289UL, 4136748761UL,
            3539720609UL, 3976281042UL, 3165364769UL, 1330939836UL, 3400782203UL,
            1334607851UL, 2241273387UL, 855844892UL, 1297221007UL, 1357150235UL,
            2489518287UL, 1557769541UL, 2397305270UL, 4294513014UL, 2839645351UL,
            1125225232UL, 2114284729UL, 3348437881UL, 1254408346UL, 1766690575UL,
            3048489792UL, 3984173540UL, 1267719328UL, 2999289144UL, 2458016726UL,
            309143407UL, 1242110708UL, 2812297574UL, 3273840162UL, 839867982UL,
            4147583716UL, 2070051583UL, 2375214037UL, 3160353392UL, 2239522337UL,
            3317592261UL, 1446706845UL, 919513410UL, 2409805086UL, 1665952546UL,
            3124141237UL, 2494522707UL, 4073842322UL, 1999507897UL, 1357346844UL,
            2026257344UL, 4053196719UL, 413561071UL, 1299052303UL, 3296456753UL,
            1359350913UL, 2584437509UL, 2164106054UL, 1906708382UL, 1694946636UL,
            2278061153UL, 2623126493UL, 1007604923UL, 1732931691UL, 1027605291UL,
            130669652UL, 3098584233UL, 343419409UL, 1392724360UL, 2361010930UL,
            1432673180UL, 2629969452UL, 1134250972UL, 3336368801UL, 1265875481UL,
            294793551UL, 2782613173UL, 4177474983UL, 667162989UL, 4094797143UL,
            1885199780UL, 456236296UL, 1914930778UL, 1224799774UL, 2466502791UL,
            64866558UL, 654281350UL, 4180600511UL, 899913719UL, 1668746941UL,
            1534812021UL, 1741722225UL, 4022070021UL, 117981343UL, 593247870UL,
            19621335UL, 3693512794UL, 2737959212UL, 3788895542UL, 4074549995UL,
            3673769440UL, 1082250204UL, 4196895557UL, 2043617183UL, 1827577995UL,
            294711202UL, 4070382067UL, 577072527UL, 2836270245UL, 89171809UL,
            2321557780UL, 1733217446UL, 3095784821UL, 3210131227UL, 1574160296UL,
            1264037086UL, 156882828UL, 3860461939UL, 3200806462UL, 1012089079UL,
            3216640393UL, 3313554265UL, 934929736UL, 139204567UL, 3773157069UL,
            4069275623UL, 3657302301UL, 3367880859UL, 3894185380UL, 2622366450UL,
            2879296239UL, 2820441187UL, 733486613UL, 193589593UL, 4169451285UL,
            1404663971UL, 1951265220UL, 465025209UL, 3805801053UL, 1410891819UL,
            403825953UL, 1671201407UL, 1079261766UL, 131498694UL, 652649109UL,
            3458742704UL, 171702478UL, 773603018UL, 3627251619UL, 740792554UL,
            1694503643UL, 1499160101UL, 2699823666UL, 2399829724UL, 4057123765UL,
            3788391668UL, 1818310211UL, 3623536177UL, 855107731UL, 1766324829UL,
            2708995454UL, 2573012777UL, 2223077190UL, 1626358626UL, 3872990141UL,
            3238079449UL, 2623630495UL, 973241668UL, 788074019UL, 1685775681UL,
            506864382UL, 3932638192UL, 2708837465UL, 1894899797UL, 1636345010UL,
            41547975UL, 2466265263UL, 582141619UL, 2451431587UL, 1494430856UL,
            1671987268UL, 477848912UL, 2123325303UL, 2762260835UL, 627636365UL,
            133948118UL, 313935922UL, 2416910906UL, 299205336UL, 1212667597UL,
            684643609UL, 1002038080UL, 657161622UL, 2499666462UL, 4043132408UL,
            2963959263UL, 1021307457UL, 2271915975UL, 4074991297UL, 1032583855UL,
            992435695UL, 3789253376UL, 404676908UL, 3157779991UL, 1255639032UL,
            117667653UL, 3198051509UL, 1832805842UL, 3990938705UL, 3495412250UL,
            2096110988UL, 2051253187UL, 2231922298UL, 1741938094UL, 3571792959UL,
            2030352786UL, 1060613516UL, 3937016435UL, 2075693405UL, 2254767111UL,
            1702403132UL, 4083249181UL, 754385218UL, 151918790UL, 4174653586UL,
            3540119065UL, 3829244448UL, 326165234UL, 3756914698UL, 3144835628UL,
            1493148100UL, 3577628024UL, 3586217148UL, 890356621UL, 3785045426UL,
            4105137657UL, 56175760UL, 4070460799UL, 4218525406UL, 4122608639UL,
            335829121UL, 3310952079UL, 1366219900UL, 3180624723UL, 3722879895UL,
            3669520531UL, 3111243641UL, 666592444UL, 2608256776UL, 2915785163UL,
            2255808676UL, 4034783141UL, 3654142398UL, 1625056644UL, 3516524622UL,
            2670125358UL, 206920446UL, 579347843UL, 1493975508UL, 2262966981UL,
            2404594249UL, 2892390122UL, 2056478367UL, 3198325018UL, 596475293UL,
            2321797432UL, 396140749UL, 138983385UL, 1618219277UL, 4250904742UL,
            3032834806UL, 423671549UL, 1360932374UL, 2584003391UL, 181445285UL,
            686584262UL, 3208920064UL, 1341949426UL, 220358903UL, 9471733UL,
            2795732004UL, 3377034001UL, 2990194391UL, 3486241431UL, 1701163680UL,
            3862826156UL, 1866797172UL, 1247303606UL, 3954560752UL, 817988160UL,
            1713310212UL, 3764070466UL, 3183598090UL, 4130463065UL, 1485218893UL,
            2365745133UL, 3347596356UL, 3587379582UL, 622968568UL, 3534486352UL,
            2301927366UL, 3468865559UL, 2347320885UL, 435767869UL, 3807107480UL,
            3777085822UL, 2340067200UL, 1098731295UL, 2327785223UL, 403445260UL,
            3866810735UL, 688574575UL, 4134388103UL, 642120144UL, 499472064UL,
            1568147160UL, 3296780690UL, 2871968723UL, 2875210391UL, 1896179293UL,
            1853147163UL, 2835166628UL, 1853367481UL, 2454305808UL, 600536991UL,
            2443929811UL, 315106420UL, 2328335076UL, 1683105123UL, 384265381UL,
            1845998326UL, 3673705166UL, 3996716053UL, 91692742UL, 4172029073UL,
            363425183UL, 1684676538UL, 2654123344UL, 3660082040UL, 3359702927UL,
            230951962UL, 3853113523UL, 2775651726UL, 2816073988UL, 787546797UL,
            2438098980UL, 1273462350UL, 1012417676UL, 2105251513UL, 43746769UL,
            1384474423UL, 4241231474UL, 2963962421UL, 1584908388UL, 2169420907UL,
            988156308UL, 407513623UL, 3111345078UL, 2480695873UL, 2625529975UL,
            2564516786UL, 2972744330UL, 3444964361UL, 143194736UL, 3576215512UL,
            526450428UL, 499279381UL, 3809598464UL, 2691987658UL, 2152629479UL,
            96969524UL, 3205640565UL, 499292085UL, 1916666912UL, 2232616585UL,
            3428023186UL, 2593900305UL, 2066585340UL, 1677708638UL, 721675102UL,
            3285601716UL, 3194701468UL, 3630699081UL, 1329243126UL, 3964617782UL,
            959532177UL, 95357895UL, 2867616947UL, 2370655880UL, 3400382774UL,
            2796661450UL, 2935483337UL, 1192655634UL, 2520815974UL, 2221188282UL,
            3737544917UL, 2690337649UL, 3795432961UL, 4223684846UL, 1723055481UL,
            2595621141UL, 3941583985UL, 3580798337UL, 3816735556UL, 2364385201UL,
            4210666486UL, 2774901662UL, 1079008505UL, 2011387204UL, 2347258467UL,
            1554710802UL, 1878757983UL, 2405820523UL, 3742535999UL, 3358304258UL,
            4187889110UL, 2522741250UL, 916514934UL, 3539199701UL, 2602244649UL,
            895328533UL, 507068499UL, 1749961391UL, 2117575035UL, 3233311788UL,
            722462516UL, 1420710957UL, 3823466309UL, 1232808101UL, 2873281059UL,
            4254045711UL, 310396089UL, 2868623773UL, 1867877112UL, 3664246818UL,
            3170594987UL, 447640912UL, 2413609145UL, 3950122223UL, 1502992005UL,
            3898968148UL, 2355522019UL, 3565785477UL, 2197256721UL, 3813063371UL,
            2062612102UL, 1539725152UL, 913003178UL, 2117919546UL, 1421914458UL,
            3732402422UL, 757025681UL, 1566890241UL, 2832377646UL, 842445000UL,
            3277491540UL, 4287634730UL, 477786633UL, 2885092342UL, 298934263UL,
            170957263UL, 461671007UL, 57440856UL, 2036449706UL, 3248557400UL,
            3456524307UL, 1713969615UL, 528806514UL, 4146625954UL, 1224160913UL,
            2970337440UL, 3488296837UL, 989961242UL, 2504332083UL, 140371939UL,
            2110765652UL, 3136171575UL, 3560078074UL, 2089110433UL, 674437691UL,
            52666355UL, 283533388UL, 107852814UL, 1685728471UL, 877293439UL,
            3245779551UL, 1451314658UL, 3885554784UL, 2517707398UL, 2895653070UL,
            2059007918UL, 4112755052UL, 1238696154UL, 1862145631UL, 2265976322UL,
            4173645036UL, 1515296246UL, 951918382UL, 1587890716UL, 170113727UL,
            4222981316UL, 72025558UL, 144843233UL, 3432962087UL, 3506287882UL,
            66657331UL, 637106837UL, 406927341UL, 3964420203UL, 2127134160UL,
            1327235047UL, 227339400UL, 97109542UL, 1814799261UL, 340888197UL,
        };

        private static readonly ulong[] ExpectedULongArray =
        {
            3571940102UL, 3358790577UL, 1185377893UL, 490641923UL, 1689429829UL,
            732262387UL, 3476409702UL, 1055721586UL, 1704668571UL, 131833278UL,
            2318686164UL, 971677888UL, 489886788UL, 1418897399UL, 1420774349UL,
            1452598647UL, 4068357231UL, 1471535202UL, 1665208152UL, 3226458127UL,
            2456051265UL, 1949316429UL, 2137468927UL, 256540922UL, 83856426UL,
            2006892539UL, 3954930952UL, 3444850271UL, 2144456509UL, 667300435UL,
            365125488UL, 29815556UL, 1780999112UL, 2625638364UL, 2974921225UL,
            155452962UL, 4132153609UL, 1779450021UL, 2462683988UL, 3734298329UL,
            3878785692UL, 1635530071UL, 1705576191UL, 701042291UL, 3820213232UL,
            2233077098UL, 884075658UL, 254429520UL, 1513242945UL, 3334830243UL,
            1390864725UL, 1877605359UL, 2763549443UL, 1948880708UL, 1891328177UL,
            1585113094UL, 603478195UL, 125346629UL, 231314253UL, 1966842545UL,
            2201793570UL, 2787193689UL, 3760440224UL, 481858146UL, 1139816234UL,
            2397713582UL, 2712201505UL, 3064064456UL, 394703180UL, 1495238581UL,
            1026471579UL, 2115261916UL, 2754606686UL, 2242415505UL, 3670758642UL,
            1053897322UL, 3050647041UL, 1916540206UL, 3399707307UL, 1314360401UL,
            2712258786UL, 3281903731UL, 727258282UL, 3094778985UL, 1243543918UL,
            951715568UL, 2886115274UL, 4223428131UL, 3546726905UL, 1298208683UL,
            3483958828UL, 2583238640UL, 3800071103UL, 3109257770UL, 3703211908UL,
            416176931UL, 664013243UL, 2405005885UL, 343959342UL, 1471852804UL,
            2401944148UL, 671028434UL, 2095292197UL, 3603871685UL, 3814105342UL,
            3470299634UL, 1696204622UL, 3546335689UL, 537574339UL, 3912873409UL,
            3799566778UL, 2419073237UL, 2722379502UL, 916321360UL, 3500567111UL,
            1482403017UL, 2136215999UL, 2635218234UL, 763506253UL, 4037302613UL,
            375658760UL, 2131597793UL, 3301615917UL, 3285276631UL, 489786570UL,
            3803284886UL, 2681849072UL, 2379733379UL, 2880996717UL, 2923461914UL,
            1149064352UL, 2584775699UL, 3933481723UL, 2147319579UL, 2291550411UL,
            478510147UL, 2355756378UL, 1242817125UL, 3213577511UL, 139091875UL,
            3133862487UL, 3287580807UL, 3408321628UL, 2157352262UL, 3273500758UL,
            952098632UL, 993851028UL, 3216519923UL, 180862681UL, 2169029865UL,
            638557434UL, 1236032756UL, 4008131798UL, 3308440509UL, 2244242791UL,
            2181891771UL, 3765680961UL, 4005998357UL, 2393969880UL, 3784537648UL,
            1292665792UL, 1444006164UL, 372641022UL, 3377918495UL, 3847734933UL,
            3626956008UL, 3634915146UL, 3057531652UL, 609375286UL, 4041330990UL,
            3865455351UL, 38812804UL, 1861523745UL, 1478765453UL, 3443359220UL,
            1422943008UL, 3643756858UL, 3561844206UL, 1167817685UL, 3062789514UL,
            3049788527UL, 3974815959UL, 1861121206UL, 1534681757UL, 2108285902UL,
            526143185UL, 3188570399UL, 338969449UL, 2051640388UL, 3417891544UL,
            763834708UL, 2831096102UL, 2401621396UL, 1477588937UL, 1150890288UL,
            4279156097UL, 260095441UL, 586540602UL, 969816142UL, 2121570854UL,
            1747298933UL, 231182518UL, 3864472844UL, 4118000359UL, 616376452UL,
            2550421366UL, 2099924623UL, 1540969109UL, 3999757424UL, 3323087835UL,
            1678851337UL, 3541421389UL, 3884714328UL, 3360298950UL, 3832060601UL,
            46029336UL, 1001643786UL, 2992886351UL, 4167312817UL, 2856333608UL,
            3969852359UL, 1881415818UL, 3400155108UL, 3469188313UL, 861925465UL,
            1911768158UL, 19973473UL, 2583936177UL, 1232063903UL, 589693414UL,
            2518500004UL, 1679956098UL, 2970989432UL, 1930715228UL, 2469942013UL,
            4236680042UL, 1435315612UL, 2806106788UL, 3787724481UL, 4196658019UL,
            146391466UL, 897360243UL, 2177464539UL, 3918574357UL, 1896515632UL,
            72607894UL, 3421801689UL, 3883872107UL, 1305453789UL, 969334363UL,
            1549960716UL, 1351848856UL, 3230567901UL, 1637141804UL, 2481614628UL,
            4212639925UL, 3389064431UL, 3255314442UL, 1276149955UL, 1979613157UL,
            1141510254UL, 3580210582UL, 3113891227UL, 2290875698UL, 3800696113UL,
            2221610479UL, 217621916UL, 3521334350UL, 3342307242UL, 2646706886UL,
            729840278UL, 880868674UL, 3342723580UL, 3611005846UL, 992149268UL,
            2916130589UL, 1914784314UL, 1968131756UL, 3723367005UL, 3133076970UL,
            1623769150UL, 2246455159UL, 3254805905UL, 1080176024UL, 3679438391UL,
            1109631436UL, 3768088091UL, 34005354UL, 364029516UL, 416791973UL,
            3556565157UL, 1962992668UL, 2076214298UL, 3176145275UL, 3813810355UL,
            2005022039UL, 2814920824UL, 1736782781UL, 472741691UL, 495097994UL,
            1136870874UL, 3165993546UL, 787555603UL, 500130322UL, 3162851673UL,
            462822354UL, 1412866811UL, 1187686233UL, 1880903342UL, 3445785070UL,
            124576000UL, 3750553118UL, 4164220569UL, 528036278UL, 1334999821UL,
            2311359573UL, 2652060732UL, 2505117113UL, 50255077UL, 1939833380UL,
            616502973UL, 3130841737UL, 3015718605UL, 1012698689UL, 2545824447UL,
            1562654346UL, 3491457142UL, 1330348796UL, 1489584315UL, 2037423028UL,
            3982070025UL, 2295117923UL, 3126657693UL, 2472477469UL, 3455003340UL,
            265554055UL, 797651117UL, 292932314UL, 2291425434UL, 2504910162UL,
            1251218141UL, 1259905745UL, 2781098763UL, 1929159292UL, 1053780605UL,
            2131059529UL, 4144236950UL, 938114138UL, 3568681785UL, 1879067476UL,
            2099340470UL, 1514510711UL, 1519442279UL, 795067701UL, 1148561197UL,
            3145126209UL, 3244831406UL, 1746556372UL, 4268606592UL, 3794283019UL,
            2800396413UL, 2288124928UL, 1308611733UL, 1996805357UL, 1421122628UL,
            3618675908UL, 1522453693UL, 2207860660UL, 3262442374UL, 2094133854UL,
            3182506082UL, 3215631478UL, 3705561920UL, 1273392803UL, 4217218343UL,
            541055181UL, 1178460326UL, 874763518UL, 262177349UL, 894783915UL,
            1249111010UL, 1270931263UL, 1174716175UL, 1609485492UL, 1100424325UL,
            1183796354UL, 3798303070UL, 3741635396UL, 435036119UL, 4179538159UL,
            523363408UL, 404552914UL, 980816158UL, 3926531161UL, 1453098065UL,
            3307624016UL, 104523157UL, 1762666802UL, 2317189947UL, 2023914793UL,
            997977744UL, 3567952179UL, 3894306103UL, 84322825UL, 3636729385UL,
            2273425555UL, 1428047232UL, 2567973175UL, 1928660804UL, 2024500573UL,
            1125454828UL, 3264921733UL, 1326282786UL, 3041866865UL, 2834873893UL,
            1565843473UL, 3850482960UL, 4012707767UL, 3808302766UL, 2723457696UL,
            3085848226UL, 286746762UL, 3747393393UL, 3309914863UL, 3802287857UL,
            3047767818UL, 845051189UL, 3373630831UL, 3502881841UL, 800948709UL,
            977864314UL, 2928664873UL, 1143374117UL, 3866363955UL, 791196931UL,
            1775883526UL, 3518463580UL, 647505838UL, 3030186301UL, 546292576UL,
            1093567984UL, 3975275226UL, 3866685200UL, 4180349616UL, 4232680798UL,
            1458234595UL, 2409111017UL, 1804039833UL, 2406421041UL, 2368301189UL,
            491874151UL, 2609037471UL, 1215628698UL, 1880104187UL, 1244163636UL,
            4185458636UL, 915019434UL, 987504717UL, 3438389993UL, 1115876674UL,
            1870054198UL, 2745867676UL, 140467020UL, 2514745667UL, 3961253067UL,
            4069966211UL, 2443538065UL, 1576948169UL, 2267044423UL, 929620934UL,
            1588144567UL, 323361980UL, 4146195664UL, 2034138271UL, 2943372927UL,
            3962248360UL, 929333602UL, 2816327231UL, 586818311UL, 2280516491UL,
            179906252UL, 669873469UL, 3557550001UL, 861516070UL, 3547725499UL,
            3963089708UL, 292802333UL, 2611469066UL, 4252061470UL, 1080305427UL,
            2933703920UL, 4132513557UL, 2905946448UL, 2657080740UL, 1138049754UL,
            2113340784UL, 3350841360UL, 1973567973UL, 1615897653UL, 3308876695UL,
            2285206647UL, 1998714290UL, 415269556UL, 2411796517UL, 2561227979UL,
            1031878275UL, 3045589730UL, 3544987135UL, 1000759675UL, 194322534UL,
            3476849911UL, 2797698961UL, 950480397UL, 1329877992UL, 239287316UL,
            533555346UL, 4229443303UL, 2063025706UL, 2117567018UL, 1389834744UL,
            618951403UL, 3748561227UL, 299445727UL, 3705306325UL, 1610031077UL,
            1218884363UL, 3219392076UL, 237982896UL, 1749821977UL, 591622892UL,
            2314196459UL, 916035746UL, 4257918426UL, 2901017124UL, 3691835431UL,
            1869917184UL, 2455354567UL, 4186619591UL, 3461745043UL, 2032058510UL,
            3082491786UL, 1287577947UL, 709624222UL, 455204942UL, 1446490139UL,
            2429654288UL, 3757847260UL, 1441302109UL, 4085634952UL, 2439675152UL,
            2094595546UL, 390780145UL, 1437581569UL, 3872252505UL, 2046256249UL,
            947096618UL, 4179318448UL, 4136302801UL, 2061241479UL, 1226541212UL,
            1149367190UL, 1460906803UL, 3837571860UL, 3949887571UL, 357038779UL,
            702890494UL, 1087428560UL, 521074527UL, 3144593759UL, 2359814827UL,
            118409742UL, 694420915UL, 2007770556UL, 2688311441UL, 289583082UL,
            1803557381UL, 4146589091UL, 704580254UL, 1196461017UL, 4051748280UL,
            1383992871UL, 996927865UL, 2480397248UL, 1699023992UL, 1408579291UL,
            2800869038UL, 1297725181UL, 1250228986UL, 1222203115UL, 927390586UL,
            2975302754UL, 3714174765UL, 2916353094UL, 4113265421UL, 534175283UL,
            1621202903UL, 819766866UL, 2627759017UL, 1702223052UL, 2954744328UL,
            4110314791UL, 1289897832UL, 1430641218UL, 3364066062UL, 2572174909UL,
            2367679991UL, 4009648508UL, 2771957348UL, 2626939394UL, 2596840704UL,
            2628486680UL, 2998036218UL, 3239249555UL, 1726075234UL, 2083013625UL,
            4090428420UL, 2446670968UL, 3751979705UL, 1936227422UL, 4083016294UL,
            1548059249UL, 355955598UL, 1281774682UL, 1613301352UL, 1475361747UL,
            2310604729UL, 1081863488UL, 4097739214UL, 671054472UL, 1343778826UL,
            1139795919UL, 1465507516UL, 2395199596UL, 2762216850UL, 435383439UL,
            3252959155UL, 2623461620UL, 4226410306UL, 3431636074UL, 2959264324UL,
            4134753579UL, 3504496272UL, 18424919UL, 1950153878UL, 938526244UL,
            2197574906UL, 2674507561UL, 4199320562UL, 990801810UL, 3748993934UL,
            2073711546UL, 1864722386UL, 879947004UL, 1841740996UL, 3812590261UL,
            2937978792UL, 3715085350UL, 2010826809UL, 462571934UL, 4017736482UL,
            94372833UL, 2598582380UL, 791092918UL, 2071713533UL, 3161948930UL,
            1676421292UL, 3797264923UL, 3394643093UL, 634398506UL, 3844123145UL,
            466000557UL, 1732232404UL, 1201221618UL, 51147681UL, 2758800645UL,
            2195279052UL, 795161803UL, 192387189UL, 2285460999UL, 2745749048UL,
            807963965UL, 2753783014UL, 3443412457UL, 3490235096UL, 1202465389UL,
            2800816185UL, 406476043UL, 1020297445UL, 1155477179UL, 4239391302UL,
            2290815708UL, 2561340210UL, 991675583UL, 1508160543UL, 1906089075UL,
            3213809340UL, 1312344665UL, 3134931190UL, 2427460204UL, 2041804703UL,
            3408634192UL, 1382527753UL, 655829252UL, 1607067692UL, 2713019885UL,
            1307034063UL, 2942767626UL, 540718205UL, 1561365211UL, 501356442UL,
            1510452541UL, 531173530UL, 1591084959UL, 795050199UL, 918321004UL,
            176543436UL, 4208152428UL, 2703216984UL, 230688290UL, 4019030869UL,
            189128558UL, 3666161495UL, 3958669267UL, 1793552711UL, 125552926UL,
            4155076548UL, 1490306854UL, 86169869UL, 1564832029UL, 935882445UL,
            37210472UL, 427275019UL, 469881231UL, 2103398350UL, 4204007358UL,
            4000289779UL, 2923204960UL, 4043078444UL, 4129674460UL, 49243774UL,
            1938131721UL, 4206134417UL, 2778297523UL, 2857676174UL, 37296112UL,
            2088239791UL, 2166403106UL, 1938276374UL, 1475341273UL, 862564429UL,
            3255203960UL, 1967896745UL, 2545832656UL, 2979523318UL, 3610050425UL,
            767035415UL, 1327523898UL, 2022190002UL, 3179043466UL, 3110928107UL,
            2338496096UL, 4283969760UL, 1061909760UL, 322019445UL, 135273442UL,
            2959217521UL, 1315960104UL, 1639178740UL, 2756612290UL, 2104652497UL,
            3885410407UL, 4023439893UL, 1113806181UL, 11382155UL, 458011692UL,
            703101214UL, 3397459757UL, 3587110228UL, 273338662UL, 1673301111UL,
            3006192856UL, 4185468705UL, 3137448320UL, 45849235UL, 332893254UL,
            3194157089UL, 3204376528UL, 2190401378UL, 1243172348UL, 1180770595UL,
            2432194152UL, 1783521576UL, 810218424UL, 3627892517UL, 3697908600UL,
            2729604707UL, 3927624983UL, 3903532346UL, 2092551625UL, 3409410731UL,
            2135416574UL, 2925979208UL, 731498136UL, 3109350015UL, 650630834UL,
            3083952574UL, 3135660781UL, 2864507464UL, 3704455540UL, 1800573902UL,
            1687866877UL, 3292900098UL, 4209159238UL, 3351812237UL, 3453579735UL,
            1481879059UL, 2205838361UL, 1608707541UL, 1834837513UL, 4206470239UL,
            2067010173UL, 3073510907UL, 1922535409UL, 4235011532UL, 2199757642UL,
            327043460UL, 3568522048UL, 2843411793UL, 564800142UL, 68291853UL,
            3816705014UL, 2258860409UL, 2243088010UL, 1005898736UL, 1678260523UL,
            444222931UL, 1199639077UL, 372434870UL, 3294188213UL, 4143085621UL,
            843545956UL, 1961841973UL, 871172696UL, 1549619903UL, 4193632716UL,
            1751339728UL, 589540311UL, 3062688828UL, 4021341784UL, 703542823UL,
            3390404721UL, 4173725660UL, 1579115118UL, 1400148954UL, 2041754358UL,
            876417435UL, 1656812251UL, 3707630105UL, 358882434UL, 3841891239UL,
            3886041967UL, 3352511691UL, 422126669UL, 2466537516UL, 3226753193UL,
            3331910987UL, 2036829186UL, 3789660309UL, 1903283537UL, 2034334707UL,
            3670069499UL, 2463217423UL, 807065739UL, 2439359477UL, 4004848462UL,
            2695120715UL, 567286061UL, 936747181UL, 897911970UL, 3615047124UL,
            2796988884UL, 1689074748UL, 1703794217UL, 2821560010UL, 857851665UL,
            1361674222UL, 1384490131UL, 3939439760UL, 4225546296UL, 2033264336UL,
            433975988UL, 3845656156UL, 4111922917UL, 1357573158UL, 1614687728UL,
            2843213835UL, 3575275611UL, 3362179122UL, 1112347046UL, 1180336017UL,
            832403544UL, 1302398810UL, 455452209UL, 628732282UL, 37746044UL,
            1757485242UL, 2154756305UL, 499899750UL, 2176287529UL, 4212141432UL,
            3884227627UL, 1782930706UL, 3764276414UL, 3155064847UL, 3783247148UL,
            3174593726UL, 3882799367UL, 743090268UL, 1880963736UL, 518464494UL,
            3441134465UL, 3647473030UL, 3147702513UL, 2874968320UL, 2602834853UL,
            599250753UL, 2694528767UL, 1563079986UL, 1153602875UL, 2896271151UL,
            1629516966UL, 338769464UL, 4071345826UL, 3929853227UL, 3124182309UL,
            3935432923UL, 1445855763UL, 1851276671UL, 380493357UL, 2882770591UL,
            3234662207UL, 943745622UL, 2237166382UL, 3129887773UL, 1194476811UL,
            3799595291UL, 3607805246UL, 3987975950UL, 1837497918UL, 3767393146UL,
            2114206276UL, 2525318134UL, 1016108738UL, 4195408936UL, 3383165680UL,
            1411205812UL, 3180021457UL, 71598750UL, 3628282147UL, 2814453479UL,
            3070194918UL, 2298265610UL, 825626340UL, 3871268917UL, 2084869207UL,
            1995092281UL, 1033429518UL, 3615507839UL, 1435365499UL, 3405901166UL,
            3439094326UL, 953639323UL, 276803987UL, 2963589716UL, 4226595133UL,
            3970920610UL, 3304942403UL, 385308441UL, 2409692522UL, 3966332427UL,
            4087469839UL, 2159955184UL, 815971564UL, 4255367186UL, 548898284UL,
            93452891UL, 1250886131UL, 384382936UL, 1143714993UL, 139569776UL,
            3973698056UL, 680765308UL, 1325428735UL, 1336942371UL, 2484377610UL,
            217062017UL, 104075592UL, 2501187488UL, 2751022204UL, 1176960847UL,
        };

        /// <summary>
        /// Taken from http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/index.html,
        /// SFMT-src-1.3.3.zip, SFMT.1279.out.txt.
        /// </summary>
        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_NextUInt_ReferenceImplementationTest()
        {
            const int ulongLength = 100;
            var gen = new MersenneTwisterSfmt1279UniformRandom(1234);
            for (int i = 0; i < ulongLength; ++i)
            {
                ulong expected = ExpectedULong[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(
                    expected,
                    actual,
                    Invariant($"Reference implementation uint: index={i}, actual={actual} expected={expected}"));
            }

            const int ulongArrayLength = 100;
            gen = new MersenneTwisterSfmt1279UniformRandom(new[] { 0x1234, 0x5678, 0x9abc, 0xdef0 });
            for (int i = 0; i < ulongArrayLength; ++i)
            {
                ulong expected = ExpectedULongArray[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(
                    expected,
                    actual,
                    Invariant($"Reference implementation array: index={i}, actual={actual} expected={expected}"));
            }
        }

#pragma warning disable S2699 // Tests should include assertions
        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_NextDouble_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt1279UniformRandom(Seed);
            double expected = 0.5;

            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble();
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 4;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(8);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 6;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(4, 8);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_NextInt_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt1279UniformRandom(Seed);

            double expected = int.MaxValue / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt();
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 400d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(800);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 600d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(400, 800);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_NextBoolean_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt1279UniformRandom(Seed);

            const double expected = Count / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextBoolean() ? 1 : 0;
            }

            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_NextBytes_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt1279UniformRandom(Seed);

            const double expected = 128;
            double actual = 0;
            var array = new byte[32];

            for (int i = 0; i < Count; ++i)
            {
                gen.NextBytes(array);
                actual = array.Aggregate(actual, (current, b) => current + b);
            }

            actual /= Count * 32;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }
#pragma warning restore S2699 // Tests should include assertions

        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_Seed_SameSeed_SameValue()
        {
            var gen1 = new MersenneTwisterSfmt1279UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt1279UniformRandom(Seed);
            int actual = gen2.NextInt();

            Assert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_Seed_DifferentSeed_DifferentValue()
        {
            var gen1 = new MersenneTwisterSfmt1279UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt1279UniformRandom(Seed + 1);
            int actual = gen2.NextInt();

            Assert.AreNotEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_CanReset_ReturnsTrue()
        {
            var gen = new MersenneTwisterSfmt1279UniformRandom();

            Assert.IsTrue(gen.CanReset);
        }

        [TestMethod]
        public void MersenneTwisterSfmt1279UniformRandom_Reset_ValueGeneratedThenReset_SameValueGenerated()
        {
            var gen = new MersenneTwisterSfmt1279UniformRandom();
            int expected = gen.NextInt();

            gen.Reset();
            int actual = gen.NextInt();

            Assert.AreEqual(expected, actual);
        }
    }
}
