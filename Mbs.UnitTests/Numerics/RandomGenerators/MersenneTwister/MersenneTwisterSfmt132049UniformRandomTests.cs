using System.Linq;
using Mbs.Numerics.RandomGenerators.MersenneTwister;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators.MersenneTwister
{
    [TestClass]
    public class MersenneTwisterSfmt132049UniformRandomTests
    {
        private const int Seed = 12345;
        private const int Count = 5000;

        private static readonly ulong[] ExpectedULong =
        {
            3596981943UL, 2237974425UL, 3827224957UL, 2514757895UL, 4264843680UL,
            955444628UL, 1982846266UL, 3690734264UL, 2164407755UL, 2213046834UL,
            1724693857UL, 51549213UL, 1214613897UL, 969393410UL, 3593568815UL,
            3968248172UL, 732457991UL, 4110147364UL, 2568450099UL, 111613531UL,
            3105149926UL, 3474245237UL, 3165871412UL, 1276608804UL, 3923836977UL,
            3648769445UL, 756375000UL, 3003259904UL, 3475051552UL, 3064994508UL,
            1738060392UL, 1253564194UL, 436357404UL, 3649391826UL, 1996013715UL,
            2729021393UL, 1105099033UL, 2700993921UL, 3881807966UL, 425297842UL,
            1592718677UL, 4126015169UL, 1549952430UL, 2349787697UL, 1330918304UL,
            1960542741UL, 1829781490UL, 1038664333UL, 72335516UL, 2849036317UL,
            4239651416UL, 3757976166UL, 2710983360UL, 1836779447UL, 225611933UL,
            1150272070UL, 383410953UL, 573608158UL, 4150781548UL, 2996902092UL,
            1668903135UL, 2175460510UL, 1849279162UL, 2651516368UL, 1226061898UL,
            66315168UL, 2070604771UL, 1355818237UL, 1690742738UL, 1418279627UL,
            2837571220UL, 1476333506UL, 4119296714UL, 2048810260UL, 688849086UL,
            884638991UL, 2934460379UL, 2745162937UL, 2978180569UL, 1245057028UL,
            3528732731UL, 4269655358UL, 1410758948UL, 3736297053UL, 4149525876UL,
            1085129630UL, 2866936446UL, 1197521330UL, 183636034UL, 4073672281UL,
            3923982691UL, 1721803585UL, 1338991898UL, 1099884030UL, 1021635446UL,
            87861473UL, 682843422UL, 1823499747UL, 3288898238UL, 411402303UL,
            368490130UL, 3188812156UL, 3653429766UL, 2385745693UL, 3549231135UL,
            3368581558UL, 3864601184UL, 3978664090UL, 3982716534UL, 1327565192UL,
            2951648556UL, 3356677722UL, 907632251UL, 3580055389UL, 1334532452UL,
            2056992759UL, 4231857110UL, 2866293807UL, 995730443UL, 2989100008UL,
            3583438471UL, 1311824294UL, 2671436018UL, 1321004258UL, 1676279594UL,
            3346182547UL, 541489131UL, 1062854575UL, 2273193455UL, 2747698018UL,
            4132914690UL, 2971452922UL, 3941092693UL, 465746819UL, 2401367012UL,
            2479715524UL, 1227990368UL, 2640989295UL, 3635799419UL, 3470191677UL,
            656554409UL, 77929599UL, 40418870UL, 2756511563UL, 2914079952UL,
            3642742820UL, 515397513UL, 655553702UL, 368778688UL, 622420129UL,
            3430206075UL, 548974717UL, 2283271161UL, 2082141756UL, 2439808307UL,
            202606866UL, 872215885UL, 2126456289UL, 664419479UL, 1884423671UL,
            3535878778UL, 3291604629UL, 2796791055UL, 3561482711UL, 2668745478UL,
            1375072683UL, 2239759058UL, 3356833603UL, 4021999149UL, 619592160UL,
            3347553786UL, 1799163097UL, 3768479657UL, 1411538988UL, 2547115851UL,
            2863466709UL, 3213453506UL, 3059683356UL, 233936246UL, 3333147627UL,
            3002853784UL, 2529523173UL, 1413026604UL, 2542986459UL, 676868102UL,
            3477125093UL, 2413055410UL, 2836507837UL, 1934213462UL, 2814385131UL,
            2626884822UL, 1239385996UL, 3042033482UL, 394389031UL, 72394655UL,
            3278269661UL, 1630199668UL, 3095660650UL, 1241033283UL, 757879729UL,
            1198616375UL, 2590978994UL, 242650561UL, 3584193061UL, 2464253813UL,
            42594549UL, 3590420911UL, 3111935720UL, 1948656221UL, 12935088UL,
            1613688999UL, 2991814519UL, 4181911577UL, 4185544583UL, 3728641416UL,
            1420291324UL, 225205859UL, 3567721363UL, 2763374406UL, 3297295590UL,
            1899167906UL, 2442945884UL, 1335662514UL, 1702341858UL, 1036007787UL,
            597426219UL, 3694737040UL, 3987270664UL, 3648954790UL, 2880113458UL,
            4231525974UL, 1877346360UL, 2503838250UL, 2215252556UL, 96036493UL,
            3223957295UL, 203270257UL, 3874078665UL, 3568946094UL, 3524422428UL,
            3912826507UL, 2644701201UL, 2737333238UL, 877540372UL, 539548352UL,
            4033456040UL, 3567327998UL, 1887278679UL, 3427267750UL, 48925252UL,
            1356805154UL, 595520865UL, 1365463464UL, 1338901950UL, 1338132626UL,
            921401508UL, 3516018798UL, 446337719UL, 3945035575UL, 2192105790UL,
            2601079891UL, 1480502551UL, 2286467731UL, 4137354297UL, 47574006UL,
            3087314936UL, 2593836560UL, 1642271576UL, 4037740408UL, 2311176811UL,
            1067887340UL, 2874884461UL, 1480881537UL, 3708657520UL, 1029792219UL,
            3490400354UL, 1161439732UL, 960167991UL, 3191133749UL, 3475804323UL,
            3325301995UL, 921901583UL, 2817485814UL, 3137010011UL, 3225403267UL,
            1064702312UL, 1767586695UL, 3014227298UL, 1815325195UL, 296883582UL,
            2469255712UL, 1647763936UL, 3203013250UL, 202221999UL, 7340783UL,
            2757397306UL, 2964494766UL, 1240586628UL, 231252971UL, 3468112743UL,
            1379102400UL, 4220711172UL, 1253296255UL, 2334826128UL, 3031835285UL,
            292692732UL, 3777326535UL, 1181773061UL, 2271863745UL, 3264592041UL,
            2688352603UL, 816068657UL, 2872022366UL, 2496333587UL, 1510717377UL,
            3381807432UL, 604896569UL, 1427790496UL, 1171621012UL, 1782862678UL,
            2072521045UL, 777278711UL, 163738242UL, 3132254448UL, 1704338245UL,
            640640356UL, 430104554UL, 2933625966UL, 3417160927UL, 1812650368UL,
            466082662UL, 2030456379UL, 3576258230UL, 2602990590UL, 974314027UL,
            1229200334UL, 2310617894UL, 1977390544UL, 1677754533UL, 2980478301UL,
            281231326UL, 2720188033UL, 1418955264UL, 3541143683UL, 672241267UL,
            1216456253UL, 2926529041UL, 1508194657UL, 3791465710UL, 831084160UL,
            1324376556UL, 2103915996UL, 1529435286UL, 1392681812UL, 245839596UL,
            2236947796UL, 2449864744UL, 4227126463UL, 2443296373UL, 1928694908UL,
            2309780793UL, 731541158UL, 4008254998UL, 3056959999UL, 3569804825UL,
            3753267065UL, 994712357UL, 3311108911UL, 2027718623UL, 3929416500UL,
            3132505247UL, 2254156903UL, 1702881484UL, 2826971685UL, 3639339457UL,
            258309259UL, 3775361807UL, 4028714932UL, 221832121UL, 1973675381UL,
            3908968396UL, 858864782UL, 3470170545UL, 379916681UL, 3023304471UL,
            523784994UL, 1459290827UL, 2514158457UL, 3636378662UL, 105653155UL,
            3741445110UL, 3315054517UL, 3066796920UL, 2823450283UL, 678536042UL,
            1499986538UL, 3023208525UL, 435654971UL, 2338402164UL, 374827884UL,
            4170052378UL, 2720479142UL, 3134488447UL, 1559216736UL, 2303137214UL,
            792569007UL, 157761061UL, 3911438044UL, 1308851189UL, 364156956UL,
            2513897514UL, 756369395UL, 4209586764UL, 2904619424UL, 3499628289UL,
            1947089574UL, 1225949048UL, 4042979474UL, 2136029142UL, 538568781UL,
            3738798227UL, 1370098107UL, 2422587638UL, 748764893UL, 482262428UL,
            1857858579UL, 4001835457UL, 3126783615UL, 2589570466UL, 3261767681UL,
            1233238937UL, 3244437540UL, 3577387468UL, 2034106038UL, 1423637948UL,
            2061709235UL, 852615350UL, 1008921488UL, 1926193466UL, 361907308UL,
            521823159UL, 2690031901UL, 1886452591UL, 1774690335UL, 194314702UL,
            1917439941UL, 3428685616UL, 2797637656UL, 1546653383UL, 4216328043UL,
            1949478045UL, 2269433340UL, 3694786025UL, 1095721865UL, 1685395366UL,
            2084489821UL, 225239055UL, 3548564642UL, 3849496331UL, 2000945273UL,
            558080775UL, 2283559968UL, 352730277UL, 1939821952UL, 1915065063UL,
            4085297933UL, 3385419066UL, 2540125692UL, 896385546UL, 3567877865UL,
            3518859086UL, 3446451850UL, 1211823478UL, 1873117300UL, 1549845153UL,
            525119003UL, 3258172068UL, 708815606UL, 3757283525UL, 4064932867UL,
            1426172793UL, 689515439UL, 1809412033UL, 1659838755UL, 4267801883UL,
            400460039UL, 2271427419UL, 442603861UL, 3876175457UL, 1462622318UL,
            2298959818UL, 300834577UL, 3666674175UL, 3124157033UL, 3187134749UL,
            2965544670UL, 2960600722UL, 4036872341UL, 514309948UL, 3360934870UL,
            2366660138UL, 4029303357UL, 2696403247UL, 4117738585UL, 3049775390UL,
            750028946UL, 3247391263UL, 203403882UL, 1554467765UL, 1392944546UL,
            2912943399UL, 3129398124UL, 3689036488UL, 4209775443UL, 2349683340UL,
            369855345UL, 2862726684UL, 659600535UL, 2643425471UL, 2599539189UL,
            2755088134UL, 1653993770UL, 2064619040UL, 1274496365UL, 2939796848UL,
            776605265UL, 132444440UL, 3781126036UL, 2863560009UL, 1029049182UL,
            3699737699UL, 2804677595UL, 1192682450UL, 3306730609UL, 1411148003UL,
            208104798UL, 790096842UL, 4213955087UL, 2342337236UL, 1874567765UL,
            3117967902UL, 2625310557UL, 135306173UL, 2203248572UL, 2792428552UL,
            2205309875UL, 3447603326UL, 3103786664UL, 1588145824UL, 3397235731UL,
            1444834839UL, 3383544234UL, 589553870UL, 1552989460UL, 2915511962UL,
            3686430656UL, 1497522173UL, 982495529UL, 3238736015UL, 2037038295UL,
            1599797554UL, 999412284UL, 3718027736UL, 2039474093UL, 2707076851UL,
            437735458UL, 1179826575UL, 2931974670UL, 3296432284UL, 4049380981UL,
            862871591UL, 1481132327UL, 2617214193UL, 3529853656UL, 2852063956UL,
            472141892UL, 3176415157UL, 3706925180UL, 134189271UL, 3226277113UL,
            242816983UL, 1446664352UL, 2731021136UL, 2304470291UL, 1070863121UL,
            2704122701UL, 2511214545UL, 2871362577UL, 2756286153UL, 3017472007UL,
            1671718640UL, 1123200125UL, 2359650362UL, 3565057248UL, 1602888372UL,
            3265910419UL, 555742190UL, 3533225685UL, 583285879UL, 1808095945UL,
            1404316110UL, 592485494UL, 2379960491UL, 581812260UL, 2808099393UL,
            3400450529UL, 1962251239UL, 3611744816UL, 1565278679UL, 2247526968UL,
            457626946UL, 3139970886UL, 2557946357UL, 2754841577UL, 820080603UL,
            3795130029UL, 3251884378UL, 3086240879UL, 733629764UL, 173389991UL,
            3424926502UL, 2522684257UL, 3982835519UL, 3679342119UL, 4177876178UL,
            1049245388UL, 4280805584UL, 953593421UL, 1018733819UL, 4057770285UL,
            803014483UL, 538118316UL, 2434551286UL, 3793663125UL, 1546812114UL,
            626044721UL, 644837012UL, 2753738161UL, 2402665671UL, 2116354855UL,
            2365403435UL, 1454048698UL, 2102439803UL, 166641279UL, 3322223972UL,
            3047018824UL, 2850683126UL, 2906645059UL, 4013030064UL, 3460675487UL,
            422562360UL, 375716256UL, 2323026950UL, 4108460433UL, 2978542904UL,
            1151243471UL, 224070764UL, 414566845UL, 952295191UL, 810707601UL,
            3644014663UL, 1249755007UL, 1192859869UL, 3999134458UL, 1982409854UL,
            2974817459UL, 350465705UL, 3498006353UL, 198095717UL, 69293742UL,
            299943682UL, 4025811780UL, 472456958UL, 3583659431UL, 1488806230UL,
            3181083520UL, 750045949UL, 906043237UL, 459399171UL, 1922743538UL,
            975331893UL, 1040998784UL, 3012265617UL, 3459419106UL, 1549880515UL,
            910770728UL, 3652632848UL, 880256989UL, 3322878474UL, 311653989UL,
            4010525427UL, 3566943905UL, 198832364UL, 1438757723UL, 156768123UL,
            2988393466UL, 3259637073UL, 1200902488UL, 2560107708UL, 422673694UL,
            2096464996UL, 880325493UL, 4024701458UL, 2758725745UL, 3070655240UL,
            3982020107UL, 1018389621UL, 3922972974UL, 675352676UL, 3778533402UL,
            281907424UL, 3777824509UL, 2615632495UL, 206866231UL, 3107264806UL,
            3522180948UL, 1330259165UL, 1622137676UL, 588619625UL, 4174397914UL,
            3076549830UL, 433962088UL, 669574955UL, 2555762523UL, 2862620110UL,
            4036465440UL, 2415470654UL, 931021106UL, 2500898565UL, 260791410UL,
            745838156UL, 3488691553UL, 947662696UL, 1148485941UL, 2187286704UL,
            192589811UL, 4156853093UL, 3525848064UL, 1760601304UL, 2144099214UL,
            3640143802UL, 2612310115UL, 4130095330UL, 3605278448UL, 4026869596UL,
            2433675208UL, 3834179377UL, 1829276289UL, 3839551861UL, 2696426261UL,
            1781380787UL, 3012219094UL, 267735757UL, 2545246858UL, 3855597907UL,
            620899479UL, 3201795735UL, 3107447875UL, 2570768407UL, 1088080434UL,
            1453379852UL, 1548107375UL, 3227824787UL, 1736573618UL, 3721606436UL,
            1047222703UL, 4114902166UL, 3834030533UL, 408100289UL, 3056964657UL,
            3385977577UL, 30998284UL, 3976397632UL, 2548976696UL, 452080319UL,
            2888564319UL, 2850181359UL, 840834036UL, 3189155937UL, 161383788UL,
            694930373UL, 3497895292UL, 990658409UL, 897173479UL, 472503390UL,
            3390181073UL, 961986486UL, 1355957198UL, 24259608UL, 3766216877UL,
            2357755614UL, 601935378UL, 3415698563UL, 556943111UL, 1054792386UL,
            3103351029UL, 1545747134UL, 3107075833UL, 260809687UL, 3562391401UL,
            3577105582UL, 587295250UL, 4109449507UL, 2622446839UL, 1935606941UL,
            4009219859UL, 707080677UL, 3913617647UL, 234902868UL, 240040205UL,
            2374262395UL, 2698862655UL, 1839704716UL, 3476793520UL, 366994649UL,
            3373122499UL, 2255356922UL, 1165297490UL, 3512850035UL, 3546159620UL,
            4195524883UL, 346302994UL, 973277886UL, 937885000UL, 3576161493UL,
            2770283805UL, 3868133088UL, 271374381UL, 1470389097UL, 2006257056UL,
            72784016UL, 3170795990UL, 3930246033UL, 1652212775UL, 4239989830UL,
            4111773101UL, 2089579069UL, 3817441549UL, 1589993435UL, 1045718725UL,
            2001013737UL, 3191875137UL, 3855875924UL, 2455120289UL, 572081483UL,
            1498418430UL, 3322619687UL, 1937436461UL, 608713266UL, 1962507634UL,
            2171451278UL, 1949301782UL, 3142449474UL, 2993042539UL, 774530651UL,
            1682681414UL, 2376751223UL, 3279033613UL, 1332247495UL, 3499451681UL,
            3647303548UL, 3453211132UL, 1487634047UL, 595846195UL, 4152311139UL,
            1713229882UL, 2294403032UL, 306472745UL, 891565517UL, 2559403879UL,
            3280205409UL, 1097513733UL, 3724162071UL, 3477630411UL, 3591073UL,
            484795276UL, 2167988262UL, 961762095UL, 586215444UL, 2657329839UL,
            863404635UL, 2752242435UL, 2412459225UL, 2683814355UL, 2933805436UL,
            2311804737UL, 3946116674UL, 1945950690UL, 993586892UL, 1041532545UL,
            978366681UL, 2007492329UL, 3365566378UL, 3516015155UL, 1278750930UL,
            3991570529UL, 2923703265UL, 2815019354UL, 701666269UL, 1133630587UL,
            2823504713UL, 3708084633UL, 1474723269UL, 1289307123UL, 1094937151UL,
            3381390263UL, 2482925857UL, 770056445UL, 3117475888UL, 2786574052UL,
            197275752UL, 377154752UL, 214879913UL, 1655258457UL, 3232903936UL,
            3607195773UL, 598193669UL, 3708023572UL, 1439541110UL, 165308267UL,
            3941145668UL, 3693461705UL, 3670756579UL, 1227069791UL, 3235491069UL,
            2574893321UL, 3426797460UL, 729132663UL, 4110302979UL, 34963318UL,
            4216685254UL, 2171412668UL, 3448499245UL, 365072004UL, 796533379UL,
            176313074UL, 3086288899UL, 2844247317UL, 4115545504UL, 1495347180UL,
            3178356766UL, 3183225159UL, 3309755220UL, 619067019UL, 1833747403UL,
            3322294742UL, 2451173567UL, 948255123UL, 171805724UL, 513625311UL,
            18456026UL, 66067534UL, 2099558445UL, 858761370UL, 1553758341UL,
            2055662734UL, 3933104848UL, 3193916158UL, 153776374UL, 1814200953UL,
            2812251626UL, 1668190584UL, 4011596877UL, 3512894862UL, 3164459043UL,
            3460803480UL, 1610544570UL, 3753054296UL, 1466346786UL, 935704378UL,
            2584661687UL, 3170251531UL, 4164624099UL, 1331156347UL, 897055915UL,
            2310366533UL, 148631954UL, 1479102803UL, 1855921057UL, 2813662772UL,
            4149555081UL, 488862552UL, 2964424007UL, 2030915637UL, 314343358UL,
            3033119286UL, 3704652088UL, 4021974009UL, 217550856UL, 958019327UL,
            1551023420UL, 1462317554UL, 2882528449UL, 1136299843UL, 292840589UL,
            1307775247UL, 463274356UL, 1430357686UL, 3907607055UL, 3462509184UL,
        };

        private static readonly ulong[] ExpectedULongArray =
        {
            1504823642UL, 3697343753UL, 1088344911UL, 2677745529UL, 4178419641UL,
            2335930461UL, 2464577205UL, 3770915900UL, 2265865885UL, 2476652314UL,
            2677559955UL, 2209458101UL, 1639287655UL, 4039697819UL, 385554367UL,
            2526303904UL, 4918276UL, 3792782130UL, 285428580UL, 4252468569UL,
            2144436279UL, 3785554037UL, 2266411022UL, 2058186717UL, 547094468UL,
            1454738165UL, 2340106398UL, 2038376372UL, 55836418UL, 1989447828UL,
            3823388202UL, 125747492UL, 4232022563UL, 2289045230UL, 2261087398UL,
            3292143644UL, 2311017099UL, 1437161539UL, 2605033548UL, 3883081306UL,
            997158455UL, 4070713862UL, 3809085626UL, 3564292033UL, 354908784UL,
            129529025UL, 2824802627UL, 1768937606UL, 2131874259UL, 2953473730UL,
            1100367885UL, 2714772736UL, 1073909325UL, 1937096878UL, 2858160130UL,
            299309426UL, 228617984UL, 2190914383UL, 3796317940UL, 3675215920UL,
            2181135989UL, 3453613942UL, 50260672UL, 3128360651UL, 3244704602UL,
            3719004822UL, 3807143782UL, 3171453853UL, 553752516UL, 1735142514UL,
            2191352790UL, 170986927UL, 1887873224UL, 2311431521UL, 3614710820UL,
            1529906389UL, 4235512847UL, 2164724045UL, 1908174245UL, 2880109472UL,
            3774629254UL, 3940338644UL, 3853358376UL, 740438798UL, 3889743664UL,
            937931881UL, 3429583820UL, 719840419UL, 1891015604UL, 3025887660UL,
            253160420UL, 4064208163UL, 1460329684UL, 492039356UL, 470119357UL,
            3628044256UL, 3845260317UL, 4171250309UL, 3035989923UL, 1214818910UL,
            409601842UL, 783041295UL, 571970176UL, 2391302280UL, 251718209UL,
            3605100853UL, 4145687110UL, 3118932284UL, 1184597021UL, 1690781718UL,
            1045712798UL, 3687747792UL, 1218523280UL, 1424500138UL, 905986969UL,
            2393037678UL, 2137324083UL, 889239294UL, 37782557UL, 374820182UL,
            3200960594UL, 154787173UL, 2654164060UL, 2537384202UL, 1995084624UL,
            2317997519UL, 2849440762UL, 2481035997UL, 1707620337UL, 1811857443UL,
            1252786121UL, 3506540561UL, 1221870091UL, 1720232030UL, 1677841566UL,
            3476720583UL, 3875827631UL, 682597497UL, 1282271558UL, 2077744468UL,
            1517311188UL, 1563678646UL, 2519801213UL, 3816941087UL, 1554009597UL,
            577494706UL, 2698912202UL, 1803724443UL, 4082610833UL, 4220921877UL,
            476523290UL, 76927725UL, 4142674028UL, 407317609UL, 490061457UL,
            472041379UL, 3911090063UL, 3402443619UL, 388396388UL, 155514965UL,
            3181901029UL, 2345309876UL, 3822551527UL, 3809891390UL, 2193737667UL,
            3052877604UL, 525702683UL, 529631267UL, 1247629125UL, 892180429UL,
            3220142265UL, 1253176782UL, 2866161392UL, 1059783614UL, 301010699UL,
            1772909102UL, 3706491140UL, 3514828089UL, 1497610713UL, 3100476370UL,
            2299372318UL, 3154567693UL, 2418860769UL, 2844930095UL, 2812047320UL,
            1607571556UL, 2618800785UL, 1539725053UL, 1512057765UL, 2367071342UL,
            2203694567UL, 3802537758UL, 3975833276UL, 2215836812UL, 1312034980UL,
            1776670989UL, 3670461458UL, 3816599394UL, 857101740UL, 1368159835UL,
            359356197UL, 2384931188UL, 2679785686UL, 3280784476UL, 1709094834UL,
            3635380960UL, 552508229UL, 4089386065UL, 202223263UL, 1879404635UL,
            2493999821UL, 4206989573UL, 2410910920UL, 846019398UL, 2074194195UL,
            2103398902UL, 3888057187UL, 3262740460UL, 3116665993UL, 2695435704UL,
            3728403066UL, 1165603729UL, 3635786622UL, 4144604519UL, 1767388271UL,
            965187869UL, 1118835097UL, 3206733419UL, 1900011195UL, 2962416289UL,
            2311966279UL, 2322480180UL, 417109808UL, 2858289361UL, 2663503599UL,
            1632284455UL, 1000075825UL, 2128751794UL, 911507188UL, 1456467526UL,
            2807706163UL, 2993501434UL, 2319394912UL, 1143130800UL, 1973099514UL,
            3483904338UL, 316900300UL, 1987384228UL, 1546517951UL, 3192077743UL,
            2566646875UL, 1428159491UL, 3184061884UL, 1283688021UL, 1492728645UL,
            3224783871UL, 2428238458UL, 3010912394UL, 1401827545UL, 697218535UL,
            2533812454UL, 610703656UL, 3218608588UL, 3092710655UL, 1445772144UL,
            2757473296UL, 2985995201UL, 1081910190UL, 275974516UL, 1381912460UL,
            1372814474UL, 2069022831UL, 3636606766UL, 1815426463UL, 3951856623UL,
            1566066362UL, 3987110997UL, 4068857976UL, 3354620949UL, 2660956490UL,
            4258902438UL, 4059439742UL, 1752834190UL, 996248157UL, 183545291UL,
            3458130922UL, 3093057793UL, 2146928586UL, 2402790000UL, 3478036579UL,
            2389885491UL, 3405261264UL, 1781015785UL, 1946936494UL, 3708440904UL,
            142531484UL, 1300778833UL, 558341534UL, 1507387174UL, 3986471975UL,
            2213061052UL, 2627907287UL, 1794662028UL, 273314240UL, 3328417854UL,
            673532489UL, 2384019269UL, 2863210090UL, 157959556UL, 3590624830UL,
            3612692667UL, 2363300974UL, 653702850UL, 4145397757UL, 188597541UL,
            719483328UL, 2521277449UL, 1323742712UL, 358892849UL, 2119476125UL,
            3706507485UL, 1034186762UL, 3342685983UL, 1756387491UL, 2822407974UL,
            1458531928UL, 656508826UL, 17790887UL, 2447821880UL, 677936687UL,
            195170907UL, 3346462465UL, 1647747390UL, 3020995237UL, 1297698426UL,
            195133223UL, 1974966062UL, 696984497UL, 4074098495UL, 1265308645UL,
            2722823797UL, 2129992900UL, 1908284320UL, 4130550818UL, 1033514278UL,
            1632835897UL, 798048699UL, 2605123121UL, 438593333UL, 4103593348UL,
            879331712UL, 672839727UL, 2193447972UL, 622748535UL, 1105570645UL,
            3695667189UL, 1598808733UL, 1328992586UL, 199574628UL, 3420941431UL,
            240300742UL, 1336826305UL, 1596477504UL, 680894512UL, 4020067747UL,
            323390146UL, 4259439206UL, 3115284401UL, 2444934573UL, 136462519UL,
            4089219632UL, 755939940UL, 2225353410UL, 23194633UL, 3370730865UL,
            4166490331UL, 2524703987UL, 2331896422UL, 1589623398UL, 1211010848UL,
            1483955030UL, 3394455333UL, 2741690534UL, 4292286596UL, 2947460459UL,
            51386331UL, 989773061UL, 1318780995UL, 1123904522UL, 1558252134UL,
            1065326724UL, 822503126UL, 1466951088UL, 1526974532UL, 3540043223UL,
            1318822540UL, 1039524283UL, 3240319029UL, 391539703UL, 384280075UL,
            3389239666UL, 1442719223UL, 1586262945UL, 971667103UL, 2131381125UL,
            1492677157UL, 2904636134UL, 335926499UL, 3332012715UL, 2753274008UL,
            3187928328UL, 4045571966UL, 2971064389UL, 1653786047UL, 506189007UL,
            799487158UL, 2286797167UL, 569124091UL, 709476018UL, 3788257702UL,
            2623988869UL, 163848428UL, 4103377501UL, 3450849679UL, 565787163UL,
            3066727848UL, 2496636796UL, 1222044361UL, 2527520640UL, 1755543703UL,
            516761694UL, 3700936629UL, 2320678855UL, 3924229589UL, 2334931249UL,
            1968291628UL, 2894474806UL, 3387426999UL, 1593945513UL, 2696512820UL,
            309367006UL, 4267699207UL, 1993834906UL, 3864781418UL, 1013839895UL,
            2854080355UL, 4259902532UL, 2079014687UL, 3468223898UL, 3264921182UL,
            3575673300UL, 2427491241UL, 960024776UL, 440410563UL, 2150957516UL,
            1034018167UL, 94619570UL, 1050359850UL, 4035032016UL, 55503368UL,
            1928914979UL, 2061551559UL, 4285374078UL, 870525770UL, 1380063248UL,
            2311380000UL, 3682385549UL, 1020198060UL, 931593371UL, 350251193UL,
            1420817882UL, 707300188UL, 2473284091UL, 1317565613UL, 1825945512UL,
            3085797526UL, 1304843922UL, 4119069858UL, 2238014463UL, 591597247UL,
            1534382532UL, 557743048UL, 3538092771UL, 1747777922UL, 3950320060UL,
            588019301UL, 3682351793UL, 1849201125UL, 3939442651UL, 1810068905UL,
            1974471087UL, 1017942569UL, 1391808952UL, 3375542036UL, 525471641UL,
            4265981350UL, 3368529770UL, 2218406246UL, 1721104689UL, 780547298UL,
            700519920UL, 2908539092UL, 332610474UL, 3791342399UL, 3127490762UL,
            4209180762UL, 138246277UL, 2940208830UL, 3178954626UL, 2863084001UL,
            80919709UL, 4083766762UL, 4006058880UL, 370757477UL, 1302106117UL,
            2175304051UL, 2520217593UL, 1277091160UL, 3868353025UL, 3914561907UL,
            4172748534UL, 3280340237UL, 1160612499UL, 845091472UL, 281422872UL,
            2456708760UL, 203302481UL, 267291944UL, 3018202633UL, 3156676024UL,
            3999075531UL, 568599181UL, 4133478079UL, 650492698UL, 1553848052UL,
            1803358865UL, 1583853991UL, 392925377UL, 1385917333UL, 1531079162UL,
            1621243530UL, 4179079661UL, 924879308UL, 2331292063UL, 2064736075UL,
            3397419545UL, 3514513666UL, 233408721UL, 3106619352UL, 3177075294UL,
            3341561366UL, 2998697828UL, 1202544374UL, 3280135569UL, 2976270078UL,
            2317893005UL, 2163003563UL, 2857001961UL, 1557094237UL, 1934066519UL,
            4126343441UL, 1412413414UL, 2510219152UL, 395036939UL, 4009733786UL,
            3095733415UL, 631434616UL, 4291409307UL, 1996540695UL, 636975770UL,
            2726071110UL, 1952068563UL, 1284582412UL, 397521667UL, 609708866UL,
            3410479461UL, 4221422424UL, 1403340152UL, 1492539196UL, 2074415434UL,
            1486193900UL, 3762754075UL, 3565008134UL, 679156743UL, 2490764021UL,
            1872875284UL, 1519101708UL, 2232019223UL, 2136701562UL, 470446948UL,
            3032538702UL, 1513947634UL, 258866575UL, 2333961061UL, 3990579626UL,
            1184268026UL, 2017638858UL, 597377341UL, 447422726UL, 3155366532UL,
            480631259UL, 2363359225UL, 2086871774UL, 1839630317UL, 2525458883UL,
            1046198994UL, 2196655410UL, 1287092601UL, 3967775472UL, 3618967226UL,
            3674215843UL, 2688366405UL, 2916155674UL, 2107990093UL, 554648011UL,
            2673185774UL, 1987868896UL, 45035849UL, 72200796UL, 2134029992UL,
            3946188301UL, 940219545UL, 4141974258UL, 933621837UL, 526908965UL,
            1580607561UL, 1702453777UL, 3598622403UL, 1840334441UL, 2033876816UL,
            1806919578UL, 2279726582UL, 1898965768UL, 3783983428UL, 1385775481UL,
            1308078392UL, 1911967268UL, 314772294UL, 800696026UL, 2392004353UL,
            3700028338UL, 115633212UL, 794511579UL, 2392308903UL, 1336975229UL,
            1210608207UL, 3877885330UL, 1960838602UL, 4182554031UL, 629301731UL,
            1125781215UL, 2692219712UL, 2271076409UL, 1910120246UL, 3538682960UL,
            506519855UL, 1453934327UL, 3528619703UL, 754353379UL, 3634402568UL,
            1694045733UL, 2545628223UL, 865964895UL, 1272838020UL, 2910437852UL,
            3955776668UL, 489907424UL, 1210655199UL, 1422337842UL, 1822682777UL,
            2459055750UL, 2837937641UL, 4161202388UL, 377661826UL, 1194326885UL,
            1179151218UL, 612708667UL, 726091569UL, 2080675235UL, 1892490969UL,
            1579722002UL, 3702835207UL, 495011872UL, 2600305483UL, 1179726216UL,
            2398105120UL, 2657610962UL, 892898036UL, 2864624736UL, 1740466234UL,
            943563410UL, 1010943429UL, 207426134UL, 3507370528UL, 2178448370UL,
            2055401141UL, 2426251151UL, 3043940452UL, 285057870UL, 334758291UL,
            475447455UL, 3333986901UL, 1861255520UL, 3216034023UL, 1329227765UL,
            519311358UL, 3046998013UL, 244302994UL, 1281482570UL, 3078658564UL,
            1672187628UL, 1134651014UL, 2637124517UL, 3664423965UL, 3768189060UL,
            3695760200UL, 1619315539UL, 853856274UL, 173109871UL, 2149582760UL,
            661545766UL, 2762958188UL, 3692737545UL, 941722328UL, 2224258333UL,
            2424237282UL, 2259244799UL, 3137039242UL, 3032021972UL, 1207059303UL,
            2711228763UL, 724752931UL, 3896639264UL, 981319997UL, 2133118035UL,
            372953086UL, 353535009UL, 2683146203UL, 551929187UL, 1801016364UL,
            2903138442UL, 52410834UL, 378277469UL, 2634784789UL, 91612621UL,
            995413612UL, 1065151880UL, 3489622807UL, 1273956377UL, 959517803UL,
            3812287848UL, 726273919UL, 2291012617UL, 956887914UL, 4069416659UL,
            2140072796UL, 1498668426UL, 1532983825UL, 542350586UL, 3747475908UL,
            3878103053UL, 578526558UL, 3328236392UL, 91124014UL, 2395721588UL,
            797283262UL, 1541622548UL, 57803794UL, 116530494UL, 382537648UL,
            328039847UL, 217058768UL, 2337739572UL, 1479393087UL, 1292994311UL,
            710345183UL, 487692791UL, 2384072039UL, 232926154UL, 3992441683UL,
            1932221233UL, 1565887186UL, 2277735825UL, 1978898833UL, 3228413180UL,
            3899377874UL, 2336470532UL, 3377916268UL, 3601879884UL, 2377980361UL,
            3657807621UL, 483398170UL, 2951266857UL, 3140654482UL, 2142478585UL,
            1789650945UL, 2442763666UL, 2758364279UL, 3838411390UL, 2598172378UL,
            3324728890UL, 1401601301UL, 3780361497UL, 2081546680UL, 3430485212UL,
            1583240275UL, 149790373UL, 3809587426UL, 4277714129UL, 3308328988UL,
            4162272683UL, 3592497739UL, 415171339UL, 1520452575UL, 2830233017UL,
            1840628462UL, 3122597515UL, 1413053603UL, 4289971703UL, 1893780881UL,
            1127965054UL, 816084037UL, 676103495UL, 1859644050UL, 960183182UL,
            433964809UL, 1720446846UL, 2565713388UL, 924556086UL, 1976186791UL,
            2020071263UL, 1471757233UL, 3017780916UL, 4102295889UL, 1374993759UL,
            2319082514UL, 1864048916UL, 4114202845UL, 1400958606UL, 1432434455UL,
            1829724359UL, 1113961222UL, 1776488807UL, 3436204905UL, 3434437745UL,
            2820049781UL, 3992193314UL, 3533802758UL, 2800751878UL, 3978741618UL,
            4293548225UL, 3930170819UL, 814967057UL, 1508748936UL, 438681968UL,
            1574799378UL, 3981761328UL, 2268247670UL, 1965795772UL, 2642668125UL,
            2400741274UL, 2438193671UL, 2006999054UL, 1914896365UL, 1205338157UL,
            3532868328UL, 2955422527UL, 2702043899UL, 440456802UL, 2161120250UL,
            3207281059UL, 951473640UL, 2520172987UL, 1155569935UL, 1015720396UL,
            805975028UL, 15987407UL, 3539497683UL, 1920113336UL, 2232069078UL,
            2761757525UL, 3131092087UL, 1899044092UL, 1123767173UL, 1303946641UL,
            1240371460UL, 1913079416UL, 3846054067UL, 1017468007UL, 1621601623UL,
            987737502UL, 384349098UL, 1600692366UL, 206592074UL, 171203219UL,
            4002813290UL, 75264853UL, 3914480089UL, 3419863751UL, 2161611201UL,
            542214709UL, 268367458UL, 4196206995UL, 3670251121UL, 751850201UL,
            3257597465UL, 2291328286UL, 1206080767UL, 1143613648UL, 4024687848UL,
            2001578164UL, 3595030463UL, 1518435511UL, 124926117UL, 1526520741UL,
            2452364175UL, 2272867560UL, 241789181UL, 2581730044UL, 2714204872UL,
            709486557UL, 4224481218UL, 3448194450UL, 54246111UL, 2803683312UL,
            883563032UL, 609304UL, 2079151430UL, 2419447809UL, 3766476311UL,
            888537354UL, 1518446621UL, 3494864017UL, 696631868UL, 2631585400UL,
            2308573108UL, 485945738UL, 1785842143UL, 1867116547UL, 537147816UL,
            4081269591UL, 4084956194UL, 3747945383UL, 1947941149UL, 1474391999UL,
            986408622UL, 3517675885UL, 4219385159UL, 1870264454UL, 4092472928UL,
            2455722409UL, 235021617UL, 3146681360UL, 468903679UL, 1120378068UL,
            3318561853UL, 700978812UL, 1419064624UL, 2864855302UL, 2085335646UL,
            689282320UL, 3076273602UL, 2149966908UL, 4144560402UL, 2844165262UL,
            4026048014UL, 2769948851UL, 2499866119UL, 1218649161UL, 4219540367UL,
            833468241UL, 4011737498UL, 161486831UL, 4210402215UL, 262313612UL,
            3027351469UL, 3038933136UL, 4197204601UL, 1523849436UL, 4086393974UL,
            4149017591UL, 4144817524UL, 3593877832UL, 261409300UL, 2336463630UL,
            3532332876UL, 1605267500UL, 2517184608UL, 1576640089UL, 3842972706UL,
            3958844110UL, 2906094945UL, 1946153150UL, 3937085798UL, 3685224588UL,
            861659525UL, 2613539352UL, 1120319915UL, 510004744UL, 1626536783UL,
        };

        /// <summary>
        /// Taken from http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/index.html,
        /// SFMT-src-1.3.3.zip, SFMT.132049.out.txt.
        /// </summary>
        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_NextUInt_ReferenceImplementationTest()
        {
            const int ulongLength = 100;
            var gen = new MersenneTwisterSfmt132049UniformRandom(1234);
            for (int i = 0; i < ulongLength; ++i)
            {
                ulong expected = ExpectedULong[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(
                    expected,
                    actual,
                    Invariant($"Reference implementation uint: index={i}, actual={actual} expected={expected}"));
            }

            const int ulongArrayLength = 100;
            gen = new MersenneTwisterSfmt132049UniformRandom(new[] { 0x1234, 0x5678, 0x9abc, 0xdef0 });
            for (int i = 0; i < ulongArrayLength; ++i)
            {
                ulong expected = ExpectedULongArray[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(
                    expected,
                    actual,
                    Invariant($"Reference implementation array: index={i}, actual={actual} expected={expected}"));
            }
        }

#pragma warning disable S2699 // Tests should include assertions
        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_NextDouble_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt132049UniformRandom(Seed);
            double expected = 0.5;

            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble();
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 4;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(8);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 6;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(4, 8);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_NextInt_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt132049UniformRandom(Seed);

            double expected = int.MaxValue / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt();
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 400d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(800);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 600d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(400, 800);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_NextBoolean_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt132049UniformRandom(Seed);

            const double expected = Count / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextBoolean() ? 1 : 0;
            }

            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_NextBytes_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt132049UniformRandom(Seed);

            const double expected = 128;
            double actual = 0;
            var array = new byte[32];

            for (int i = 0; i < Count; ++i)
            {
                gen.NextBytes(array);
                actual = array.Aggregate(actual, (current, b) => current + b);
            }

            actual /= Count * 32;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }
#pragma warning restore S2699 // Tests should include assertions

        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_Seed_SameSeed_SameValue()
        {
            var gen1 = new MersenneTwisterSfmt132049UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt132049UniformRandom(Seed);
            int actual = gen2.NextInt();

            Assert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_Seed_DifferentSeed_DifferentValue()
        {
            var gen1 = new MersenneTwisterSfmt132049UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt132049UniformRandom(Seed + 1);
            int actual = gen2.NextInt();

            Assert.AreNotEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_CanReset_ReturnsTrue()
        {
            var gen = new MersenneTwisterSfmt132049UniformRandom();

            Assert.IsTrue(gen.CanReset);
        }

        [TestMethod]
        public void MersenneTwisterSfmt132049UniformRandom_Reset_ValueGeneratedThenReset_SameValueGenerated()
        {
            var gen = new MersenneTwisterSfmt132049UniformRandom();
            int expected = gen.NextInt();

            gen.Reset();
            int actual = gen.NextInt();

            Assert.AreEqual(expected, actual);
        }
    }
}
