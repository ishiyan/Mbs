using System.Linq;
using Mbs.Numerics.Random;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators
{
    [TestClass]
    public class MersenneTwisterSfmt19937UniformRandomTests
    {
        private const int Seed = 12345;
        private const int Count = 5000;

        private static readonly ulong[] ExpectedULong =
        {
            3440181298UL, 1564997079UL, 1510669302UL, 2930277156UL, 1452439940UL,
            3796268453UL,  423124208UL, 2143818589UL, 3827219408UL, 2987036003UL,
            2674978610UL, 1536842514UL, 2027035537UL, 2534897563UL, 1686527725UL,
             545368292UL, 1489013321UL, 1370534252UL, 4231012796UL, 3994803019UL,
            1764869045UL,  824597505UL,  862581900UL, 2469764249UL,  812862514UL,
             359318673UL,  116957936UL, 3367389672UL, 2327178354UL, 1898245200UL,
            3206507879UL, 2378925033UL, 1040214787UL, 2524778605UL, 3088428700UL,
            1417665896UL,  964324147UL, 2282797708UL, 2456269299UL,  313400376UL,
            2245093271UL, 1015729427UL, 2694465011UL, 3246975184UL, 1992793635UL,
             463679346UL, 3721104591UL, 3475064196UL,  856141236UL, 1499559719UL,
            3522818941UL, 3721533109UL, 1954826617UL, 1282044024UL, 1543279136UL,
            1301863085UL, 2669145051UL, 4221477354UL, 3896016841UL, 3392740262UL,
             462466863UL, 1037679449UL, 1228140306UL,  922298197UL, 1205109853UL,
            1872938061UL, 3102547608UL, 2742766808UL, 1888626088UL, 4028039414UL,
             157593879UL, 1136901695UL, 4038377686UL, 3572517236UL, 4231706728UL,
            2997311961UL, 1189931652UL, 3981543765UL, 2826166703UL,   87159245UL,
            1721379072UL, 3897926942UL, 1790395498UL, 2569178939UL, 1047368729UL,
            2340259131UL, 3144212906UL, 2301169789UL, 2442885464UL, 3034046771UL,
            3667880593UL, 3935928400UL, 2372805237UL, 1666397115UL, 2460584504UL,
             513866770UL, 3810869743UL, 2147400037UL, 2792078025UL, 2941761810UL,
            3212265810UL,  984692259UL,  346590253UL, 1804179199UL, 3298543443UL,
             750108141UL, 2880257022UL,  243310542UL, 1869036465UL, 1588062513UL,
            2983949551UL, 1931450364UL, 4034505847UL, 2735030199UL, 1628461061UL,
            2539522841UL,  127965585UL, 3992448871UL,  913388237UL,  559130076UL,
            1202933193UL, 4087643167UL, 2590021067UL, 2256240196UL, 1746697293UL,
            1013913783UL, 1155864921UL, 2715773730UL,  915061862UL, 1948766573UL,
            2322882854UL, 3761119102UL, 1343405684UL, 3078711943UL, 3067431651UL,
            3245156316UL, 3588354584UL, 3484623306UL, 3899621563UL, 4156689741UL,
            3237090058UL, 3880063844UL,  862416318UL, 4039923869UL, 2303788317UL,
            3073590536UL,  701653667UL, 2131530884UL, 3169309950UL, 2028486980UL,
             747196777UL, 3620218225UL,  432016035UL, 1449580595UL, 2772266392UL,
             444224948UL, 1662832057UL, 3184055582UL, 3028331792UL, 1861686254UL,
            1104864179UL,  342430307UL, 1350510923UL, 3024656237UL, 1028417492UL,
            2870772950UL,  290847558UL, 3675663500UL,  508431529UL, 4264340390UL,
            2263569913UL, 1669302976UL,  519511383UL, 2706411211UL, 3764615828UL,
            3883162495UL, 4051445305UL, 2412729798UL, 3299405164UL, 3991911166UL,
            2348767304UL, 2664054906UL, 3763609282UL,  593943581UL, 3757090046UL,
            2075338894UL, 2020550814UL, 4287452920UL, 4290140003UL, 1422957317UL,
            2512716667UL, 2003485045UL, 2307520103UL, 2288472169UL, 3940751663UL,
            4204638664UL, 2892583423UL, 1710068300UL, 3904755993UL, 2363243951UL,
            3038334120UL,  547099465UL,  771105860UL, 3199983734UL, 4282046461UL,
            2298388363UL,  934810218UL, 2837827901UL, 3952500708UL, 2095130248UL,
            3083335297UL,   26885281UL, 3932155283UL, 1531751116UL, 1425227133UL,
             495654159UL, 3279634176UL, 3855562207UL, 3957195338UL, 4159985527UL,
             893375062UL, 1875515536UL, 1327247422UL, 3754140693UL, 1028923197UL,
            1729880440UL,  805571298UL,  448971099UL, 2726757106UL, 2749436461UL,
            2485987104UL,  175337042UL, 3235477922UL, 3882114302UL, 2020970972UL,
             943926109UL, 2762587195UL, 1904195558UL, 3452650564UL,  108432281UL,
            3893463573UL, 3977583081UL, 2636504348UL, 1110673525UL, 3548479841UL,
            4258854744UL,  980047703UL, 4057175418UL, 3890008292UL,  145653646UL,
            3141868989UL, 3293216228UL, 1194331837UL, 1254570642UL, 3049934521UL,
            2868313360UL, 2886032750UL, 1110873820UL,  279553524UL, 3007258565UL,
            1104807822UL, 3186961098UL,  315764646UL, 2163680838UL, 3574508994UL,
            3099755655UL,  191957684UL, 3642656737UL, 3317946149UL, 3522087636UL,
             444526410UL,  779157624UL, 1088229627UL, 1092460223UL, 1856013765UL,
            3659877367UL,  368270451UL,  503570716UL, 3000984671UL, 2742789647UL,
             928097709UL, 2914109539UL,  308843566UL, 2816161253UL, 3667192079UL,
            2762679057UL, 3395240989UL, 2928925038UL, 1491465914UL, 3458702834UL,
            3787782576UL, 2894104823UL, 1296880455UL, 1253636503UL,  989959407UL,
            2291560361UL, 2776790436UL, 1913178042UL, 1584677829UL,  689637520UL,
            1898406878UL,  688391508UL, 3385234998UL,  845493284UL, 1943591856UL,
            2720472050UL,  222695101UL, 1653320868UL, 2904632120UL, 4084936008UL,
            1080720688UL, 3938032556UL,  387896427UL, 2650839632UL,   99042991UL,
            1720913794UL, 1047186003UL, 1877048040UL, 2090457659UL,  517087501UL,
            4172014665UL, 2129713163UL, 2413533132UL, 2760285054UL, 4129272496UL,
            1317737175UL, 2309566414UL, 2228873332UL, 3889671280UL, 1110864630UL,
            3576797776UL, 2074552772UL,  832002644UL, 3097122623UL, 2464859298UL,
            2679603822UL, 1667489885UL, 3237652716UL, 1478413938UL, 1719340335UL,
            2306631119UL,  639727358UL, 3369698270UL,  226902796UL, 2099920751UL,
            1892289957UL, 2201594097UL, 3508197013UL, 3495811856UL, 3900381493UL,
             841660320UL, 3974501451UL, 3360949056UL, 1676829340UL,  728899254UL,
            2047809627UL, 2390948962UL,  670165943UL, 3412951831UL, 4189320049UL,
            1911595255UL, 2055363086UL,  507170575UL,  418219594UL, 4141495280UL,
            2692088692UL, 4203630654UL, 3540093932UL,  791986533UL, 2237921051UL,
            2526864324UL, 2956616642UL, 1394958700UL, 1983768223UL, 1893373266UL,
             591653646UL,  228432437UL, 1611046598UL, 3007736357UL, 1040040725UL,
            2726180733UL, 2789804360UL, 4263568405UL,  829098158UL, 3847722805UL,
            1123578029UL, 1804276347UL,  997971319UL, 4203797076UL, 4185199713UL,
            2811733626UL, 2343642194UL, 2985262313UL, 1417930827UL, 3759587724UL,
            1967077982UL, 1585223204UL, 1097475516UL, 1903944948UL,  740382444UL,
            1114142065UL, 1541796065UL, 1718384172UL, 1544076191UL, 1134682254UL,
            3519754455UL, 2866243923UL,  341865437UL,  645498576UL, 2690735853UL,
            1046963033UL, 2493178460UL, 1187604696UL, 1619577821UL,  488503634UL,
            3255768161UL, 2306666149UL, 1630514044UL, 2377698367UL, 2751503746UL,
            3794467088UL, 1796415981UL, 3657173746UL,  409136296UL, 1387122342UL,
            1297726519UL,  219544855UL, 4270285558UL,  437578827UL, 1444698679UL,
            2258519491UL,  963109892UL, 3982244073UL, 3351535275UL,  385328496UL,
            1804784013UL,  698059346UL, 3920535147UL,  708331212UL,  784338163UL,
             785678147UL, 1238376158UL, 1557298846UL, 2037809321UL,  271576218UL,
            4145155269UL, 1913481602UL, 2763691931UL,  588981080UL, 1201098051UL,
            3717640232UL, 1509206239UL,  662536967UL, 3180523616UL, 1133105435UL,
            2963500837UL, 2253971215UL, 3153642623UL, 1066925709UL, 2582781958UL,
            3034720222UL, 1090798544UL, 2942170004UL, 4036187520UL,  686972531UL,
            2610990302UL, 2641437026UL, 1837562420UL,  722096247UL, 1315333033UL,
            2102231203UL, 3402389208UL, 3403698140UL, 1312402831UL, 2898426558UL,
             814384596UL,  385649582UL, 1916643285UL, 1924625106UL, 2512905582UL,
            2501170304UL, 4275223366UL, 2841225246UL, 1467663688UL, 3563567847UL,
            2969208552UL,  884750901UL,  102992576UL,  227844301UL, 3681442994UL,
            3502881894UL, 4034693299UL, 1166727018UL, 1697460687UL, 1737778332UL,
            1787161139UL, 1053003655UL, 1215024478UL, 2791616766UL, 2525841204UL,
            1629323443UL,    3233815UL, 2003823032UL, 3083834263UL, 2379264872UL,
            3752392312UL, 1287475550UL, 3770904171UL, 3004244617UL, 1502117784UL,
             918698423UL, 2419857538UL, 3864502062UL, 1751322107UL, 2188775056UL,
            4018728324UL,  983712955UL,  440071928UL, 3710838677UL, 2001027698UL,
            3994702151UL,   22493119UL, 3584400918UL, 3446253670UL, 4254789085UL,
            1405447860UL, 1240245579UL, 1800644159UL, 1661363424UL, 3278326132UL,
            3403623451UL,   67092802UL, 2609352193UL, 3914150340UL, 1814842761UL,
            3610830847UL,  591531412UL, 3880232807UL, 1673505890UL, 2585326991UL,
            1678544474UL, 3148435887UL, 3457217359UL, 1193226330UL, 2816576908UL,
             154025329UL,  121678860UL, 1164915738UL,  973873761UL,  269116100UL,
              52087970UL,  744015362UL,  498556057UL,   94298882UL, 1563271621UL,
            2383059628UL, 4197367290UL, 3958472990UL, 2592083636UL, 2906408439UL,
            1097742433UL, 3924840517UL,  264557272UL, 2292287003UL, 3203307984UL,
            4047038857UL, 3820609705UL, 2333416067UL, 1839206046UL, 3600944252UL,
            3412254904UL,  583538222UL, 2390557166UL, 4140459427UL, 2810357445UL,
             226777499UL, 2496151295UL, 2207301712UL, 3283683112UL,  611630281UL,
            1933218215UL, 3315610954UL, 3889441987UL, 3719454256UL, 3957190521UL,
            1313998161UL, 2365383016UL, 3146941060UL, 1801206260UL,  796124080UL,
            2076248581UL, 1747472464UL, 3254365145UL,  595543130UL, 3573909503UL,
            3758250204UL, 2020768540UL, 2439254210UL,   93368951UL, 3155792250UL,
            2600232980UL, 3709198295UL, 3894900440UL, 2971850836UL, 1578909644UL,
            1443493395UL, 2581621665UL, 3086506297UL, 2443465861UL,  558107211UL,
            1519367835UL,  249149686UL,  908102264UL, 2588765675UL, 1232743965UL,
            1001330373UL, 3561331654UL, 2259301289UL, 1564977624UL, 3835077093UL,
             727244906UL, 4255738067UL, 1214133513UL, 2570786021UL, 3899704621UL,
            1633861986UL, 1636979509UL, 1438500431UL,   58463278UL, 2823485629UL,
            2297430187UL, 2926781924UL, 3371352948UL, 1864009023UL, 2722267973UL,
            1444292075UL,  437703973UL, 1060414512UL,  189705863UL,  910018135UL,
            4077357964UL,  884213423UL, 2644986052UL, 3973488374UL, 1187906116UL,
            2331207875UL,  780463700UL, 3713351662UL, 3854611290UL,  412805574UL,
            2978462572UL, 2176222820UL,  829424696UL, 2790788332UL, 2750819108UL,
            1594611657UL, 3899878394UL, 3032870364UL, 1702887682UL, 1948167778UL,
              14130042UL,  192292500UL,  947227076UL,   90719497UL, 3854230320UL,
             784028434UL, 2142399787UL, 1563449646UL, 2844400217UL,  819143172UL,
            2883302356UL, 2328055304UL, 1328532246UL, 2603885363UL, 3375188924UL,
             933941291UL, 3627039714UL, 2129697284UL, 2167253953UL, 2506905438UL,
            1412424497UL, 2981395985UL, 1418359660UL, 2925902456UL,   52752784UL,
            3713667988UL, 3924669405UL,  648975707UL, 1145520213UL, 4018650664UL,
            3805915440UL, 2380542088UL, 2013260958UL, 3262572197UL, 2465078101UL,
            1114540067UL, 3728768081UL, 2396958768UL,  590672271UL,  904818725UL,
            4263660715UL,  700754408UL, 1042601829UL, 4094111823UL, 4274838909UL,
            2512692617UL, 2774300207UL, 2057306915UL, 3470942453UL,   99333088UL,
            1142661026UL, 2889931380UL,   14316674UL, 2201179167UL,  415289459UL,
             448265759UL, 3515142743UL, 3254903683UL,  246633281UL, 1184307224UL,
            2418347830UL, 2092967314UL, 2682072314UL, 2558750234UL, 2000352263UL,
            1544150531UL,  399010405UL, 1513946097UL,  499682937UL,  461167460UL,
            3045570638UL, 1633669705UL,  851492362UL, 4052801922UL, 2055266765UL,
             635556996UL,  368266356UL, 2385737383UL, 3218202352UL, 2603772408UL,
             349178792UL,  226482567UL, 3102426060UL, 3575998268UL, 2103001871UL,
            3243137071UL,  225500688UL, 1634718593UL, 4283311431UL, 4292122923UL,
            3842802787UL,  811735523UL,  105712518UL,  663434053UL, 1855889273UL,
            2847972595UL, 1196355421UL, 2552150115UL, 4254510614UL, 3752181265UL,
            3430721819UL, 3828705396UL, 3436287905UL, 3441964937UL, 4123670631UL,
             353001539UL,  459496439UL, 3799690868UL, 1293777660UL, 2761079737UL,
             498096339UL, 3398433374UL, 4080378380UL, 2304691596UL, 2995729055UL,
            4134660419UL, 3903444024UL, 3576494993UL,  203682175UL, 3321164857UL,
            2747963611UL,   79749085UL, 2992890370UL, 1240278549UL, 1772175713UL,
            2111331972UL, 2655023449UL, 1683896345UL, 2836027212UL, 3482868021UL,
            2489884874UL,  756853961UL, 2298874501UL, 4013448667UL, 4143996022UL,
            2948306858UL, 4132920035UL, 1283299272UL,  995592228UL, 3450508595UL,
            1027845759UL, 1766942720UL, 3861411826UL, 1446861231UL,   95974993UL,
            3502263554UL, 1487532194UL,  601502472UL, 4129619129UL,  250131773UL,
            2050079547UL, 3198903947UL, 3105589778UL, 4066481316UL, 3026383978UL,
            2276901713UL,  365637751UL, 2260718426UL, 1394775634UL, 1791172338UL,
            2690503163UL, 2952737846UL, 1568710462UL,  732623190UL, 2980358000UL,
            1053631832UL, 1432426951UL, 3229149635UL, 1854113985UL, 3719733532UL,
            3204031934UL,  735775531UL,  107468620UL, 3734611984UL,  631009402UL,
            3083622457UL, 4109580626UL,  159373458UL, 1301970201UL, 4132389302UL,
            1293255004UL,  847182752UL, 4170022737UL,   96712900UL, 2641406755UL,
            1381727755UL,  405608287UL, 4287919625UL, 1703554290UL, 3589580244UL,
            2911403488UL,    2166565UL, 2647306451UL, 2330535117UL, 1200815358UL,
            1165916754UL,  245060911UL, 4040679071UL, 3684908771UL, 2452834126UL,
            2486872773UL, 2318678365UL, 2940627908UL, 1837837240UL, 3447897409UL,
            4270484676UL, 1495388728UL, 3754288477UL, 4204167884UL, 1386977705UL,
            2692224733UL, 3076249689UL, 4109568048UL, 4170955115UL, 4167531356UL,
            4020189950UL, 4261855038UL, 3036907575UL, 3410399885UL, 3076395737UL,
            1046178638UL,  144496770UL,  230725846UL, 3349637149UL,   17065717UL,
            2809932048UL, 2054581785UL, 3608424964UL, 3259628808UL,  134897388UL,
            3743067463UL,  257685904UL, 3795656590UL, 1562468719UL, 3589103904UL,
            3120404710UL,  254684547UL, 2653661580UL, 3663904795UL, 2631942758UL,
            1063234347UL, 2609732900UL, 2332080715UL, 3521125233UL, 1180599599UL,
            1935868586UL, 4110970440UL,  296706371UL, 2128666368UL, 1319875791UL,
            1570900197UL, 3096025483UL, 1799882517UL, 1928302007UL, 1163707758UL,
            1244491489UL, 3533770203UL,  567496053UL, 2757924305UL, 2781639343UL,
            2818420107UL,  560404889UL, 2619609724UL, 4176035430UL, 2511289753UL,
            2521842019UL, 3910553502UL, 2926149387UL, 3302078172UL, 4237118867UL,
             330725126UL,  367400677UL,  888239854UL,  545570454UL, 4259590525UL,
             134343617UL, 1102169784UL, 1647463719UL, 3260979784UL, 1518840883UL,
            3631537963UL, 3342671457UL, 1301549147UL, 2083739356UL,  146593792UL,
            3217959080UL,  652755743UL, 2032187193UL, 3898758414UL, 1021358093UL,
            4037409230UL, 2176407931UL, 3427391950UL, 2883553603UL,  985613827UL,
            3105265092UL, 3423168427UL, 3387507672UL,  467170288UL, 2141266163UL,
            3723870208UL,  916410914UL, 1293987799UL, 2652584950UL,  769160137UL,
            3205292896UL, 1561287359UL, 1684510084UL, 3136055621UL, 3765171391UL,
             639683232UL, 2639569327UL, 1218546948UL, 4263586685UL, 3058215773UL,
            2352279820UL,  401870217UL, 2625822463UL, 1529125296UL, 2981801895UL,
            1191285226UL, 4027725437UL, 3432700217UL, 4098835661UL,  971182783UL,
            2443861173UL, 3881457123UL, 3874386651UL,  457276199UL, 2638294160UL,
            4002809368UL,  421169044UL, 1112642589UL, 3076213779UL, 3387033971UL,
            2499610950UL, 3057240914UL, 1662679783UL,  461224431UL, 1168395933UL
        };

        private static readonly ulong[] ExpectedULongArray =
        {
            2920711183UL, 3885745737UL, 3501893680UL,  856470934UL, 1421864068UL,
             277361036UL, 1518638004UL, 2328404353UL, 3355513634UL,   64329189UL,
            1624587673UL, 3508467182UL, 2481792141UL, 3706480799UL, 1925859037UL,
            2913275699UL,  882658412UL,  384641219UL,  422202002UL, 1873384891UL,
            2006084383UL, 3924929912UL, 1636718106UL, 3108838742UL, 1245465724UL,
            4195470535UL,  779207191UL, 1577721373UL, 1390469554UL, 2928648150UL,
             121399709UL, 3170839019UL, 4044347501UL,  953953814UL, 3821710850UL,
            3085591323UL, 3666535579UL, 3577837737UL, 2012008410UL, 3565417471UL,
            4044408017UL,  433600965UL, 1637785608UL, 1798509764UL,  860770589UL,
            3081466273UL, 3982393409UL, 2451928325UL, 3437124742UL, 4093828739UL,
            3357389386UL, 2154596123UL,  496568176UL, 2650035164UL, 2472361850UL,
               3438299UL, 2150366101UL, 1577256676UL, 3802546413UL, 1787774626UL,
            4078331588UL, 3706103141UL,  170391138UL, 3806085154UL, 1680970100UL,
            1961637521UL, 3316029766UL,  890610272UL, 1453751581UL, 1430283664UL,
            3051057411UL, 3597003186UL,  542563954UL, 3796490244UL, 1690016688UL,
            3448752238UL,  440702173UL,  347290497UL, 1121336647UL, 2540588620UL,
             280881896UL, 2495136428UL,  213707396UL,   15104824UL, 2946180358UL,
             659000016UL,  566379385UL, 2614030979UL, 2855760170UL,  334526548UL,
            2315569495UL, 2729518615UL,  564745877UL, 1263517638UL, 3157185798UL,
            1604852056UL, 1011639885UL, 2950579535UL, 2524219188UL,  312951012UL,
            1528896652UL, 1327861054UL, 2846910138UL, 3966855905UL, 2536721582UL,
             855353911UL, 1685434729UL, 3303978929UL, 1624872055UL, 4020329649UL,
            3164802143UL, 1642802700UL, 1957727869UL, 1792352426UL, 3334618929UL,
            2631577923UL, 3027156164UL,  842334259UL, 3353446843UL, 1226432104UL,
            1742801369UL, 3552852535UL, 3471698828UL, 1653910186UL, 3380330939UL,
            2313782701UL, 3351007196UL, 2129839995UL, 1800682418UL, 4085884420UL,
            1625156629UL, 3669701987UL,  615211810UL, 3294791649UL, 4131143784UL,
            2590843588UL, 3207422808UL, 3275066464UL,  561592872UL, 3957205738UL,
            3396578098UL,   48410678UL, 3505556445UL, 1005764855UL, 3920606528UL,
            2936980473UL, 2378918600UL, 2404449845UL, 1649515163UL,  701203563UL,
            3705256349UL,   83714199UL, 3586854132UL,  922978446UL, 2863406304UL,
            3523398907UL, 2606864832UL, 2385399361UL, 3171757816UL, 4262841009UL,
            3645837721UL, 1169579486UL, 3666433897UL, 3174689479UL, 1457866976UL,
            3803895110UL, 3346639145UL, 1907224409UL, 1978473712UL, 1036712794UL,
             980754888UL, 1302782359UL, 1765252468UL,  459245755UL, 3728923860UL,
            1512894209UL, 2046491914UL,  207860527UL,  514188684UL, 2288713615UL,
            1597354672UL, 3349636117UL, 2357291114UL, 3995796221UL,  945364213UL,
            1893326518UL, 3770814016UL, 1691552714UL, 2397527410UL,  967486361UL,
             776416472UL, 4197661421UL,  951150819UL, 1852770983UL, 4044624181UL,
            1399439738UL, 4194455275UL, 2284037669UL, 1550734958UL, 3321078108UL,
            1865235926UL, 2912129961UL, 2664980877UL, 1357572033UL, 2600196436UL,
            2486728200UL, 2372668724UL, 1567316966UL, 2374111491UL, 1839843570UL,
              20815612UL, 3727008608UL, 3871996229UL,  824061249UL, 1932503978UL,
            3404541726UL,  758428924UL, 2609331364UL, 1223966026UL, 1299179808UL,
             648499352UL, 2180134401UL,  880821170UL, 3781130950UL,  113491270UL,
            1032413764UL, 4185884695UL, 2490396037UL, 1201932817UL, 4060951446UL,
            4165586898UL, 1629813212UL, 2887821158UL,  415045333UL,  628926856UL,
            2193466079UL, 3391843445UL, 2227540681UL, 1907099846UL, 2848448395UL,
            1717828221UL, 1372704537UL, 1707549841UL, 2294058813UL, 2101214437UL,
            2052479531UL, 1695809164UL, 3176587306UL, 2632770465UL,   81634404UL,
            1603220563UL,  644238487UL,  302857763UL,  897352968UL, 2613146653UL,
            1391730149UL, 4245717312UL, 4191828749UL, 1948492526UL, 2618174230UL,
            3992984522UL, 2178852787UL, 3596044509UL, 3445573503UL, 2026614616UL,
             915763564UL, 3415689334UL, 2532153403UL, 3879661562UL, 2215027417UL,
            3111154986UL, 2929478371UL,  668346391UL, 1152241381UL, 2632029711UL,
            3004150659UL, 2135025926UL,  948690501UL, 2799119116UL, 4228829406UL,
            1981197489UL, 4209064138UL,  684318751UL, 3459397845UL,  201790843UL,
            4022541136UL, 3043635877UL,  492509624UL, 3263466772UL, 1509148086UL,
             921459029UL, 3198857146UL,  705479721UL, 3835966910UL, 3603356465UL,
             576159741UL, 1742849431UL,  594214882UL, 2055294343UL, 3634861861UL,
             449571793UL, 3246390646UL, 3868232151UL, 1479156585UL, 2900125656UL,
            2464815318UL, 3960178104UL, 1784261920UL,   18311476UL, 3627135050UL,
             644609697UL,  424968996UL,  919890700UL, 2986824110UL,  816423214UL,
            4003562844UL, 1392714305UL, 1757384428UL, 2569030598UL,  995949559UL,
            3875659880UL, 2933807823UL, 2752536860UL, 2993858466UL, 4030558899UL,
            2770783427UL, 2775406005UL, 2777781742UL, 1931292655UL,  472147933UL,
            3865853827UL, 2726470545UL, 2668412860UL, 2887008249UL,  408979190UL,
            3578063323UL, 3242082049UL, 1778193530UL,   27981909UL, 2362826515UL,
             389875677UL, 1043878156UL,  581653903UL, 3830568952UL,  389535942UL,
            3713523185UL, 2768373359UL, 2526101582UL, 1998618197UL, 1160859704UL,
            3951172488UL, 1098005003UL,  906275699UL, 3446228002UL, 2220677963UL,
            2059306445UL,  132199571UL,  476838790UL, 1868039399UL, 3097344807UL,
             857300945UL,  396345050UL, 2835919916UL, 1782168828UL, 1419519470UL,
            4288137521UL,  819087232UL,  596301494UL,  872823172UL, 1526888217UL,
             805161465UL, 1116186205UL, 2829002754UL, 2352620120UL,  620121516UL,
             354159268UL, 3601949785UL,  209568138UL, 1352371732UL, 2145977349UL,
            4236871834UL, 1539414078UL, 3558126206UL, 3224857093UL, 4164166682UL,
            3817553440UL, 3301780278UL, 2682696837UL, 3734994768UL, 1370950260UL,
            1477421202UL, 2521315749UL, 1330148125UL, 1261554731UL, 2769143688UL,
            3554756293UL, 4235882678UL, 3254686059UL, 3530579953UL, 1215452615UL,
            3574970923UL, 4057131421UL,  589224178UL, 1000098193UL,  171190718UL,
            2521852045UL, 2351447494UL, 2284441580UL, 2646685513UL, 3486933563UL,
            3789864960UL, 1190528160UL, 1702536782UL, 1534105589UL, 4262946827UL,
            2726686826UL, 3584544841UL, 2348270128UL, 2145092281UL, 2502718509UL,
            1027832411UL, 3571171153UL, 1287361161UL, 4011474411UL, 3241215351UL,
            2419700818UL,  971242709UL, 1361975763UL, 1096842482UL, 3271045537UL,
              81165449UL,  612438025UL, 3912966678UL, 1356929810UL,  733545735UL,
             537003843UL, 1282953084UL,  884458241UL,  588930090UL, 3930269801UL,
            2961472450UL, 1219535534UL, 3632251943UL,  268183903UL, 1441240533UL,
            3653903360UL, 3854473319UL, 2259087390UL, 2548293048UL, 2022641195UL,
            2105543911UL, 1764085217UL, 3246183186UL,  482438805UL,  888317895UL,
            2628314765UL, 2466219854UL,  717546004UL, 2322237039UL,  416725234UL,
            1544049923UL, 1797944973UL, 3398652364UL, 3111909456UL,  485742908UL,
            2277491072UL, 1056355088UL, 3181001278UL,  129695079UL, 2693624550UL,
            1764438564UL, 3797785470UL,  195503713UL, 3266519725UL, 2053389444UL,
            1961527818UL, 3400226523UL, 3777903038UL, 2597274307UL, 4235851091UL,
            4094406648UL, 2171410785UL, 1781151386UL, 1378577117UL,  654643266UL,
            3424024173UL, 3385813322UL,  679385799UL,  479380913UL,  681715441UL,
            3096225905UL,  276813409UL, 3854398070UL, 2721105350UL,  831263315UL,
            3276280337UL, 2628301522UL, 3984868494UL, 1466099834UL, 2104922114UL,
            1412672743UL,  820330404UL, 3491501010UL,  942735832UL,  710652807UL,
            3972652090UL,  679881088UL,   40577009UL, 3705286397UL, 2815423480UL,
            3566262429UL,  663396513UL, 3777887429UL, 4016670678UL,  404539370UL,
            1142712925UL, 1140173408UL, 2913248352UL, 2872321286UL,  263751841UL,
            3175196073UL, 3162557581UL, 2878996619UL,   75498548UL, 3836833140UL,
            3284664959UL, 1157523805UL,  112847376UL,  207855609UL, 1337979698UL,
            1222578451UL,  157107174UL,  901174378UL, 3883717063UL, 1618632639UL,
            1767889440UL, 4264698824UL, 1582999313UL,  884471997UL, 2508825098UL,
            3756370771UL, 2457213553UL, 3565776881UL, 3709583214UL,  915609601UL,
             460833524UL, 1091049576UL,   85522880UL,    2553251UL,  132102809UL,
            2429882442UL, 2562084610UL, 1386507633UL, 4112471229UL,   21965213UL,
            1981516006UL, 2418435617UL, 3054872091UL, 4251511224UL, 2025783543UL,
            1916911512UL, 2454491136UL, 3938440891UL, 3825869115UL, 1121698605UL,
            3463052265UL,  802340101UL, 1912886800UL, 4031997367UL, 3550640406UL,
            1596096923UL,  610150600UL,  431464457UL, 2541325046UL,  486478003UL,
             739704936UL, 2862696430UL, 3037903166UL, 1129749694UL, 2611481261UL,
            1228993498UL,  510075548UL, 3424962587UL, 2458689681UL,  818934833UL,
            4233309125UL, 1608196251UL, 3419476016UL, 1858543939UL, 2682166524UL,
            3317854285UL,  631986188UL, 3008214764UL,  613826412UL, 3567358221UL,
            3512343882UL, 1552467474UL, 3316162670UL, 1275841024UL, 4142173454UL,
             565267881UL,  768644821UL,  198310105UL, 2396688616UL, 1837659011UL,
             203429334UL,  854539004UL, 4235811518UL, 3338304926UL, 3730418692UL,
            3852254981UL, 3032046452UL, 2329811860UL, 2303590566UL, 2696092212UL,
            3894665932UL,  145835667UL,  249563655UL, 1932210840UL, 2431696407UL,
            3312636759UL,  214962629UL, 2092026914UL, 3020145527UL, 4073039873UL,
            2739105705UL, 1308336752UL,  855104522UL, 2391715321UL,   67448785UL,
             547989482UL,  854411802UL, 3608633740UL,  431731530UL,  537375589UL,
            3888005760UL,  696099141UL,  397343236UL, 1864511780UL,   44029739UL,
            1729526891UL, 1993398655UL, 2010173426UL, 2591546756UL,  275223291UL,
            1503900299UL, 4217765081UL, 2185635252UL, 1122436015UL, 3550155364UL,
             681707194UL, 3260479338UL,  933579397UL, 2983029282UL, 2505504587UL,
            2667410393UL, 2962684490UL, 4139721708UL, 2658172284UL, 2452602383UL,
            2607631612UL, 1344296217UL, 3075398709UL, 2949785295UL, 1049956168UL,
            3917185129UL, 2155660174UL, 3280524475UL, 1503827867UL,  674380765UL,
            1918468193UL, 3843983676UL,  634358221UL, 2538335643UL, 1873351298UL,
            3368723763UL, 2129144130UL, 3203528633UL, 3087174986UL, 2691698871UL,
            2516284287UL,   24437745UL, 1118381474UL, 2816314867UL, 2448576035UL,
            4281989654UL,  217287825UL,  165872888UL, 2628995722UL, 3533525116UL,
            2721669106UL,  872340568UL, 3429930655UL, 3309047304UL, 3916704967UL,
            3270160355UL, 1348884255UL, 1634797670UL,  881214967UL, 4259633554UL,
             174613027UL, 1103974314UL, 1625224232UL, 2678368291UL, 1133866707UL,
            3853082619UL, 4073196549UL, 1189620777UL,  637238656UL,  930241537UL,
            4042750792UL, 3842136042UL, 2417007212UL, 2524907510UL, 1243036827UL,
            1282059441UL, 3764588774UL, 1394459615UL, 2323620015UL, 1166152231UL,
            3307479609UL, 3849322257UL, 3507445699UL, 4247696636UL,  758393720UL,
             967665141UL, 1095244571UL, 1319812152UL,  407678762UL, 2640605208UL,
            2170766134UL, 3663594275UL, 4039329364UL, 2512175520UL,  725523154UL,
            2249807004UL, 3312617979UL, 2414634172UL, 1278482215UL,  349206484UL,
            1573063308UL, 1196429124UL, 3873264116UL, 2400067801UL,  268795167UL,
             226175489UL, 2961367263UL, 1968719665UL,   42656370UL, 1010790699UL,
             561600615UL, 2422453992UL, 3082197735UL, 1636700484UL, 3977715296UL,
            3125350482UL, 3478021514UL, 2227819446UL, 1540868045UL, 3061908980UL,
            1087362407UL, 3625200291UL,  361937537UL,  580441897UL, 1520043666UL,
            2270875402UL, 1009161260UL, 2502355842UL, 4278769785UL,  473902412UL,
            1057239083UL, 1905829039UL, 1483781177UL, 2080011417UL, 1207494246UL,
            1806991954UL, 2194674403UL, 3455972205UL,  807207678UL, 3655655687UL,
             674112918UL,  195425752UL, 3917890095UL, 1874364234UL, 1837892715UL,
            3663478166UL, 1548892014UL, 2570748714UL, 2049929836UL, 2167029704UL,
             697543767UL, 3499545023UL, 3342496315UL, 1725251190UL, 3561387469UL,
            2905606616UL, 1580182447UL, 3934525927UL, 4103172792UL, 1365672522UL,
            1534795737UL, 3308667416UL, 2841911405UL, 3943182730UL, 4072020313UL,
            3494770452UL, 3332626671UL,   55327267UL,  478030603UL,  411080625UL,
            3419529010UL, 1604767823UL, 3513468014UL,  570668510UL,  913790824UL,
            2283967995UL,  695159462UL, 3825542932UL, 4150698144UL, 1829758699UL,
             202895590UL, 1609122645UL, 1267651008UL, 2910315509UL, 2511475445UL,
            2477423819UL, 3932081579UL,  900879979UL, 2145588390UL, 2670007504UL,
             580819444UL, 1864996828UL, 2526325979UL, 1019124258UL,  815508628UL,
            2765933989UL, 1277301341UL, 3006021786UL,  855540956UL,  288025710UL,
            1919594237UL, 2331223864UL,  177452412UL, 2475870369UL, 2689291749UL,
             865194284UL,  253432152UL, 2628531804UL, 2861208555UL, 2361597573UL,
            1653952120UL, 1039661024UL, 2159959078UL, 3709040440UL, 3564718533UL,
            2596878672UL, 2041442161UL,   31164696UL, 2662962485UL, 3665637339UL,
            1678115244UL, 2699839832UL, 3651968520UL, 3521595541UL,  458433303UL,
            2423096824UL,   21831741UL,  380011703UL, 2498168716UL,  861806087UL,
            1673574843UL, 4188794405UL, 2520563651UL, 2632279153UL, 2170465525UL,
            4171949898UL, 3886039621UL, 1661344005UL, 3424285243UL,  992588372UL,
            2500984144UL, 2993248497UL, 3590193895UL, 1535327365UL,  515645636UL,
             131633450UL, 3729760261UL, 1613045101UL, 3254194278UL,   15889678UL,
            1493590689UL,  244148718UL, 2991472662UL, 1401629333UL,  777349878UL,
            2501401703UL, 4285518317UL, 3794656178UL,  955526526UL, 3442142820UL,
            3970298374UL,  736025417UL, 2737370764UL, 1271509744UL,  440570731UL,
             136141826UL, 1596189518UL,  923399175UL,  257541519UL, 3505774281UL,
            2194358432UL, 2518162991UL, 1379893637UL, 2667767062UL, 3748146247UL,
            1821712620UL, 3923161384UL, 1947811444UL, 2392527197UL, 4127419685UL,
            1423694998UL, 4156576871UL, 1382885582UL, 3420127279UL, 3617499534UL,
            2994377493UL, 4038063986UL, 1918458672UL, 2983166794UL, 4200449033UL,
             353294540UL, 1609232588UL,  243926648UL, 2332803291UL,  507996832UL,
            2392838793UL, 4075145196UL, 2060984340UL, 4287475136UL,   88232602UL,
            2491531140UL, 4159725633UL, 2272075455UL,  759298618UL,  201384554UL,
             838356250UL, 1416268324UL,  674476934UL,   90795364UL,  141672229UL,
            3660399588UL, 4196417251UL, 3249270244UL, 3774530247UL,   59587265UL,
            3683164208UL,   19392575UL, 1463123697UL, 1882205379UL,  293780489UL,
            2553160622UL, 2933904694UL,  675638239UL, 2851336944UL, 1435238743UL,
            2448730183UL,  804436302UL, 2119845972UL,  322560608UL, 4097732704UL,
            2987802540UL,  641492617UL, 2575442710UL, 4217822703UL, 3271835300UL,
            2836418300UL, 3739921620UL, 2138378768UL, 2879771855UL, 4294903423UL,
            3121097946UL, 2603440486UL, 2560820391UL, 1012930944UL, 2313499967UL,
             584489368UL, 3431165766UL,  897384869UL, 2062537737UL, 2847889234UL,
            3742362450UL, 2951174585UL, 4204621084UL, 1109373893UL, 3668075775UL,
            2750138839UL, 3518055702UL,  733072558UL, 4169325400UL,  788493625UL
        };

        /// <summary>
        /// Taken from http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/index.html,
        /// <para />
        /// SFMT-src-1.3.3.zip, SFMT.19937.out.txt.
        /// </summary>
        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_NextUInt_ReferenceImplementationTest()
        {
            // int ulongLength = ExpectedULong.Length;
            const int ulongLength = 100;
            var gen = new MersenneTwisterSfmt19937UniformRandom(1234);
            for (int i = 0; i < ulongLength; ++i)
            {
                ulong expected = ExpectedULong[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation uint: index={i}, actual={actual} expected={expected}"));
            }

            // int ulongArrayLength = ExpectedULongArray.Length;
            const int ulongArrayLength = 100;
            gen = new MersenneTwisterSfmt19937UniformRandom(new[] { 0x1234, 0x5678, 0x9abc, 0xdef0 });
            for (int i = 0; i < ulongArrayLength; ++i)
            {
                ulong expected = ExpectedULongArray[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation array: index={i}, actual={actual} expected={expected}"));
            }
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_NextDouble_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt19937UniformRandom(Seed);
            double expected = 0.5;

            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 4;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 6;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(4, 8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_NextInt_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt19937UniformRandom(Seed);

            double expected = int.MaxValue / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 400d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 600d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(400, 800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_NextBoolean_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt19937UniformRandom(Seed);

            double expected = Count / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextBoolean() ? 1 : 0;
            }

            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_NextBytes_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt19937UniformRandom(Seed);

            double expected = 128;
            double actual = 0;
            var array = new byte[32];

            for (int i = 0; i < Count; ++i)
            {
                gen.NextBytes(array);
                actual = array.Aggregate(actual, (current, b) => current + b);
            }

            actual /= Count * 32;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_Seed_SameSeed_SameValue()
        {
            var gen1 = new MersenneTwisterSfmt19937UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt19937UniformRandom(Seed);
            int actual = gen2.NextInt();

            Assert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_Seed_DifferentSeed_DifferentValue()
        {
            var gen1 = new MersenneTwisterSfmt19937UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt19937UniformRandom(Seed + 1);
            int actual = gen2.NextInt();

            Assert.AreNotEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_CanReset_ReturnsTrue()
        {
            var gen = new MersenneTwisterSfmt19937UniformRandom();

            Assert.IsTrue(gen.CanReset);
        }

        [TestMethod]
        public void MersenneTwisterSfmt19937UniformRandom_Reset_ValueGeneratedThenReset_SameValueGenerated()
        {
            var gen = new MersenneTwisterSfmt19937UniformRandom();
            int expected = gen.NextInt();

            gen.Reset();
            int actual = gen.NextInt();

            Assert.AreEqual(expected, actual);
        }
    }
}
