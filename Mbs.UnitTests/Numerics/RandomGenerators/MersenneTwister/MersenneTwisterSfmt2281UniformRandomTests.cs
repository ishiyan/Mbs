using System.Linq;
using Mbs.Numerics.Random;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators
{
    [TestClass]
    public class MersenneTwisterSfmt2281UniformRandomTests
    {
        private const int Seed = 12345;
        private const int Count = 5000;

        private static readonly ulong[] ExpectedULong =
        {
             816899028UL, 2529810904UL, 2984700728UL, 4161010272UL, 3805350266UL,
            1279614432UL,  425690784UL, 1116614207UL, 1104668239UL, 1157865543UL,
            2631428793UL, 1738783324UL, 3817657585UL, 4038396021UL, 3929248340UL,
            2632374408UL, 3059467376UL, 1178391445UL, 1548683528UL, 2345690040UL,
            2324785226UL, 3565094863UL, 2477561011UL, 3810275196UL, 2224650186UL,
            3954132583UL, 2271684514UL, 3280953479UL, 3453754330UL, 1876516579UL,
            3970777246UL, 2889125929UL, 2780400968UL, 2196210122UL, 1644459300UL,
            3635678387UL, 1265164770UL,  996222486UL, 1178405414UL,   38273051UL,
            2218496689UL, 1581218069UL, 4015321227UL, 2976543678UL, 3811184429UL,
             910419949UL, 1761885375UL, 4087026321UL,  819584600UL, 2800120749UL,
            1834215650UL, 1563887150UL, 2843528502UL, 2093436960UL, 3284397394UL,
             643838879UL, 1551579238UL,  546347503UL, 1386094991UL, 1043222565UL,
             760929282UL,  115889273UL, 2329844900UL, 3643949804UL,  446121434UL,
            1731770848UL, 1699066330UL,  692055352UL, 1746525710UL, 2579260501UL,
            1195712685UL,  453310846UL, 2445241891UL, 2733116109UL, 1768560984UL,
             851520781UL,  317426829UL, 4077861862UL, 4097862822UL, 2766148675UL,
            1026281378UL, 3224734658UL,  780097769UL, 1724015980UL, 4114094301UL,
            3177787407UL, 1498112685UL, 1396388449UL, 3919455633UL,  309245542UL,
            1764381464UL, 3365720744UL, 1002755298UL, 2973254231UL, 3298510080UL,
            1794141014UL, 3633502430UL, 1263800067UL, 1667428176UL,  369193722UL,
            2157664554UL, 3417767090UL, 1779123921UL,  255412492UL, 3613198765UL,
            3569136446UL, 2884229390UL,  653835656UL, 3686815805UL,  395824929UL,
            3186060366UL, 2761354119UL, 1204981652UL,  369730960UL, 1379323924UL,
            2235823993UL, 2508768466UL,  314204115UL, 1812049613UL, 3518141961UL,
            1494532689UL, 2856417088UL,  848968686UL, 3662438435UL,  279488891UL,
            3369631026UL, 3580032182UL, 1206637762UL,  712024745UL, 3013005916UL,
            1331854044UL, 3062102203UL, 1443394602UL, 3391638353UL, 1167618356UL,
             785106606UL, 1922988868UL, 3641344516UL,  277524423UL,  590765342UL,
            4262829660UL,   27773832UL, 3514308659UL, 4121349199UL, 3666048330UL,
            3559507556UL, 3715041802UL, 2472891704UL, 3679211800UL, 4166236631UL,
            2902898024UL, 4025924573UL, 4222446530UL,  877581995UL, 3233930613UL,
            2053662610UL, 1180420653UL,  229125657UL,  637536940UL, 1409347510UL,
            2394745440UL, 2112670281UL, 2220740521UL,  697667598UL, 2997272986UL,
            1999799070UL, 2453374458UL,  404373343UL,  163619230UL, 2859970083UL,
             640846468UL, 3979417504UL,  257079139UL, 4092060031UL, 1872202164UL,
            2300567239UL,  361762578UL, 3875507443UL, 2846944059UL,  709052168UL,
             506849691UL, 1398687851UL, 3305944453UL,  135557337UL,  786787464UL,
            1727900681UL, 3292895892UL, 1074939372UL,  394728759UL, 1279739414UL,
            1683727173UL, 1284262575UL, 3976622897UL, 1253275589UL, 1601967242UL,
            3245726185UL,  938262741UL, 3999151982UL, 3219043728UL, 1669026027UL,
            2570292706UL,  290046311UL, 1837784354UL, 2997894165UL, 1604984294UL,
            2033170034UL, 3647929959UL,   92704829UL, 1698375661UL, 1128145623UL,
            2052247063UL, 2519822621UL, 2785562856UL, 3620689648UL, 3877865686UL,
            3655550747UL,  246626292UL, 1568212770UL, 3948196404UL, 3430798875UL,
            3651938126UL, 1096765664UL,  604642100UL, 2875150256UL, 1249478362UL,
            3377416797UL, 3225140890UL, 1876298020UL, 3379370917UL, 3269858749UL,
            1681247177UL,  490735198UL, 2970954457UL, 2786999707UL, 2697517850UL,
            2385232651UL, 4199969798UL, 1679098127UL,  674448896UL,  413608691UL,
            4069896971UL, 3488373551UL,  675439588UL, 2303940341UL, 3431129901UL,
            3440407031UL,  355880536UL,  555971775UL, 2975220887UL, 1984883183UL,
            2561826762UL, 3456343294UL, 4276852965UL,  515113896UL, 2346559686UL,
            4216818266UL, 3868203994UL, 1230445090UL, 1014102773UL,    3727532UL,
            3782113807UL,  489638922UL, 3013259665UL, 3315120982UL,  511672242UL,
            1755482090UL,   43969573UL, 1851687649UL,  708406454UL,  441251227UL,
            1448680893UL,  266807370UL,  546480825UL, 3498734391UL, 4026033057UL,
            1120042845UL, 2091032077UL, 1926113476UL, 3834654021UL, 2065941214UL,
            2657147089UL, 2594621201UL,  515419744UL, 2985520413UL, 2880399846UL,
            1703547422UL, 1825770272UL, 1343471268UL, 3822672017UL, 3578894293UL,
            4226603430UL, 1179188874UL, 2935557378UL, 2148556167UL, 1174352915UL,
               6808872UL, 2399670423UL, 3362526488UL, 3600354199UL, 2463065760UL,
            2760200984UL, 2653276527UL,  573013077UL, 1788294601UL,  545520975UL,
            1615264775UL,  714644932UL,  196447461UL,  749440090UL, 3315497900UL,
            1058138433UL, 3662661467UL,   96530802UL, 1042136735UL, 3269229051UL,
            3806615013UL, 1823124873UL, 1818008236UL, 3048271452UL, 2913374020UL,
             271537122UL,  314211144UL, 3145433497UL, 3083586822UL,  590085584UL,
             678091142UL,  521794900UL, 3323265008UL, 3508531491UL, 1248703839UL,
            3770986579UL, 3350859642UL, 2169111248UL, 3365920750UL, 1515501107UL,
             619164448UL,  678942152UL, 1743777205UL, 1360850610UL, 2869746499UL,
            1358022040UL,  163255738UL, 1596158819UL,  848725397UL,  727258867UL,
            1172011040UL, 3389592211UL, 2886231105UL, 3538238822UL,  531366241UL,
            1971487854UL, 2028669184UL,  857976654UL, 2759811165UL, 3282756330UL,
             134723676UL,  459684557UL, 2267766346UL, 2855210224UL, 2165504088UL,
            2962838672UL, 2634891834UL,  788411108UL, 3425579347UL, 3152602900UL,
            1901537755UL, 2008548228UL, 3977207737UL, 2220545652UL,  236116757UL,
             114043513UL, 2697833317UL, 1331333716UL, 3888681448UL, 3964179947UL,
            2761997244UL, 3855349155UL, 3587642110UL, 2118570649UL, 1664724454UL,
            3265510726UL,  600524259UL,   59607158UL, 4196187997UL, 3563094563UL,
            2441518232UL, 3122406656UL, 4267427840UL,  822788108UL, 2746172619UL,
            1944125348UL, 1236508147UL, 2750023635UL, 2390237980UL, 1029072381UL,
            2472991086UL, 4279104258UL, 4224627823UL, 3709142444UL,  435666415UL,
            1299933065UL, 2105551419UL, 1692111720UL, 2421152364UL, 2666185353UL,
            2877138421UL, 2053373117UL,  318612861UL, 1979998910UL, 3411799123UL,
            3249432174UL, 2388467144UL, 1088086362UL, 1753262185UL,  835024107UL,
            1208247744UL,  788443567UL, 3075719935UL, 2909310111UL, 2322692637UL,
            3557879327UL, 1256428985UL, 1428653864UL, 1132823743UL, 2637808835UL,
            3901517820UL, 1317252313UL,  709877622UL, 3865555255UL, 4270070506UL,
            1601033365UL, 1754197085UL, 1599659585UL, 2595040135UL,   69678822UL,
            2159011084UL, 1239892911UL, 4009521976UL,  609927430UL, 3357043468UL,
            1172049703UL, 1714027948UL, 3417911333UL,  903211542UL, 1375845927UL,
            3296762232UL,  729286900UL, 1450645278UL, 2007123082UL, 3911689880UL,
            1804336922UL, 3791901897UL,  976209777UL,  763233902UL, 1778772089UL,
            1123669611UL,  368035285UL,  978733750UL,  750487385UL,  372015174UL,
            2032130518UL,  620827236UL, 3282016487UL, 4196160590UL,  862903087UL,
            1030759961UL, 3967478517UL, 1467945155UL, 1299178346UL, 3870547528UL,
            3491821192UL, 1780205278UL,  936022646UL, 4288568420UL, 3417886343UL,
            3944924094UL, 2919520849UL, 3161789319UL, 2955366051UL, 4040493426UL,
            3296618498UL, 2325910317UL, 2776530001UL, 2559227848UL, 1581597070UL,
            3553934504UL, 1653953674UL, 4026643034UL, 4033353310UL, 1370496626UL,
            2926750211UL, 1810900353UL, 3694381893UL, 3573573155UL, 2119908610UL,
            3903451246UL, 2375236422UL, 1398198685UL, 2731327983UL, 3839515392UL,
            2102040430UL, 4047526134UL, 1446916131UL, 1007456505UL,  660143994UL,
             456191633UL, 2810249183UL, 2829218541UL, 2717617204UL, 1097379533UL,
            2049004540UL, 1168597546UL, 1859596394UL, 3861570037UL,   96276716UL,
            4086357891UL,  464518321UL, 3008924340UL, 4254602251UL, 3749242324UL,
            3244589088UL, 2002625154UL, 3326033644UL, 3449966565UL, 2735820086UL,
            1230058008UL, 1321330753UL, 3292038499UL,  275362798UL,  275916405UL,
             902751779UL,  289171378UL, 3826434746UL, 1459184217UL,  226538549UL,
            3644401945UL, 1040393247UL, 2042567170UL, 2233481513UL, 1646423540UL,
            1531307021UL, 3048319795UL,  662650618UL,  475521545UL, 3641557843UL,
             278489693UL, 1980923958UL, 3685637415UL, 2257437852UL, 1634839570UL,
            2642976099UL, 3470388235UL, 3282840158UL, 2117252785UL,  381835370UL,
            1916736013UL, 1548932191UL, 3510021704UL, 1063277541UL, 1674901724UL,
            2327182676UL, 4166887140UL, 1255107139UL, 1599510546UL, 1339487153UL,
              37420553UL, 2860168947UL, 2169029112UL, 1634379425UL, 3065240292UL,
            3362743767UL,  868962195UL,  263078329UL, 2486245653UL, 3136302351UL,
            1324608078UL, 2417725134UL,  892426712UL, 3698937314UL, 1510120597UL,
            1005224151UL, 3961251591UL, 2065915279UL,   70596668UL, 1671097934UL,
             319080692UL, 3277843989UL, 2684870298UL, 3278770348UL,  596636344UL,
             739047890UL, 1397442078UL, 3622072315UL, 2946087517UL, 2870077019UL,
            1596712897UL, 1966237483UL,  470363521UL, 2785682585UL, 3230738041UL,
             433415607UL, 1415200785UL,  413671098UL,  471662276UL, 1539972827UL,
             862973352UL,   43745579UL,  382806195UL, 3656530248UL,  287925306UL,
            1849907006UL,   97226555UL, 2057917334UL,  266700817UL, 1406351488UL,
             820604982UL, 1947222357UL, 4061582130UL, 2661579331UL, 4139252448UL,
             322593526UL,  161616496UL, 4100877342UL, 3254880213UL, 1250217778UL,
            2622800801UL, 1412552219UL, 1939041111UL,   97771915UL, 3842128746UL,
             973804625UL, 3990924385UL, 2493365265UL, 1706974605UL, 1930105428UL,
            1788039434UL,  276683724UL, 2234964285UL,  566806433UL, 1102287487UL,
            1536694295UL, 2641638976UL, 2491718177UL, 1772340381UL, 1557550709UL,
            3068144209UL, 3814164796UL, 2610962264UL, 2050162415UL, 1939821410UL,
            1944167805UL, 2695045527UL, 2003312269UL, 1433539020UL,  715509192UL,
            1061791099UL, 1807908624UL, 3857862952UL, 1713001137UL, 2398449136UL,
            2567584300UL, 3913387682UL, 3478767617UL, 1974966532UL, 3360986628UL,
            4131239017UL,  238912503UL, 3190282531UL, 1460335778UL, 2989681704UL,
            2957199364UL, 2551179516UL,   62460310UL, 2570098214UL, 3490157638UL,
            1203311625UL,  914395035UL, 3920357265UL, 3335505726UL, 1742462322UL,
            1917246433UL, 1198783741UL,  503622830UL,  635733614UL, 2567181448UL,
             908476152UL, 2435299592UL, 3895137584UL,  992081470UL, 3102965528UL,
            2633093378UL, 3894015089UL, 1652672327UL, 1591202621UL,  654401518UL,
            1613115955UL, 3965523016UL, 1460540708UL, 3985313908UL, 1941826903UL,
            1218768752UL, 2768951680UL, 2276338386UL, 1705124290UL, 1440728730UL,
            1670332906UL, 2039801924UL, 4152813223UL, 3724448647UL, 1873534722UL,
            1830937926UL, 3309111254UL, 3023888224UL, 1358324386UL, 2578489692UL,
            4133491788UL, 1883886556UL,   88305226UL, 1768660496UL, 2602269485UL,
            1945814418UL, 3262429138UL,  691085484UL, 3632864730UL, 2077490533UL,
            2363410457UL, 2740719445UL, 2592261156UL, 2453695457UL, 4206196730UL,
            3741676854UL, 1490294718UL, 3550753101UL, 1139715083UL,  418093773UL,
            2103826225UL, 3919131860UL, 2645351362UL, 1606743166UL,  580726424UL,
            4077894669UL, 2477207969UL, 1655237468UL, 3817519618UL, 2612971662UL,
            1579202880UL,  342204206UL,  744212569UL, 1348109452UL, 3501795286UL,
            4144017734UL, 4277741359UL, 1425311542UL,  565480072UL, 3480505439UL,
            4210045701UL, 1952835462UL,   43452966UL, 4216782297UL, 1493947967UL,
            2851599647UL, 1097905527UL, 2228846805UL, 1090239722UL, 1784322048UL,
            4280500441UL,  471375895UL, 2735295314UL,   37051833UL, 2321761463UL,
            2349109722UL, 2497874692UL, 3664449996UL, 2568074166UL, 4075873757UL,
            2650219319UL, 2984037886UL, 2868473007UL, 3244493524UL, 1788551885UL,
            4192489642UL, 2088858684UL,  709686434UL, 3960433705UL, 2806373381UL,
            3554000080UL, 1172722176UL, 4115728976UL, 3860414220UL,  120110920UL,
            3141470177UL, 3525055282UL, 2716448995UL, 1208199737UL, 1933332018UL,
            3361117921UL,  553900500UL, 3859903553UL, 3153060592UL, 2944103821UL,
             548177270UL, 3671410086UL,  713586644UL,  574043873UL,  449010961UL,
            1903213836UL, 3241729865UL, 2910180989UL,  993485553UL,  156459400UL,
            2189238404UL,  249235939UL, 3759258600UL, 1906222357UL, 3061540655UL,
             605359407UL, 1997159531UL, 3531126762UL, 2828611105UL,  480758515UL,
            4251322297UL, 4237288577UL, 2899370982UL, 1343346297UL, 1992941345UL,
            2486358087UL, 1458882926UL, 3104184503UL, 1772166441UL, 4040304222UL,
            2575184450UL, 2539025057UL, 4058880215UL, 1844144898UL, 2081179737UL,
             780179577UL, 2937304194UL, 3339697853UL, 3797549795UL, 1765656341UL,
            2453231746UL, 1093786976UL, 3820326505UL, 1309279495UL, 3475439173UL,
            2239854070UL, 1641669977UL, 1074111409UL, 4229776415UL, 2445632577UL,
            2381696443UL, 3971999116UL, 3368473853UL, 2214484098UL, 3200937513UL,
            3488727861UL,   51030215UL, 2022175307UL, 1569834332UL, 3177964915UL,
            1051093116UL, 2423550978UL, 2624908447UL, 3877182066UL, 1143184335UL,
            3083377280UL, 1607090636UL, 1335712863UL, 4176321550UL, 3101248186UL,
             738175440UL,  873588785UL, 3959241421UL, 2457403454UL, 3075458850UL,
            1453556155UL, 3007878954UL, 3566901912UL, 4096404192UL, 3610783821UL,
            2348694477UL, 2913251105UL,  285631840UL, 1460601547UL, 3062114428UL,
            1919191503UL, 2936784144UL,  631755322UL,  494712270UL, 2175057382UL,
            3503836056UL,  681508091UL, 4250949169UL, 2314193825UL,  453239697UL,
            2795143942UL, 4023675650UL, 1744370572UL, 1088360840UL, 2779986192UL,
             885199046UL, 1807303464UL, 1790325254UL,  196315193UL,  318597666UL,
             315274352UL, 4038913294UL, 3989117482UL, 3224884369UL, 1825152543UL,
            3963230526UL, 2240048110UL, 2132329030UL, 2315997864UL, 3015547289UL,
             467010649UL, 3821768224UL, 2878813435UL, 2596309465UL, 1742689955UL,
            1062265029UL, 1808591155UL, 1833247679UL, 3866900109UL, 4068473589UL,
            3972564838UL, 3381863987UL, 2322112988UL, 3986871350UL, 2075664387UL,
            1998863215UL, 3673088649UL, 1502467362UL, 3599954507UL, 3897040992UL,
            3940877136UL, 3467980809UL, 2250373232UL,  442582284UL, 3360517568UL,
            3648406506UL, 3348749078UL, 2819110150UL, 1227224748UL, 2024523259UL,
            1041332325UL, 2479402472UL, 1119467221UL, 3310171390UL, 2391400394UL,
             463751984UL, 1505368385UL, 2955430825UL,  515399378UL, 2563370043UL,
            2425369464UL, 2816833505UL, 3561445428UL, 2203004970UL,  465263254UL,
             168098309UL, 3684101223UL, 4052226269UL, 1610669110UL, 2138714201UL,
             737469404UL,  231439360UL, 3757258226UL, 3719836631UL, 1573415501UL,
            1302418576UL, 3144671290UL, 3006711121UL, 2228080897UL, 2329206088UL,
            3153167084UL, 2370023948UL, 3235827454UL, 2560232745UL, 1065410209UL,
            1661425899UL, 2659284686UL, 1476106894UL, 4102667796UL, 1583341668UL,
             439718779UL, 2084624920UL, 1062068117UL, 3874846970UL,  683338096UL,
            2662391944UL, 1176696104UL, 3587947451UL, 4098993357UL, 3140998698UL,
             870759742UL,  623529127UL, 3458807285UL, 3341615957UL,  195614711UL
        };

        private static readonly ulong[] ExpectedULongArray =
        {
            3144719680UL,   30029983UL, 1639299213UL, 3166735680UL, 1400938729UL,
            4210741058UL,  246002107UL, 3003685920UL, 2351192325UL, 3906801022UL,
            1193460972UL, 3763579543UL, 4162818920UL,  904580094UL, 1849642234UL,
            1901989593UL, 4165125265UL,   46885111UL, 2823390370UL, 2815738166UL,
             561799266UL, 2770955911UL, 1923881802UL, 3845637221UL, 1798467732UL,
             344547253UL, 3601501396UL, 3773224527UL,  917423687UL, 3357971917UL,
            3199286984UL, 3690279719UL, 3287812755UL,  952365470UL, 2564671164UL,
            1495959583UL, 2999115668UL, 3035781453UL, 3438806605UL, 2996867561UL,
            1256680977UL, 1243044451UL, 2880983964UL, 2141339503UL, 1929970209UL,
             608137051UL, 3947555859UL, 2165686426UL,  396001878UL, 1107844991UL,
             321962518UL,  857112683UL,  370556188UL,  870856339UL, 2149697617UL,
            3027002906UL, 3549173102UL, 4237590679UL, 1867670778UL, 2163081121UL,
            3871897180UL, 4084266701UL, 2571151456UL, 2055418072UL, 2587651247UL,
             966273727UL, 1267989787UL, 2634498797UL,  759225841UL, 3314091800UL,
             808228151UL, 2670006269UL, 2605397310UL, 3894115828UL, 2422677601UL,
              61360736UL, 1649260700UL, 3654239650UL, 1562454166UL, 3903379985UL,
            2660399003UL, 2093796491UL, 1119669251UL, 1668668967UL, 4261475682UL,
             674987509UL,  620532388UL, 3696522987UL, 2665030851UL,  616272535UL,
            1374885124UL, 3301869655UL, 2409104440UL, 3103496931UL, 2620574036UL,
            2422668638UL, 3956171801UL, 1269467810UL, 1700037334UL, 3960542466UL,
            1480422599UL, 3956660557UL, 1162530189UL, 2214801652UL, 1003865163UL,
            3874988979UL,  688113766UL, 4143778851UL,  418214219UL, 3617135304UL,
            2192368929UL, 1901066402UL, 2417779699UL, 3972928030UL,  457524278UL,
             442363338UL, 2852064881UL, 2947576292UL,  645256600UL, 4202108451UL,
            3881220885UL, 4089887278UL, 1174615302UL, 2532589117UL, 1055602100UL,
            2539633470UL,  685091547UL,  691536395UL, 3708322807UL, 2988469474UL,
            1474335600UL, 2137744081UL,  268413667UL, 1002286150UL, 1297447440UL,
            3985677254UL,  387262515UL, 3059140057UL, 3647155344UL, 1155010538UL,
            1867328360UL, 1996497175UL, 3209124260UL, 3343182567UL, 1427876750UL,
            1861675642UL, 3532532621UL, 4230574926UL, 1696411674UL, 3851885113UL,
            3331871808UL, 3666104246UL, 4034966319UL, 3912741529UL,  270353743UL,
            1762958080UL, 1587509061UL, 3333878387UL, 1186596232UL, 1385994526UL,
            1687539313UL, 1189774485UL, 2289894657UL, 3237546914UL,  339266132UL,
            4005023382UL, 2639203748UL, 2850765900UL, 3771610571UL, 2510386591UL,
            4176103620UL,  491103734UL, 1579508365UL,  859216651UL,   51301705UL,
            2868784560UL, 1646085351UL,  147852393UL, 3069947618UL, 1680665143UL,
            3675186323UL, 1624069081UL, 3949922839UL, 1831953541UL, 3265340292UL,
            1579911334UL, 1028415836UL, 1643889446UL, 2477504391UL, 1222960746UL,
            3628157520UL, 2491108803UL, 2886827672UL, 1591719149UL,  910966226UL,
             206696855UL, 1232863511UL, 1046336830UL, 3492763244UL, 2638328643UL,
             865046446UL, 3919892969UL, 2526175880UL, 2352783718UL, 3049013958UL,
            1684135170UL, 1222913325UL, 1959237404UL, 4213939616UL, 2157700187UL,
            3025882446UL,  649859979UL, 3376849558UL, 2027581591UL, 2296648620UL,
             522256609UL,   77301159UL, 1389557357UL, 1271110848UL, 3524659715UL,
            3231681712UL, 1819219844UL, 1606785669UL,  237949418UL, 2032368535UL,
            2814041873UL, 3733932590UL, 4067183633UL, 2620739551UL,  209969362UL,
            1171745213UL, 2888147249UL, 2567684263UL, 2153608204UL, 2901164391UL,
             817694202UL, 4245986831UL, 1171458278UL, 3967311422UL, 1834638711UL,
            3527289126UL,  351412409UL,  463498358UL, 2985848347UL, 3532523318UL,
            1061370849UL,  459395184UL,  605521249UL, 4244276818UL, 1962754515UL,
            3543828183UL, 1642883023UL,   38359978UL, 3546142271UL, 3521697770UL,
            1651048418UL,  703464199UL,  388839557UL,   80307599UL, 1707917651UL,
             415685988UL, 2195147113UL, 1354838206UL, 3886949455UL, 3589798290UL,
            1167320445UL, 2891457930UL, 2134534480UL, 2522980595UL, 4145554912UL,
            2627925345UL, 2528499356UL, 3249144421UL, 3919003953UL, 4190991986UL,
             101039783UL, 4199723003UL, 1767450914UL, 2236277891UL, 1156414781UL,
            2682841018UL,  541016357UL, 1825670548UL, 1902632843UL, 2416464018UL,
             754779197UL, 2136276021UL, 3221769526UL,  951481804UL,  901790466UL,
            3891874875UL, 2938940829UL, 3360700903UL, 3959205742UL, 3374140478UL,
            1281538380UL, 2438793969UL, 1483519067UL, 2854024950UL, 1423931607UL,
            2548585945UL,  303695785UL, 1844285145UL, 1297594724UL, 1667595664UL,
             389606953UL, 3802773053UL, 1146038930UL, 2820488158UL, 1072045116UL,
            1113139860UL, 1641692939UL,  440523253UL,  999006301UL, 2058451381UL,
            2986048262UL, 2848697730UL, 4025538901UL, 3121812228UL, 3919593423UL,
             871660956UL, 4142693421UL, 1924532205UL, 1910806753UL, 4142166185UL,
            1805437400UL, 3397534300UL, 3474207879UL, 1820711894UL, 2577045152UL,
             959123886UL,  258359259UL, 3709711498UL, 3171585112UL, 2572797226UL,
            3046882963UL,  652271814UL,  468934460UL,   96538515UL, 2973996123UL,
            2892632939UL,  958351664UL, 3565569355UL, 2202783744UL, 3443598377UL,
            2717573199UL, 1181967787UL, 2173524557UL, 3199081837UL, 2020471519UL,
            3832996797UL, 2030799564UL, 3503174144UL,  652954350UL, 3962776284UL,
            1076549635UL, 3506864427UL, 1041825853UL, 3043389907UL,  142653815UL,
            1752985848UL,  686442632UL, 2481933400UL, 1224413696UL,  656115965UL,
            2179277550UL, 3347068558UL, 3200335804UL,   95784608UL, 2123354752UL,
               3826895UL, 1980440317UL, 3782207482UL,  325002378UL,  503279840UL,
            4017640480UL, 3209374094UL, 3318682318UL,  914241560UL, 2819813870UL,
            1966587440UL, 2926163888UL, 4261765845UL,  876498326UL, 1743029339UL,
             338255889UL,  935975124UL,  618637085UL, 4059808827UL, 3456158813UL,
            4284617661UL, 1907738501UL, 4145260845UL, 2912421610UL, 1148182757UL,
            2881547907UL,   17718610UL, 2102520006UL, 3405289251UL, 2906309675UL,
            3972745075UL, 2764035676UL,  701837719UL, 1223337859UL, 1049726310UL,
             594069713UL, 1612594198UL,  305255906UL, 4075538851UL,  958502860UL,
            2800289791UL, 1571417281UL, 1574451143UL, 2321880886UL, 2292191315UL,
            2885970749UL, 4179590121UL,  419384867UL, 1946896394UL, 1429519827UL,
            4188461808UL,  921159472UL, 3910810348UL, 2631172194UL, 3991107392UL,
            4212958658UL, 3661845694UL, 1810935406UL, 1552580826UL, 3827604589UL,
             386816439UL, 4215574765UL, 3617994114UL, 2667106555UL, 3673562907UL,
             906995995UL, 4281941699UL, 1353236717UL, 1446819412UL,  935183602UL,
            3123999498UL, 3983298597UL, 2424575982UL, 1477602810UL, 4242674259UL,
            2561947795UL, 2833345810UL, 4163717626UL, 1143441479UL,  628118799UL,
            3700731631UL, 4147940486UL, 2443786276UL, 2015336223UL, 1980707931UL,
            1818883750UL, 1269942655UL, 1852032933UL, 3703715862UL, 1309659054UL,
            1504157621UL, 2820261949UL, 4177937525UL, 3118195115UL, 3112736380UL,
            1735650650UL, 2726291279UL, 1694032167UL, 2249046111UL,  923047627UL,
            2796140914UL, 2629729807UL, 3186393319UL, 3816651765UL,  372407459UL,
            1356864623UL, 1730654047UL, 3892306369UL, 2536303278UL, 3261317705UL,
            2486306856UL, 3022927993UL, 1936641018UL, 3828188998UL,  118352853UL,
            2266829002UL,  960449808UL, 2455502458UL, 3298616402UL, 2590956680UL,
            1420018659UL, 2426044457UL, 3017493145UL,  610258543UL, 2469700828UL,
            1231780549UL, 3615477667UL, 1916854829UL, 2517813987UL, 1331780247UL,
            3348151466UL,  147542513UL, 2405809570UL, 1765153938UL, 3182778444UL,
             259201548UL, 1442082832UL, 3747126177UL, 4119855713UL, 2386038469UL,
            2035051985UL, 1468713739UL, 2547395440UL, 3821564001UL, 3656057708UL,
             310120432UL, 2232617797UL, 2133355795UL, 1561106113UL, 2834330127UL,
            1587799889UL, 1355584811UL,  173747358UL, 1504279745UL,  396921482UL,
             266992237UL,  384650968UL, 3783139334UL, 2157166362UL, 1088894635UL,
            2879379028UL, 1130039443UL, 1817903660UL, 3640122600UL, 1212071933UL,
             620197482UL, 2403911896UL, 2726302551UL, 3071573989UL,  798580146UL,
             557392967UL, 1426844153UL, 2560135628UL, 3476227407UL,  640561173UL,
             887778035UL,  415957595UL, 2557387138UL,  968133999UL, 2209113245UL,
            3862017710UL, 2944235995UL,  979407776UL, 3855454771UL,  798037118UL,
             100165520UL,  163402313UL, 2714880079UL, 2082834782UL, 4121784969UL,
            4252537031UL, 3443235140UL,  671552018UL, 2653133751UL, 2694948841UL,
            4021825370UL, 3132660095UL, 4247624206UL, 3526649267UL, 1528342325UL,
            4174276241UL, 4262899606UL,  567350054UL, 2176875325UL, 3621464582UL,
             588539913UL, 2782667956UL,  838099590UL, 1714431578UL, 3344101223UL,
            2102810848UL, 2710144265UL,  231164735UL, 2768215950UL,  129713106UL,
            1571305822UL,  221673401UL, 2452989275UL, 2230326562UL, 2808690281UL,
            1737118910UL, 1881131613UL,  214085183UL, 2526335860UL, 2823612301UL,
            2690582866UL, 2790815750UL, 3340434836UL, 2618480083UL, 3584998106UL,
            2721482385UL, 3345525484UL, 3410513857UL, 3423684362UL, 2492843219UL,
            2927649361UL, 3531307689UL, 3944970788UL,  227540032UL, 4046548408UL,
            2088857909UL, 1740207976UL, 2947446314UL, 2679625992UL, 2924438726UL,
            1159570367UL,   19251160UL,  663031330UL, 2563227426UL, 3948040935UL,
            2120519577UL, 2625608081UL, 2514080103UL, 1205665288UL,   19636779UL,
            3268108625UL, 3565154138UL,  257175509UL,  812503520UL,  410647501UL,
             763020667UL,  610348186UL, 1535968199UL, 2004983220UL, 3539825721UL,
            3679630091UL, 3615182985UL, 3318919881UL, 1018623859UL, 1256930437UL,
            3594745358UL, 3988536074UL, 2183407559UL,  236513610UL, 2325113418UL,
            4006439010UL, 3009107067UL, 2135968082UL,  562007763UL, 1165820690UL,
            3119494966UL, 3746632150UL, 1050624005UL, 1269927618UL,  551872993UL,
            3582740718UL, 2888140354UL, 3027769014UL, 2758265458UL, 3807194847UL,
            2188931814UL, 2659875829UL, 1368107467UL,  464474838UL, 3913461513UL,
            2855681718UL, 1900424431UL, 1769240030UL, 2008986982UL, 3871311883UL,
             980699038UL, 3607973150UL, 2288691464UL,    1808488UL, 1682547987UL,
            3074273594UL, 1133663078UL, 1931018299UL, 2661580815UL, 1140462012UL,
            1957362395UL, 3609661081UL, 3268354866UL, 1368288147UL, 3897560558UL,
            1461820281UL, 1185500055UL,   78687382UL, 3588020250UL, 1321581273UL,
            2475193153UL, 3751983290UL, 2691085119UL, 2806830388UL, 1100332428UL,
            1548094489UL, 1860632827UL, 3779340584UL, 4265701571UL, 1004376368UL,
            1825621448UL, 2784866856UL, 3423801310UL, 3464900662UL, 3540350033UL,
            2684638642UL, 1737581863UL,  183379540UL,  562923875UL, 1693223542UL,
            2541805029UL, 2476523181UL, 1784191994UL,  635508831UL,  433074773UL,
            3781577835UL, 2953746522UL,   17006794UL, 3577479716UL, 1311803263UL,
            3225173327UL, 1845612899UL,  731077191UL, 3046074794UL, 2188496307UL,
            1342808812UL, 1870707926UL,  380540872UL, 2171327453UL, 2573239143UL,
            2349506741UL, 2975940384UL, 2305067296UL, 3636388743UL,  324658310UL,
            1300229029UL, 2252212549UL,  881254430UL,  857229559UL, 1117505715UL,
              19579757UL, 3742835097UL, 2855362701UL, 2649009396UL, 3777789611UL,
            3775887498UL, 2615878665UL, 3989461915UL, 3112931720UL,  588669263UL,
            3988437882UL, 1696270640UL, 3706868539UL, 4152073359UL, 1237827524UL,
            2517318579UL, 1786727542UL, 3961783276UL,  565553503UL, 1803741892UL,
            3780755523UL, 1363947408UL, 3822204919UL,  699974423UL,  682009960UL,
            3423435931UL, 2866810758UL,   41850517UL,  893895054UL, 3018602157UL,
            3493668917UL, 1353407377UL,  780793825UL, 1794319410UL,  208925743UL,
            2518462565UL, 3266048009UL, 3049904051UL, 3289535185UL, 1728090357UL,
             489789879UL,  536162157UL, 3855935039UL, 2319977628UL, 1270547464UL,
            1856958366UL,  180417565UL, 3823691258UL, 4069443304UL, 1158468785UL,
            3496276671UL, 1375629330UL, 1420359495UL, 3534323192UL, 3518641308UL,
            3088081400UL, 4177706954UL,  142203802UL, 1500479829UL, 3071828052UL,
            3937008042UL, 3159294759UL, 1928539406UL, 3497398090UL, 3131385618UL,
             714257583UL, 1908058862UL, 1210128114UL, 2769829276UL,  416794343UL,
             906251214UL, 1812221600UL, 1864859005UL,  286018696UL,  835940589UL,
             243776200UL, 3283782188UL, 1085959747UL, 1360849031UL, 4051519297UL,
            3973393227UL, 2856184934UL, 3653467683UL, 1151630693UL,  812621116UL,
            1836437797UL, 1034350259UL, 1953133959UL, 2682963557UL, 1676756942UL,
            2278617242UL, 1196786223UL, 2879466866UL, 2428007574UL,  867714070UL,
            2182593716UL,  679287813UL, 4280972432UL, 1146540733UL, 2574999339UL,
              34618034UL, 3989827742UL, 3460711046UL,   11081671UL, 3852518119UL,
            2777273098UL, 1178437350UL,  908635549UL, 3789723034UL, 1674052873UL,
             659808851UL,  165384074UL, 2389366854UL,  623395229UL, 3134350242UL,
            3155177669UL, 1044113334UL, 2605677172UL, 1553889457UL, 2369539546UL,
            3711282320UL, 1034165926UL, 3062249868UL, 3240212555UL, 3975219765UL,
             974239058UL, 2076185634UL, 1788997082UL,  200099441UL, 1378069477UL,
            3732520531UL, 3252180121UL,  624145932UL, 2403366224UL, 2819058868UL,
              43855081UL, 1318751958UL, 1088256690UL,  850968167UL,  241089873UL,
            2587970839UL, 2866027237UL,  708534783UL, 2191634836UL, 2488088535UL,
            2898606441UL, 3118269454UL,  127018438UL,  628453232UL, 3487986736UL,
            4201665671UL, 2698882191UL,  733824847UL,  946623213UL, 2127515135UL,
            2258651197UL, 1418611171UL,  209261003UL, 2114586351UL, 1598285361UL,
            3580611092UL, 3822063319UL, 1555259591UL,  598461514UL, 2511002387UL,
            3022928890UL, 3186332559UL, 4155589357UL, 1586371441UL, 3356171644UL,
            3245224962UL, 4116405901UL,  840206674UL, 1108636423UL, 3262819804UL,
            1562880111UL, 1928937926UL, 3077156964UL, 2607571992UL, 1564305796UL,
             147941660UL, 4107063317UL,  943950762UL, 2631608628UL, 3464706327UL,
            2422748629UL, 3013551845UL, 3855122996UL, 3704215111UL, 3586700100UL,
            3290023613UL, 2734212792UL, 2375798578UL, 3796535460UL,  938429367UL,
            3609129419UL,  556225257UL, 3544288405UL, 1488710320UL, 1196934756UL,
            3606668976UL, 2809743844UL, 1034641770UL,  681187514UL, 3059881558UL,
             895484537UL, 3248582540UL, 1522555790UL, 2215032888UL, 3763073051UL,
            1237818225UL, 2392667754UL, 1704752819UL, 1989008103UL, 1110700303UL,
            2416781264UL, 1929525334UL, 3392556873UL, 2270668644UL, 2835987911UL,
            1959704977UL, 1479984555UL, 1669541868UL, 2448139361UL,  364298562UL,
             412566471UL,  143175275UL,   84786299UL, 2115007720UL, 2258889800UL,
            1614438832UL, 4248452727UL, 3671350612UL, 1065619905UL, 2601845713UL,
            2075017753UL, 2659924946UL, 2771323989UL, 1031907666UL, 1447484496UL,
            3427774382UL, 1959810889UL, 4167798514UL, 1287533728UL,  232072677UL,
            3192646933UL, 2623994184UL, 3747530834UL, 3992551011UL, 1153547871UL,
            2650034770UL,  581442184UL, 1012736926UL, 2255458706UL, 3099952298UL,
            2441904759UL,  141653443UL,  661979435UL, 2242682681UL, 1006984333UL
        };

        /// <summary>
        /// Taken from http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/index.html,
        /// <para />
        /// SFMT-src-1.3.3.zip, SFMT.2281.out.txt.
        /// </summary>
        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_NextUInt_ReferenceImplementationTest()
        {
            // int ulongLength = ExpectedULong.Length;
            const int ulongLength = 100;
            var gen = new MersenneTwisterSfmt2281UniformRandom(1234);
            for (int i = 0; i < ulongLength; ++i)
            {
                ulong expected = ExpectedULong[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation uint: index={i}, actual={actual} expected={expected}"));
            }

            // int ulongArrayLength = ExpectedULongArray.Length;
            const int ulongArrayLength = 100;
            gen = new MersenneTwisterSfmt2281UniformRandom(new[] { 0x1234, 0x5678, 0x9abc, 0xdef0 });
            for (int i = 0; i < ulongArrayLength; ++i)
            {
                ulong expected = ExpectedULongArray[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation array: index={i}, actual={actual} expected={expected}"));
            }
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_NextDouble_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt2281UniformRandom(Seed);
            double expected = 0.5;

            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 4;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 6;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(4, 8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_NextInt_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt2281UniformRandom(Seed);

            double expected = int.MaxValue / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 400d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 600d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(400, 800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_NextBoolean_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt2281UniformRandom(Seed);

            double expected = Count / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextBoolean() ? 1 : 0;
            }

            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_NextBytes_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt2281UniformRandom(Seed);

            double expected = 128;
            double actual = 0;
            var array = new byte[32];

            for (int i = 0; i < Count; ++i)
            {
                gen.NextBytes(array);
                actual = array.Aggregate(actual, (current, b) => current + b);
            }

            actual /= Count * 32;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_Seed_SameSeed_SameValue()
        {
            var gen1 = new MersenneTwisterSfmt2281UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt2281UniformRandom(Seed);
            int actual = gen2.NextInt();

            Assert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_Seed_DifferentSeed_DifferentValue()
        {
            var gen1 = new MersenneTwisterSfmt2281UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt2281UniformRandom(Seed + 1);
            int actual = gen2.NextInt();

            Assert.AreNotEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_CanReset_ReturnsTrue()
        {
            var gen = new MersenneTwisterSfmt2281UniformRandom();

            Assert.IsTrue(gen.CanReset);
        }

        [TestMethod]
        public void MersenneTwisterSfmt2281UniformRandom_Reset_ValueGeneratedThenReset_SameValueGenerated()
        {
            var gen = new MersenneTwisterSfmt2281UniformRandom();
            int expected = gen.NextInt();

            gen.Reset();
            int actual = gen.NextInt();

            Assert.AreEqual(expected, actual);
        }
    }
}
