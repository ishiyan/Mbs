using System.Linq;
using Mbs.Numerics.RandomGenerators.MersenneTwister;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators.MersenneTwister
{
    [TestClass]
    public class MersenneTwisterSfmt4253UniformRandomTests
    {
        private const int Seed = 12345;
        private const int Count = 5000;

        private static readonly ulong[] ExpectedULong =
        {
            2527479900UL, 1368357778UL, 2663671614UL, 1404435254UL, 2699472814UL,
            90613554UL, 184715818UL, 548052880UL, 3165295246UL, 3747208322UL,
            1553584151UL, 4006205422UL, 686873885UL, 2973265227UL, 338288274UL,
            840903586UL, 118479351UL, 2113933085UL, 2454705318UL, 4160313692UL,
            258320158UL, 2069535581UL, 3111482672UL, 1808812962UL, 1061444454UL,
            3414467438UL, 2429935983UL, 22860572UL, 1366710514UL, 3914109077UL,
            431345992UL, 2592701388UL, 4278051019UL, 2953043318UL, 3980401588UL,
            3881325187UL, 1564504370UL, 834859481UL, 3060669055UL, 1337040117UL,
            550209132UL, 3820737668UL, 730655732UL, 2134953975UL, 3660203170UL,
            3949145665UL, 3089869106UL, 2462203695UL, 2517266551UL, 127768183UL,
            1458427300UL, 968958252UL, 4160350980UL, 197127760UL, 1732124944UL,
            94014226UL, 1531549192UL, 113002317UL, 677141155UL, 287564565UL,
            4257548747UL, 4292783614UL, 2751209905UL, 1752328661UL, 3243295598UL,
            923465190UL, 2894924894UL, 2740856471UL, 4055981426UL, 473191365UL,
            908700607UL, 422974067UL, 469692967UL, 757624668UL, 3432965499UL,
            1831360524UL, 1428429851UL, 2483671900UL, 1390761012UL, 3810347628UL,
            629385285UL, 3930097219UL, 2052308184UL, 4168023275UL, 388853205UL,
            3768997406UL, 3330670734UL, 2055104098UL, 1106186192UL, 1933427225UL,
            2226099390UL, 3454131780UL, 2957350718UL, 3823231548UL, 1817256940UL,
            4215997696UL, 871018468UL, 3167946875UL, 2754001419UL, 236180895UL,
            3233859043UL, 2373649380UL, 1292426575UL, 3607842917UL, 2701992479UL,
            148610584UL, 3264599936UL, 1393846909UL, 2499792154UL, 736433790UL,
            3157082272UL, 2880794545UL, 994805876UL, 534093287UL, 197116649UL,
            851477442UL, 2146732429UL, 2183911085UL, 894942183UL, 832710978UL,
            3901770969UL, 3359969465UL, 882420449UL, 2241823448UL, 1492166544UL,
            3992403187UL, 597213559UL, 1969755128UL, 426287380UL, 4061611377UL,
            1687362889UL, 1946092277UL, 4125751232UL, 2340826817UL, 1023094896UL,
            2453795243UL, 1016397383UL, 2066650694UL, 2829818145UL, 4240397962UL,
            1677661629UL, 2003846114UL, 809330389UL, 3806142170UL, 201244744UL,
            2566284206UL, 571778809UL, 3414471796UL, 1048918104UL, 1729550124UL,
            2292438588UL, 1801879825UL, 595036908UL, 4103514229UL, 3405015679UL,
            529495538UL, 3896500793UL, 2584783745UL, 2054273460UL, 3846917154UL,
            751616450UL, 2298779837UL, 744937613UL, 2655442675UL, 3129294927UL,
            2616177535UL, 109487464UL, 2084297522UL, 3149948545UL, 146626839UL,
            141416550UL, 219840792UL, 198827062UL, 180973611UL, 1821886528UL,
            4017582600UL, 1052759440UL, 1015031793UL, 991373390UL, 508903622UL,
            2182588526UL, 3077049840UL, 521761680UL, 1545070310UL, 3957281201UL,
            171128523UL, 1147783672UL, 2533170216UL, 3838957621UL, 1237736619UL,
            552147257UL, 1556527506UL, 1515560982UL, 2308626297UL, 3482690030UL,
            2879183618UL, 2457518673UL, 1850653525UL, 3553910637UL, 2860551374UL,
            3434228513UL, 1731298733UL, 3588698536UL, 806858307UL, 3613883468UL,
            523208067UL, 3414202318UL, 3393689440UL, 2353240359UL, 4127122117UL,
            1831732142UL, 847638871UL, 1619828199UL, 2124696779UL, 3990800766UL,
            3933888641UL, 3182339244UL, 3360495242UL, 3916631449UL, 2657507170UL,
            3148012381UL, 1372045589UL, 409909367UL, 1928161391UL, 2430406320UL,
            3344152345UL, 3461790387UL, 2879089167UL, 187732582UL, 97521756UL,
            4177685510UL, 300969389UL, 3888421994UL, 3639345081UL, 1296034375UL,
            3343230691UL, 2614990524UL, 201084198UL, 1280068382UL, 2992697415UL,
            2115717691UL, 1189674758UL, 87443442UL, 1108849849UL, 3999298855UL,
            551654632UL, 2843181712UL, 1438915708UL, 634243182UL, 2011185720UL,
            608579410UL, 897151476UL, 3827358299UL, 441056267UL, 3958241396UL,
            2377342291UL, 3825269665UL, 520209674UL, 3742883636UL, 3483477678UL,
            429112330UL, 1063433049UL, 460156961UL, 1983998260UL, 3131916395UL,
            3825314043UL, 1541860318UL, 505894702UL, 1118748714UL, 2750017164UL,
            1318839272UL, 2705734886UL, 1348131583UL, 1671597785UL, 327049114UL,
            2349038687UL, 3191898447UL, 65778986UL, 309294146UL, 4210524532UL,
            954190761UL, 2796234546UL, 760913068UL, 1495807915UL, 719879568UL,
            1098025642UL, 2507498292UL, 1989256114UL, 3199663249UL, 1687943539UL,
            2797834855UL, 2875620767UL, 3049687385UL, 675610541UL, 2679231804UL,
            1993787755UL, 103928858UL, 270737000UL, 2250936910UL, 1319674681UL,
            3533390078UL, 2940559205UL, 3485860854UL, 1971895540UL, 494103928UL,
            229873064UL, 1674251374UL, 3656511507UL, 1613711330UL, 1864093473UL,
            3380224706UL, 2579813873UL, 1443886615UL, 553363027UL, 321798783UL,
            343406389UL, 3588518585UL, 2027235001UL, 3491435871UL, 944912015UL,
            1291890419UL, 763467230UL, 1301595200UL, 35530017UL, 1654917296UL,
            2369528163UL, 43914463UL, 3385342605UL, 1519096256UL, 1160702704UL,
            918487363UL, 2675524986UL, 2527817177UL, 1370542519UL, 2651742660UL,
            2103037069UL, 1397939248UL, 264689110UL, 1413288205UL, 4004778218UL,
            3299683988UL, 2841441176UL, 3598691083UL, 2182457567UL, 4054937081UL,
            1066677974UL, 434982562UL, 1000338728UL, 2872338526UL, 3178007830UL,
            112950674UL, 3265963247UL, 1078618426UL, 4136037652UL, 1802343389UL,
            3054995837UL, 2634801100UL, 3576860529UL, 2756572027UL, 163670376UL,
            2755164619UL, 3193086267UL, 3523741517UL, 2787825626UL, 3599211537UL,
            3179624644UL, 3877008080UL, 2628341823UL, 3637377170UL, 4088700641UL,
            2241341851UL, 2170453568UL, 193416186UL, 3372714382UL, 2794968447UL,
            935329275UL, 996794956UL, 2916776696UL, 613865948UL, 2342638185UL,
            620153472UL, 293440707UL, 3098925541UL, 3075946626UL, 3105163113UL,
            2278427178UL, 2512248278UL, 3302195243UL, 1901360844UL, 341805416UL,
            1498812479UL, 1022193034UL, 2730690487UL, 1608087974UL, 3769133791UL,
            3085978560UL, 2569008479UL, 4163889308UL, 1373206796UL, 2318025416UL,
            3851861687UL, 3012946747UL, 3977347475UL, 364722855UL, 2611302503UL,
            4115709997UL, 78751760UL, 1281200331UL, 907864348UL, 1360886565UL,
            1264593706UL, 2195635559UL, 1140394436UL, 1250223897UL, 76307824UL,
            3678248796UL, 1596987024UL, 1463275883UL, 3347064538UL, 2245531442UL,
            3000401995UL, 1424992573UL, 3512991755UL, 2510621610UL, 1721715256UL,
            3075463170UL, 1466887879UL, 1999485116UL, 3962926634UL, 3870497011UL,
            1751227678UL, 705057364UL, 1443520104UL, 2059482087UL, 3250691665UL,
            3255166375UL, 1569067129UL, 3412844722UL, 3098977431UL, 2792159953UL,
            2395673009UL, 3857642389UL, 1178307671UL, 2243727662UL, 3864522806UL,
            3675533812UL, 2816048058UL, 1312820066UL, 3479095187UL, 2480595183UL,
            2835049824UL, 3561740422UL, 3174217287UL, 416749385UL, 2139285735UL,
            3821231700UL, 3329469401UL, 3091148385UL, 3510293280UL, 4191591727UL,
            868224009UL, 2963941189UL, 4197718379UL, 3532559426UL, 1904090497UL,
            1054636757UL, 813484583UL, 2750528848UL, 2712557992UL, 652666704UL,
            1883222671UL, 4050435510UL, 1330436237UL, 2596765439UL, 300221336UL,
            2181019682UL, 2979671327UL, 2514204653UL, 649224002UL, 342470286UL,
            1851796018UL, 1300049431UL, 580587812UL, 1304252851UL, 3522677854UL,
            1923755784UL, 556752185UL, 1914802797UL, 3654065680UL, 2752469800UL,
            1726881082UL, 2250771284UL, 2135743124UL, 1830931411UL, 1469151786UL,
            2104783727UL, 478155961UL, 1789588437UL, 739862484UL, 3135185315UL,
            3386692983UL, 796221342UL, 3824201775UL, 774903840UL, 2539841190UL,
            1798701707UL, 3156002374UL, 1557540949UL, 2038233868UL, 3369775005UL,
            1967992094UL, 2352432999UL, 1754555210UL, 3383598210UL, 912042820UL,
            1556344175UL, 2063567860UL, 3141410825UL, 3725100803UL, 935008972UL,
            2420154214UL, 229384961UL, 932794923UL, 3121147627UL, 3677397520UL,
            2030936421UL, 3783938574UL, 1056242163UL, 1094152240UL, 3130795881UL,
            2212578528UL, 3650393830UL, 3763562182UL, 2941501937UL, 891356726UL,
            3480329562UL, 2001363572UL, 3650716087UL, 2039712773UL, 2082265319UL,
            3897556400UL, 2306486314UL, 794776544UL, 2658262370UL, 1205963556UL,
            1244950749UL, 4068472397UL, 2316768749UL, 570442349UL, 597720630UL,
            2389394507UL, 3094855718UL, 2509408387UL, 3458849306UL, 4003913153UL,
            1606513088UL, 3682030133UL, 1351428839UL, 1329052705UL, 756713129UL,
            3228203269UL, 2549330089UL, 1003597149UL, 815801656UL, 2935040849UL,
            2126394226UL, 1966835343UL, 2123147961UL, 1100473787UL, 3508260126UL,
            1347682278UL, 1813807731UL, 4087504287UL, 4274225369UL, 1233072466UL,
            3982558179UL, 2182729378UL, 3788359817UL, 455938583UL, 107595104UL,
            2183482541UL, 349724043UL, 3170305794UL, 1478463324UL, 3535450698UL,
            2266873512UL, 1125200363UL, 1782202842UL, 562451765UL, 659545839UL,
            3205089880UL, 1007748157UL, 1332259119UL, 2190756187UL, 2498360841UL,
            1821141260UL, 2384457148UL, 3597604326UL, 2466625944UL, 3444958869UL,
            2393658085UL, 3021642990UL, 3653781223UL, 988709427UL, 3343088257UL,
            2542070759UL, 3030195976UL, 3201593233UL, 1146775076UL, 91189100UL,
            937553383UL, 2253494027UL, 2923147891UL, 2964305654UL, 3687677728UL,
            215864044UL, 1165902544UL, 3094419018UL, 1084293644UL, 3755627654UL,
            4240346365UL, 2634668923UL, 3266634895UL, 459317309UL, 2448760566UL,
            285022386UL, 1188948452UL, 2910236783UL, 2785682666UL, 1232664118UL,
            1696483321UL, 260914322UL, 1643952881UL, 1205118871UL, 625088862UL,
            2895045934UL, 2361165720UL, 3685846715UL, 342173372UL, 1277134079UL,
            436664487UL, 3913210554UL, 3853335638UL, 3294636303UL, 897284118UL,
            80550011UL, 35785936UL, 734063644UL, 3331155243UL, 3040972843UL,
            2825628859UL, 1587205482UL, 2916119016UL, 1453645622UL, 29066455UL,
            3674104445UL, 3856300201UL, 3910466588UL, 2305622298UL, 2500902145UL,
            1471525683UL, 1665091699UL, 122696731UL, 438232290UL, 1485481363UL,
            3134096607UL, 582664744UL, 36553553UL, 2555071952UL, 2875800128UL,
            3558076452UL, 2341670027UL, 1048189476UL, 3448631571UL, 3105098020UL,
            2836116166UL, 1164096049UL, 3336285606UL, 1777820482UL, 3259731819UL,
            2535236186UL, 2173206310UL, 2141664756UL, 1795309580UL, 2712514906UL,
            839414197UL, 3515333131UL, 3456768398UL, 894724664UL, 152591334UL,
            3828470515UL, 101544558UL, 3139903673UL, 1758740316UL, 3655835928UL,
            283689183UL, 1191066662UL, 1645801598UL, 2513632659UL, 2641101384UL,
            3242370052UL, 3750378668UL, 1209952866UL, 3622825606UL, 3916290440UL,
            2462296242UL, 3979411843UL, 2566629928UL, 1703841226UL, 3580800515UL,
            2835163070UL, 800968534UL, 4126472075UL, 1336809651UL, 1698066670UL,
            2583945033UL, 3719656938UL, 4161420199UL, 333983592UL, 3012713349UL,
            2215029854UL, 3459379580UL, 3989216021UL, 3909381318UL, 3299172785UL,
            377164461UL, 2190647378UL, 3773598435UL, 1082059749UL, 688217589UL,
            3202128248UL, 1309168765UL, 2186797462UL, 893982067UL, 3808151150UL,
            3750218766UL, 3488505749UL, 2160698729UL, 175659562UL, 366321575UL,
            244537428UL, 709975671UL, 2243085387UL, 2437312200UL, 4072237343UL,
            2793242070UL, 895851642UL, 987225785UL, 1918724975UL, 2286944600UL,
            426287935UL, 987266265UL, 1518170331UL, 2787455281UL, 1808098392UL,
            3384283435UL, 396002370UL, 3092824209UL, 3925958672UL, 1766217507UL,
            283368391UL, 3162646348UL, 2985035730UL, 2837362361UL, 2168498198UL,
            1429383440UL, 632822315UL, 3899799712UL, 1362373986UL, 3513820808UL,
            2093651918UL, 2842493476UL, 4157113475UL, 684687567UL, 2908504190UL,
            1879244483UL, 3704911505UL, 342871386UL, 1801214563UL, 1217345650UL,
            3918483325UL, 1656942815UL, 1165618293UL, 1833497946UL, 3890213046UL,
            2613428343UL, 1994103566UL, 2428507209UL, 2820676607UL, 2180335657UL,
            1346479967UL, 1639143184UL, 4139533466UL, 1909445436UL, 3639600424UL,
            4126977421UL, 2181979647UL, 811910263UL, 365549549UL, 3705120026UL,
            808002836UL, 455149150UL, 1807086335UL, 2130995526UL, 4108275506UL,
            1266847062UL, 4061326824UL, 2349396929UL, 3915985329UL, 1783849271UL,
            905837971UL, 2683630735UL, 1800744620UL, 3875631925UL, 2252142673UL,
            3251456840UL, 1459039165UL, 2833099474UL, 3531992522UL, 3710388286UL,
            2190951573UL, 3354562341UL, 3268151049UL, 1184967222UL, 4195586075UL,
            684446072UL, 2608178903UL, 2819665960UL, 3088369994UL, 2748683558UL,
            1704439164UL, 4223437573UL, 1436190950UL, 4278853819UL, 3091164007UL,
            1078378076UL, 723311767UL, 587703477UL, 3851946555UL, 3697804869UL,
            4160379401UL, 2106953594UL, 593626618UL, 128041410UL, 4286706683UL,
            2003531224UL, 1330231761UL, 2384455624UL, 1159174223UL, 1183759240UL,
            218042236UL, 3850479175UL, 897884664UL, 2599517199UL, 3299195163UL,
            1142309209UL, 339715569UL, 1115023699UL, 4248957598UL, 4175318311UL,
            814230681UL, 3810578707UL, 1621592119UL, 3753479739UL, 2769366523UL,
            2739541076UL, 3336778504UL, 2762821764UL, 425111024UL, 248054828UL,
            302670898UL, 1344961520UL, 2877121830UL, 60326824UL, 3038819906UL,
            2130084958UL, 3806365850UL, 1934968383UL, 2737798910UL, 2477223327UL,
            1787404583UL, 4215091681UL, 3785408410UL, 889455514UL, 42797744UL,
            962836281UL, 393066514UL, 3660403389UL, 1818627315UL, 1810946116UL,
            3051684939UL, 1522629715UL, 2052877416UL, 1991288115UL, 317781593UL,
            3953883323UL, 1889817433UL, 666448014UL, 1795497776UL, 1035321190UL,
            3341408107UL, 938679669UL, 3586178906UL, 1816245957UL, 2643186312UL,
            1189583008UL, 626879504UL, 2847556591UL, 1667291872UL, 931370811UL,
            4119804642UL, 1282359131UL, 121925540UL, 414885461UL, 1990063976UL,
            867354577UL, 2817097111UL, 668512758UL, 301590583UL, 1495974696UL,
            3023244186UL, 675868526UL, 4291773200UL, 1659882362UL, 3340006089UL,
            3053343330UL, 135103191UL, 1693243673UL, 146669000UL, 2312300071UL,
            1615088906UL, 2568797318UL, 861836502UL, 3760445871UL, 356249917UL,
            3258909047UL, 1935024562UL, 2856523904UL, 1272143201UL, 1814325026UL,
            2664552812UL, 2095630716UL, 1099988794UL, 4142196794UL, 2544506753UL,
            3485384650UL, 430826333UL, 3924498758UL, 983842871UL, 559469780UL,
            3046537394UL, 2558191397UL, 1748641471UL, 1703543157UL, 2592035313UL,
            2251132756UL, 2856434124UL, 2430276451UL, 872764094UL, 317121707UL,
            5966309UL, 614613705UL, 2441932614UL, 4081181581UL, 1363577429UL,
            3826195148UL, 2914574007UL, 2140015550UL, 2722653761UL, 530702262UL,
            3776839949UL, 3174244398UL, 2662996664UL, 1756025237UL, 3550819102UL,
            3080894760UL, 281074394UL, 4231680860UL, 1586364407UL, 885384955UL,
            1179007550UL, 931623610UL, 3518953087UL, 4271433909UL, 2889139566UL,
            338082013UL, 1870466325UL, 4025577775UL, 1558936021UL, 2570741014UL,
            90342133UL, 1083987943UL, 1785481425UL, 1921212667UL, 3164342992UL,
            1489324569UL, 603530523UL, 952851722UL, 2380944844UL, 3335854133UL,
        };

        private static readonly ulong[] ExpectedULongArray =
        {
            1062977953UL, 3988658264UL, 3431706209UL, 1392605999UL, 4228283283UL,
            2176715587UL, 1174527495UL, 1437388515UL, 1427996751UL, 695075490UL,
            1301589112UL, 2690299642UL, 2598744544UL, 4174173975UL, 3840835486UL,
            649977762UL, 3847428333UL, 3934078688UL, 4132816682UL, 556148516UL,
            2851104082UL, 3954729007UL, 3097254441UL, 860119530UL, 607379520UL,
            3718940465UL, 2709081067UL, 813237911UL, 2924835801UL, 2963392311UL,
            3680758495UL, 1577302373UL, 3824698389UL, 2815029755UL, 3735459688UL,
            1049070169UL, 362381609UL, 2957904656UL, 372615294UL, 3089059009UL,
            2922792390UL, 850518085UL, 1949211416UL, 2774780728UL, 958090172UL,
            1402882513UL, 884435661UL, 2707170196UL, 4040686310UL, 3303235824UL,
            531013120UL, 1120643530UL, 3743098775UL, 2782106294UL, 1873189429UL,
            3925566315UL, 3963388587UL, 1020947340UL, 3331747991UL, 965762908UL,
            1951956255UL, 3746908851UL, 3237005575UL, 3521733560UL, 2020343472UL,
            3519323690UL, 3283214119UL, 732274313UL, 3583292148UL, 1482011760UL,
            571098358UL, 1348921825UL, 3758785517UL, 3183635786UL, 4174957504UL,
            87235097UL, 2463718310UL, 3219991336UL, 4058881618UL, 3157574682UL,
            2461829889UL, 3221549242UL, 1503840346UL, 3271995478UL, 1186014072UL,
            2999824180UL, 3608855116UL, 3164700504UL, 490219523UL, 61835442UL,
            2852281519UL, 2016590083UL, 985075993UL, 4116522450UL, 2631194335UL,
            3859050228UL, 3316723388UL, 380634589UL, 1221404336UL, 1067167387UL,
            689027224UL, 4266641514UL, 1121616698UL, 3536706232UL, 1119158170UL,
            2180719025UL, 2498648561UL, 2504146192UL, 2311035163UL, 845621371UL,
            4128509118UL, 3892985425UL, 1813068737UL, 2460350520UL, 3759123765UL,
            3296755451UL, 1816280435UL, 1337283858UL, 1475630799UL, 3256862205UL,
            1337643899UL, 3513481577UL, 1988910274UL, 16415099UL, 2657012513UL,
            1443983529UL, 418728586UL, 3845107811UL, 3061513829UL, 4155867140UL,
            1134954493UL, 1447378215UL, 2302142465UL, 255878528UL, 3127668772UL,
            510234782UL, 3776394042UL, 4141964975UL, 1650621698UL, 1533858893UL,
            1209322108UL, 4029779072UL, 162792549UL, 3181781509UL, 1100835531UL,
            2363857919UL, 3538513172UL, 3684647403UL, 1384987708UL, 4019976256UL,
            3731558642UL, 2229919300UL, 2328038081UL, 114481344UL, 1204695341UL,
            3806584361UL, 3052259902UL, 758156143UL, 1922833515UL, 2512455614UL,
            1959267688UL, 3979468422UL, 939313070UL, 867267185UL, 1125655886UL,
            2449907737UL, 2089431866UL, 2051025568UL, 3380263529UL, 3233391830UL,
            975418890UL, 312209732UL, 868932083UL, 2293558246UL, 3815276622UL,
            2990754247UL, 3499722318UL, 932565535UL, 444827781UL, 1528462469UL,
            2698714898UL, 2743756627UL, 3434008644UL, 873788496UL, 3380936986UL,
            3608899544UL, 953021925UL, 3451735586UL, 2250710574UL, 3468720220UL,
            3343718905UL, 4035831874UL, 3954118972UL, 2248859214UL, 3984572623UL,
            753461748UL, 1644933373UL, 2531152575UL, 2122960842UL, 2811679914UL,
            1404866161UL, 4046601927UL, 2052546518UL, 3297455234UL, 404120354UL,
            720034026UL, 2140471195UL, 4273885119UL, 535493623UL, 639530637UL,
            1539978282UL, 3429289165UL, 518639888UL, 2686788213UL, 3775498952UL,
            1164531239UL, 2986965634UL, 3361563406UL, 2584579727UL, 2785235835UL,
            733820092UL, 2268011329UL, 38148886UL, 737053025UL, 1628043757UL,
            2544174810UL, 1648477722UL, 3709221873UL, 1379149111UL, 3531979758UL,
            1221572282UL, 1563825729UL, 4253854479UL, 65433694UL, 533775106UL,
            3222053881UL, 1729749449UL, 255087793UL, 3913625882UL, 553608014UL,
            3024452738UL, 853024724UL, 2463017395UL, 3795560372UL, 1312860406UL,
            2993638562UL, 938799276UL, 2581767293UL, 666831235UL, 1325927429UL,
            1365838766UL, 61120276UL, 353502425UL, 2544639597UL, 1678046875UL,
            764979350UL, 3168164174UL, 4077951098UL, 2277469483UL, 1912714498UL,
            942908935UL, 1515872309UL, 2846964651UL, 2597034560UL, 3590871645UL,
            1807427631UL, 1567315708UL, 3057991288UL, 773104571UL, 1735252788UL,
            4186000299UL, 2439697319UL, 3799133606UL, 1489084279UL, 3255647577UL,
            209954954UL, 2997581608UL, 2649120094UL, 3480122550UL, 2452457542UL,
            3651928132UL, 3834048357UL, 4209272756UL, 3224959801UL, 2216933822UL,
            893314057UL, 2294323056UL, 3749294512UL, 3080920488UL, 561037491UL,
            3338761342UL, 447355527UL, 2338440308UL, 1737592883UL, 422327385UL,
            4258522190UL, 1209183807UL, 2690327397UL, 167638878UL, 3330526580UL,
            2319258588UL, 4220970122UL, 3447686174UL, 3965143099UL, 3942838788UL,
            1862484277UL, 749652831UL, 173916209UL, 1387371801UL, 831597358UL,
            99626001UL, 4080184935UL, 2910604269UL, 1319899287UL, 1767393944UL,
            2788122967UL, 3943547548UL, 825406912UL, 2891560664UL, 895801096UL,
            4072883032UL, 152388381UL, 3474538897UL, 9335402UL, 1428918622UL,
            3871291263UL, 2615658331UL, 1528089976UL, 1289521459UL, 1788424614UL,
            2375251067UL, 313787483UL, 2230744792UL, 165487802UL, 3369546802UL,
            1975904289UL, 614861503UL, 4077435827UL, 894834880UL, 3431452511UL,
            507597583UL, 1236954312UL, 1177004543UL, 3043832377UL, 2007301139UL,
            891305779UL, 1369806077UL, 2295518537UL, 4280670275UL, 2293751897UL,
            2665524490UL, 2040163654UL, 222042893UL, 1844523211UL, 241378809UL,
            1879443735UL, 2127424351UL, 2924350603UL, 1574825940UL, 1415259711UL,
            387967870UL, 61935243UL, 3388729280UL, 2841013010UL, 1520433792UL,
            1784720886UL, 3291949677UL, 3688434613UL, 1394655683UL, 4211258084UL,
            2073085422UL, 1989061149UL, 2512433879UL, 2022998905UL, 1191788973UL,
            2122532652UL, 943439225UL, 869264260UL, 1539795484UL, 2865559700UL,
            2713151187UL, 3364233838UL, 1313990094UL, 4080274575UL, 1894558395UL,
            2109055874UL, 4035039714UL, 1863026199UL, 3278302265UL, 3444105052UL,
            4043443818UL, 3568442974UL, 725986502UL, 4126681387UL, 3384084611UL,
            2525863321UL, 2603581177UL, 4170330001UL, 3461395479UL, 2284849407UL,
            467709468UL, 2858763673UL, 3994399223UL, 2096515112UL, 1252359120UL,
            1161325666UL, 2552110153UL, 2015904716UL, 3028085166UL, 2823289225UL,
            599932643UL, 3002926624UL, 3776820139UL, 2852420574UL, 2198968094UL,
            3704374112UL, 3352458013UL, 1026597381UL, 1333645364UL, 3464629087UL,
            1219584571UL, 905644983UL, 730345625UL, 319080809UL, 850459661UL,
            3751927743UL, 2417085524UL, 642165059UL, 2635546304UL, 2495822510UL,
            2581598917UL, 3141929484UL, 163520054UL, 93529769UL, 2604848738UL,
            3827256775UL, 4210137441UL, 3279988863UL, 3635764092UL, 1731797228UL,
            3619866751UL, 2303119102UL, 4071670885UL, 1497688282UL, 458621690UL,
            872290947UL, 1608713899UL, 1292788211UL, 16976616UL, 781503920UL,
            2177679833UL, 2546012879UL, 3409301963UL, 1934614646UL, 465669708UL,
            2110834381UL, 2620642698UL, 3280100156UL, 4261091393UL, 3809656207UL,
            1350791638UL, 2815489944UL, 901265186UL, 2524542494UL, 2963003163UL,
            3390714350UL, 3819328865UL, 3332582778UL, 2605968629UL, 3924460738UL,
            1461359983UL, 1742885903UL, 2740806815UL, 3604177662UL, 1332560478UL,
            193881028UL, 3574724144UL, 2995765505UL, 1266600026UL, 3843889955UL,
            1337559312UL, 1519245169UL, 3050842016UL, 3917841145UL, 1260596819UL,
            311383843UL, 664281834UL, 3441373905UL, 2773077312UL, 1321238534UL,
            3120829650UL, 1540397577UL, 1141700233UL, 193940413UL, 471171264UL,
            2943124290UL, 1744564942UL, 3658007369UL, 932570102UL, 3392154961UL,
            1423050826UL, 4267569834UL, 2388121391UL, 3601196137UL, 3210156547UL,
            609050404UL, 3357791300UL, 3199268170UL, 1581068879UL, 817572355UL,
            1667488394UL, 2835369758UL, 66797414UL, 408411894UL, 2121962482UL,
            2549139641UL, 3823996660UL, 732552958UL, 1056231775UL, 1294860719UL,
            2216132903UL, 3574131052UL, 3723086356UL, 2115092646UL, 1210146588UL,
            1308307031UL, 4253640262UL, 1833388949UL, 4086070180UL, 4248546214UL,
            3194688214UL, 2735925048UL, 1480102152UL, 2533650791UL, 650012195UL,
            3394827872UL, 1276090814UL, 243151392UL, 2709788773UL, 3973232265UL,
            304359816UL, 2104405020UL, 1625960938UL, 942064417UL, 1903389659UL,
            1242894605UL, 1986766019UL, 2093860487UL, 1561808784UL, 1416089757UL,
            4290630606UL, 2031355425UL, 3787610922UL, 3341659357UL, 2306129900UL,
            796897271UL, 3613711854UL, 3454622255UL, 2096307286UL, 3899856244UL,
            2168793787UL, 811488054UL, 3003959093UL, 920536190UL, 235236856UL,
            870345839UL, 2125533070UL, 3150976410UL, 1602865420UL, 1686727350UL,
            1608193802UL, 2741573520UL, 4124857144UL, 1714662903UL, 2275463448UL,
            652180875UL, 2431468754UL, 452841239UL, 3278749002UL, 3303889829UL,
            4152546007UL, 616695080UL, 3812554858UL, 4164332608UL, 967496881UL,
            2727662435UL, 1846779112UL, 2458739734UL, 2618013467UL, 1628521962UL,
            1419194199UL, 3966902011UL, 3179263968UL, 4148167983UL, 3842398422UL,
            509032837UL, 1175303318UL, 1934363098UL, 4224144523UL, 1995784127UL,
            1302446734UL, 2589103897UL, 2297122363UL, 2683613448UL, 973146994UL,
            4187092500UL, 294073826UL, 2493057870UL, 1349784078UL, 1603343250UL,
            1950753701UL, 836900536UL, 4032766444UL, 3858987808UL, 1092338324UL,
            2481664746UL, 2056962973UL, 3232626732UL, 4231314042UL, 1113897298UL,
            1886299844UL, 2322607178UL, 4064885313UL, 1203830751UL, 2912214584UL,
            834402639UL, 1208292382UL, 1999114528UL, 3758660474UL, 1373518547UL,
            2548109435UL, 3519395113UL, 1679598283UL, 1638789519UL, 2238935587UL,
            2844652636UL, 2041665859UL, 3234305169UL, 3533221867UL, 924228217UL,
            4067605767UL, 61845809UL, 1238213296UL, 2838594765UL, 589764255UL,
            1936987607UL, 1391268719UL, 3827406164UL, 2712481406UL, 2729640782UL,
            4288074168UL, 857810267UL, 1054017611UL, 3634461966UL, 2234205278UL,
            928947596UL, 1488919655UL, 3043038432UL, 714434122UL, 3069879143UL,
            2689232763UL, 2816694376UL, 2617247742UL, 477570758UL, 1746369489UL,
            172225618UL, 3443843044UL, 3721316126UL, 3036844258UL, 700862569UL,
            2685768491UL, 3798794306UL, 531509971UL, 2468704980UL, 163723231UL,
            1001440253UL, 1923631932UL, 353653849UL, 3043181127UL, 565463912UL,
            1688707242UL, 3301654360UL, 3291779647UL, 110569235UL, 435896924UL,
            2158166724UL, 164829096UL, 478630567UL, 1583156167UL, 4161886811UL,
            2490103241UL, 2049527522UL, 3398164752UL, 702587304UL, 1961268132UL,
            1974777464UL, 2406604166UL, 3184969912UL, 1731222480UL, 2395181225UL,
            2072651612UL, 4242978947UL, 180388302UL, 1618159866UL, 461166179UL,
            3035596072UL, 837688430UL, 1161716079UL, 3450078309UL, 3387286520UL,
            453546686UL, 3999327789UL, 329294889UL, 3068190473UL, 3936666478UL,
            1256948525UL, 3461282703UL, 2849746490UL, 3334649727UL, 4240625231UL,
            585392901UL, 3135247071UL, 664765953UL, 4215090368UL, 2635308248UL,
            593999569UL, 3963326537UL, 1409143395UL, 3509200733UL, 3667922064UL,
            668012972UL, 1872586565UL, 4020510717UL, 3211932514UL, 1160080851UL,
            4134725660UL, 2181587848UL, 1382851160UL, 4226977682UL, 3945723623UL,
            1633583368UL, 2675890776UL, 1942255133UL, 1667454516UL, 1812284667UL,
            4185572712UL, 3022303989UL, 2954682536UL, 3102137388UL, 2951656276UL,
            1098054436UL, 1916247543UL, 1254534493UL, 2901272726UL, 3530113571UL,
            4179948015UL, 2677554703UL, 1449372317UL, 1848303323UL, 2571715881UL,
            1323382615UL, 7182921UL, 1335537230UL, 230388913UL, 23501567UL,
            4049151880UL, 3148947783UL, 1592021722UL, 2658376882UL, 4213562912UL,
            1395346159UL, 152368572UL, 2348516725UL, 2748023749UL, 1042229554UL,
            2056811387UL, 4128932243UL, 2116447834UL, 2871666904UL, 2932907257UL,
            3634967378UL, 3507472489UL, 1234512567UL, 181112439UL, 1649268488UL,
            1309531357UL, 991020632UL, 4095945632UL, 4106363582UL, 44612861UL,
            3169431716UL, 3527387294UL, 270209417UL, 1135425065UL, 357583385UL,
            3320452294UL, 241402391UL, 2208094317UL, 2741285578UL, 658304376UL,
            1985477119UL, 3613060938UL, 1671700863UL, 3315652183UL, 1147928999UL,
            3507584064UL, 3659676075UL, 3958123430UL, 3789032232UL, 213778736UL,
            113362053UL, 823154826UL, 679416244UL, 3093555549UL, 952331786UL,
            483720823UL, 3923189529UL, 511116411UL, 2592246221UL, 1981105076UL,
            1309731863UL, 1878031973UL, 831041222UL, 2709217523UL, 3103009700UL,
            3265900884UL, 2813913857UL, 1561537471UL, 2659001234UL, 443425288UL,
            3519777403UL, 2051589061UL, 2469814936UL, 1270770633UL, 1326141892UL,
            1910762052UL, 3515605318UL, 3693223622UL, 326554153UL, 3077815192UL,
            3142218763UL, 1913029727UL, 3109111769UL, 3260800278UL, 4004110215UL,
            1087796599UL, 4132376308UL, 1577851316UL, 369005883UL, 3651129230UL,
            3071137486UL, 989815298UL, 2762688254UL, 2118736280UL, 3692405840UL,
            530238339UL, 639311061UL, 229507947UL, 4292303116UL, 2143249556UL,
            3680229821UL, 580416601UL, 3298651230UL, 3875274605UL, 199468613UL,
            842402642UL, 2811863886UL, 68938908UL, 1985484503UL, 669875367UL,
            967535426UL, 1278692878UL, 3038302253UL, 3140415113UL, 558809104UL,
            619436771UL, 2604294408UL, 1258951495UL, 3095806816UL, 2922083768UL,
            4028913928UL, 2785297592UL, 1170640660UL, 4150329982UL, 2289198195UL,
            1789527031UL, 2051300571UL, 1644716864UL, 1941173724UL, 1779210948UL,
            146650713UL, 3898640830UL, 2896145212UL, 1130810947UL, 1632710659UL,
            1261716023UL, 3646761445UL, 3499688921UL, 1806682856UL, 2510501108UL,
            3139606161UL, 2520429840UL, 2481922341UL, 4116609971UL, 1543857241UL,
            1720918944UL, 2658985854UL, 2804551144UL, 606553611UL, 2000318963UL,
            3845609019UL, 1025171844UL, 758006856UL, 966724549UL, 180359768UL,
            1712807788UL, 3323312958UL, 1481876703UL, 2108993945UL, 936187231UL,
            1478404033UL, 1457786023UL, 1609921868UL, 2191632727UL, 2508111676UL,
            4180102827UL, 1578831525UL, 2016382398UL, 1587556765UL, 1211681661UL,
            4171013367UL, 4115760320UL, 3753323748UL, 218758715UL, 3065466885UL,
            1470205391UL, 2463635171UL, 2567063470UL, 123639014UL, 3119232552UL,
            2095587371UL, 3203819687UL, 2039462058UL, 1700395840UL, 2495844348UL,
            3737134992UL, 1708331935UL, 2494394257UL, 246547750UL, 158878228UL,
            2192533008UL, 816911028UL, 4247527774UL, 1463348146UL, 3902414713UL,
            1212566211UL, 1601253113UL, 879983220UL, 4196777127UL, 2009850819UL,
            283876563UL, 3045658651UL, 369742524UL, 1926673106UL, 1526954735UL,
            3546901483UL, 4071394124UL, 519539678UL, 298210345UL, 4143734272UL,
            581648927UL, 779209738UL, 4086935284UL, 1377998651UL, 2593828532UL,
            87588891UL, 505935827UL, 405427193UL, 163470145UL, 2556596192UL,
            32480673UL, 487726617UL, 383705146UL, 2900145016UL, 3379405498UL,
            3865627777UL, 1502203695UL, 4075458576UL, 1031563820UL, 3316652859UL,
            1139327012UL, 2247677950UL, 522475785UL, 1040797340UL, 975956695UL,
            3208203744UL, 722884788UL, 2004479119UL, 171172741UL, 3261843831UL,
        };

        /// <summary>
        /// Taken from http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/index.html,
        /// SFMT-src-1.3.3.zip, SFMT.4253.out.txt.
        /// </summary>
        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_NextUInt_ReferenceImplementationTest()
        {
            const int ulongLength = 100;
            var gen = new MersenneTwisterSfmt4253UniformRandom(1234);
            for (int i = 0; i < ulongLength; ++i)
            {
                ulong expected = ExpectedULong[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(
                    expected,
                    actual,
                    Invariant($"Reference implementation uint: index={i}, actual={actual} expected={expected}"));
            }

            const int ulongArrayLength = 100;
            gen = new MersenneTwisterSfmt4253UniformRandom(new[] { 0x1234, 0x5678, 0x9abc, 0xdef0 });
            for (int i = 0; i < ulongArrayLength; ++i)
            {
                ulong expected = ExpectedULongArray[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(
                    expected,
                    actual,
                    Invariant($"Reference implementation array: index={i}, actual={actual} expected={expected}"));
            }
        }

#pragma warning disable S2699 // Tests should include assertions
        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_NextDouble_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt4253UniformRandom(Seed);
            double expected = 0.5;

            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble();
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 4;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(8);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 6;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(4, 8);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_NextInt_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt4253UniformRandom(Seed);

            double expected = int.MaxValue / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt();
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 400d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(800);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 600d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(400, 800);
            }

            actual /= Count;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_NextBoolean_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt4253UniformRandom(Seed);

            const double expected = Count / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextBoolean() ? 1 : 0;
            }

            Doubles.AreEqual(
                1,
                expected / actual,
                1e-1,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_NextBytes_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt4253UniformRandom(Seed);

            const double expected = 128;
            double actual = 0;
            var array = new byte[32];

            for (int i = 0; i < Count; ++i)
            {
                gen.NextBytes(array);
                actual = array.Aggregate(actual, (current, b) => current + b);
            }

            actual /= Count * 32;
            Doubles.AreEqual(
                1,
                expected / actual,
                1e-2,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }
#pragma warning restore S2699 // Tests should include assertions

        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_Seed_SameSeed_SameValue()
        {
            var gen1 = new MersenneTwisterSfmt4253UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt4253UniformRandom(Seed);
            int actual = gen2.NextInt();

            Assert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_Seed_DifferentSeed_DifferentValue()
        {
            var gen1 = new MersenneTwisterSfmt4253UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt4253UniformRandom(Seed + 1);
            int actual = gen2.NextInt();

            Assert.AreNotEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_CanReset_ReturnsTrue()
        {
            var gen = new MersenneTwisterSfmt4253UniformRandom();

            Assert.IsTrue(gen.CanReset);
        }

        [TestMethod]
        public void MersenneTwisterSfmt4253UniformRandom_Reset_ValueGeneratedThenReset_SameValueGenerated()
        {
            var gen = new MersenneTwisterSfmt4253UniformRandom();
            int expected = gen.NextInt();

            gen.Reset();
            int actual = gen.NextInt();

            Assert.AreEqual(expected, actual);
        }
    }
}
