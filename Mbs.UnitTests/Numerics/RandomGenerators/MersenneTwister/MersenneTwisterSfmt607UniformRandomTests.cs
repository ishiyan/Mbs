using System.Linq;
using Mbs.Numerics.Random;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators
{
    [TestClass]
    public class MersenneTwisterSfmt607UniformRandomTests
    {
        private const int Seed = 12345;
        private const int Count = 5000;

        private static readonly ulong[] ExpectedULong =
        {
            1196421539UL, 2865311212UL, 3866479472UL, 2692900087UL, 3838928621UL,
            3188765817UL, 2751632982UL, 3712143069UL,  549918413UL, 2026167923UL,
            1600383423UL, 1164248707UL, 3597250909UL, 1646078700UL, 3597866549UL,
             738391729UL, 1195673494UL,  320418194UL, 3419357688UL, 4060638541UL,
            3132037965UL, 2907853147UL,  886556822UL, 1640020536UL, 2638235623UL,
             538643813UL,  513603633UL, 1576774846UL, 2624061267UL, 1520310145UL,
            1556074285UL,  274920712UL, 1875395000UL,  435607661UL, 4280948541UL,
            3881013247UL, 1871389704UL, 1386666007UL, 1521983728UL, 2017380625UL,
            2474071325UL, 2968934185UL,  563020868UL, 1031564816UL, 1981146826UL,
            3652334148UL, 2471529270UL, 3572107826UL, 3394691737UL, 1294344698UL,
            1209143334UL,  488934364UL,  347248244UL,  887759301UL,  539745038UL,
            1564691999UL,  177466989UL, 1195243631UL, 1676525668UL, 3463273900UL,
            2472936126UL, 1317767033UL, 3326192931UL, 2206926957UL, 2159193172UL,
            3015304372UL,  507778107UL, 1649225853UL, 2398850965UL,   68775227UL,
            4014588077UL, 1498704485UL,  513323460UL,   58006716UL, 2206203452UL,
            2002124206UL,  639160438UL, 4021083080UL, 2900290131UL, 2631574044UL,
             809863548UL,  620952881UL, 3319558763UL, 3208741780UL, 3168227511UL,
            2806750943UL, 3328453134UL, 3734687450UL, 2975600227UL,  747454709UL,
             382480240UL, 1540538655UL, 2520181844UL, 2067407551UL,  839678855UL,
            3109877890UL, 2876703613UL, 4211018088UL,  271968959UL, 4231105707UL,
            4158436362UL, 2633767851UL,  123617477UL, 3990029657UL, 2933852587UL,
            1087074084UL, 3643562721UL, 2264260651UL, 2862036524UL,  820629023UL,
            2559932954UL, 3033951441UL, 2454257183UL,  268259955UL, 4254748684UL,
             218177143UL, 1085516335UL, 2920669698UL, 1369673038UL, 3625847514UL,
            3583791905UL, 1549519964UL,   92244746UL, 2981951799UL,  967416236UL,
             566673899UL, 3823379343UL, 3518440609UL,  294612836UL,  809034584UL,
             798567885UL, 4145592634UL, 4231868868UL, 3923949552UL, 3495405505UL,
             644091345UL, 3484678002UL, 1853985452UL, 3562224034UL,   77701257UL,
            3985811366UL, 2659094691UL, 4160649567UL, 1459273375UL, 1206850698UL,
            3515893001UL, 4056739495UL,  790262694UL, 2170353942UL, 3034023845UL,
            1866606784UL, 4108583244UL, 3572767766UL,  371629668UL,  531290358UL,
            4145080668UL, 1681745291UL, 3478318575UL, 4265672250UL, 4191849287UL,
            3754770837UL, 3787018798UL, 3348570561UL, 2359911217UL, 1070488654UL,
             826188262UL,  477544520UL,  947161014UL,    2815522UL, 3598852264UL,
            1723251845UL, 4216818156UL, 2269301827UL,  341913345UL, 3279941709UL,
            1878860471UL,  188578809UL,   17554473UL, 1797301125UL,  796821606UL,
            2518597957UL, 1585735274UL, 2861932133UL, 4183436883UL,  448055123UL,
            3298281906UL, 3858433023UL, 2571242096UL, 3320122719UL,  264595292UL,
             951235594UL,  302531725UL, 3575697071UL, 1565107752UL, 2522984875UL,
            4202633183UL, 1343074970UL, 1235668833UL, 1052216889UL, 3271484119UL,
            1140051640UL,  840134111UL, 2009138304UL, 3684412213UL,  136414981UL,
            2012147313UL, 1721331717UL, 1010475673UL, 1242059377UL, 3846082391UL,
             286635302UL, 3464127941UL, 3186894905UL, 2873496456UL, 3708705635UL,
             386739807UL, 3768476892UL,  881122115UL, 1344888238UL, 2196649106UL,
            2408339015UL, 2393724110UL, 1409957917UL, 4104329509UL, 2732352324UL,
            2245622770UL, 2916279499UL,  701367106UL, 2818152461UL,   97304239UL,
            3868078005UL,  181298085UL, 2441965305UL, 2924255565UL, 1736376205UL,
            2030371109UL, 1197039000UL, 3051970155UL, 1337824902UL, 2418923493UL,
             719072282UL, 2447965011UL, 2277636191UL,  973455679UL,  428543080UL,
            3074528064UL, 3081528202UL, 2348783902UL, 3291806189UL, 2721462254UL,
            1737336288UL, 1671654558UL, 1441380353UL, 1414369745UL, 3351091118UL,
            3928797055UL,  896415492UL, 2615565720UL, 2713114846UL,  584692028UL,
            1724505320UL, 1369217050UL, 2559792910UL, 3709802790UL, 2040574736UL,
             227534011UL, 1328228308UL,  433874042UL, 3961897210UL,  771527286UL,
             198818939UL, 3489199083UL,  997406006UL, 3875971072UL, 1806983272UL,
            3961027289UL, 1466189037UL, 2322556159UL, 3085479121UL,  588533000UL,
            2853731837UL, 1306826309UL, 3637561520UL, 3708154266UL,  943448030UL,
             360656311UL, 3945855398UL, 2606313341UL,  492746354UL,  487036034UL,
             164880756UL, 3008148136UL,  694325965UL,  495409668UL, 2864732455UL,
            1814111757UL, 4103554862UL,  198926303UL,  105165497UL, 3097624350UL,
            1943362337UL, 1744306457UL,  283634577UL, 3092757275UL, 2432009022UL,
            3866690395UL,  420956813UL,  993852981UL, 1455918011UL, 4183606539UL,
            2402504661UL, 1683628286UL, 1488936951UL, 1818364464UL,  382298201UL,
            1911628866UL,  699255764UL, 3799985705UL, 1363369809UL,  881287919UL,
            3577175365UL,  552601418UL, 3741886622UL,  305397376UL, 2138779629UL,
            4245718058UL, 1205661334UL, 4050018882UL, 2318877696UL, 3098578905UL,
             511547863UL, 2885006216UL,  490558514UL, 3342443666UL, 3844780113UL,
            3928194260UL, 3879215495UL, 1686207582UL, 2906132996UL, 1706797624UL,
            3109314274UL, 4273956052UL, 1800863504UL, 1207283183UL, 1014386912UL,
            1561444908UL,  352645098UL, 1708224450UL,  488939896UL, 3603991658UL,
            1268297587UL, 2483677019UL, 1850112684UL,  402212578UL,  842568149UL,
            3446271276UL, 2380490792UL,   28975013UL, 3897647126UL, 2877536437UL,
             369532329UL,  490951577UL, 2722903043UL, 1958796242UL,  683558750UL,
            2306940213UL, 1726077572UL, 3391815817UL,   98312053UL, 2120427142UL,
             366014292UL, 1325639565UL, 1289879472UL, 2265886217UL, 3145790356UL,
             849278833UL,  958196703UL,  601367739UL, 2218681360UL, 1708472466UL,
            3293000197UL,  385381018UL,  229518574UL,  975826905UL,  932862824UL,
            3146025764UL,  555913496UL, 3030446353UL, 2770044246UL,  332991182UL,
             550073358UL, 3130908017UL, 3133667774UL,  699686924UL,  905020778UL,
            2912691769UL, 3284668840UL, 1637231207UL, 3413427200UL, 3829933899UL,
            2113281635UL, 1753924041UL,  497020896UL, 4035187062UL, 3330583188UL,
            2341641279UL, 2253354324UL, 2906635077UL,  748051051UL,  210730258UL,
             275218493UL,  370718452UL, 3144507848UL, 3572627242UL, 2692586737UL,
            3486799665UL, 1415002017UL, 2588197742UL,  501158979UL, 2216606388UL,
            1959825514UL, 3185369722UL, 2743195581UL, 3687005779UL, 1584912299UL,
             444300290UL,  665178297UL, 2006322838UL, 1889764006UL,  561071313UL,
             101299867UL, 3846697354UL, 3376497938UL, 4193750324UL,  485450541UL,
             112718035UL,  647550319UL,  993795105UL, 2820891562UL, 3362348389UL,
            2213093823UL,  651858971UL,  404350990UL,  651498925UL, 1504867463UL,
            1900818130UL,   65383700UL, 1801919137UL,  913649123UL, 4269928469UL,
            2662476766UL, 3793173264UL,   26869762UL, 3499650644UL, 1138980334UL,
            1210199539UL, 3362506186UL, 2669170795UL, 2949927941UL, 3141248460UL,
            1180911127UL, 4129171431UL,  504639688UL, 1496063012UL, 1709808543UL,
            1689525624UL,  878130828UL, 3295985334UL,  110840315UL, 4047467918UL,
            4145280016UL, 2916569199UL,  326683517UL, 1768900673UL,  595930005UL,
             324306786UL, 1487137920UL, 1124568703UL, 3905978779UL,  874730000UL,
            3362468830UL, 1397446833UL, 3266311377UL, 3560923693UL, 1686697729UL,
            1611392216UL, 1627916880UL, 3277255568UL, 3443621164UL,  581117864UL,
            3719275683UL, 3152667205UL, 3675000896UL, 3013638834UL,  843597249UL,
            2152932257UL, 1940348938UL, 2929823468UL, 3096595336UL, 3038582797UL,
             101884686UL, 1840375592UL, 1696430022UL, 1979618902UL, 2508655378UL,
            3652581760UL, 2542935628UL,  404289830UL, 3576446993UL, 1809618356UL,
            2402816497UL, 2191713724UL,  251469888UL, 3652982646UL, 3824773957UL,
            1404879064UL,  890695911UL, 1904137674UL,  662695577UL, 3637070531UL,
            3429921890UL, 3594169910UL, 3908626306UL, 2264799861UL, 3278108366UL,
            1909713562UL, 1640461275UL,  867660486UL,   98850410UL, 3533713494UL,
             967115761UL, 2269650721UL, 3055851776UL, 1894514802UL, 2427310710UL,
            2227931808UL, 1050719741UL,  510803189UL,  522828620UL, 3737103489UL,
             412000758UL, 1398291763UL, 2080584852UL,  626153494UL,  799093460UL,
            3694215698UL, 2673090626UL, 3654915943UL, 2930921591UL,  647525186UL,
            2316225776UL, 1841613610UL, 2942111578UL, 1876524150UL, 1496398320UL,
            1104088489UL, 3699360346UL, 1539132782UL,  184588763UL, 3648180059UL,
            3604669131UL, 4157568956UL, 1806964100UL, 1417720133UL,  931983072UL,
            1968834098UL, 2777088770UL, 3873851830UL, 1639173983UL, 3543685261UL,
            2065189356UL, 1670581940UL, 1223855034UL, 2989792629UL, 1809977097UL,
            1875811443UL, 4227562332UL, 1670476847UL, 1154758869UL, 3427236995UL,
            2498400797UL,  319241644UL, 1035366872UL, 2947128631UL,  267667087UL,
             226905755UL, 3630268752UL, 2665165917UL,  449770512UL, 3479613272UL,
            4277953704UL, 1304491129UL,  246429665UL, 4048627658UL, 2335248253UL,
            1721534446UL, 3668219108UL,  602606507UL, 3606778707UL,  217078527UL,
            2462010980UL,  189731322UL, 4035734287UL, 3051995431UL, 3436042452UL,
            3848332279UL, 1303716288UL,  596895220UL, 2847087526UL, 1793978879UL,
             789845679UL, 3334761386UL,   42259927UL, 1988218208UL, 1853172342UL,
            3183943116UL, 3115896099UL, 2056268624UL, 3565828958UL, 2109847845UL,
             300329982UL, 2438778799UL,  624201808UL, 1317928914UL, 3709443147UL,
            4282631257UL,   79828958UL,  674413184UL, 2640064881UL, 1140557428UL,
             107481386UL,  833132031UL, 2398620479UL,  397057326UL,  774701723UL,
             995399905UL, 1688672626UL,  212894658UL, 2737370723UL,  342159914UL,
            3385239441UL, 1387048271UL, 1510776561UL, 3854320253UL, 1968630255UL,
            3637445533UL, 4055273425UL, 2299077287UL,  872799104UL, 3124137491UL,
            3615758003UL, 1610473012UL, 2470285439UL, 3365937560UL, 3074678675UL,
             895982664UL, 3893733617UL, 1510510873UL, 3526687491UL, 4041708170UL,
             748592940UL,  372467988UL, 2974139083UL, 1369552376UL, 3713393131UL,
            3318567727UL,  647786524UL, 4093984756UL, 2006863617UL, 1163251866UL,
            4253272489UL, 4107786591UL,  116333398UL,  604910036UL, 3311731128UL,
            2440943214UL, 3244822569UL, 3636790172UL, 2255133710UL, 2433025708UL,
             112787416UL, 3872548227UL, 1233516411UL,  708924037UL, 2361018962UL,
            2991368295UL, 3303324385UL, 2842011707UL, 2178207559UL,  249606939UL,
            1222683236UL, 2134069908UL, 2078591261UL, 1295550828UL, 1306098784UL,
            1458823628UL, 1817292410UL, 3760004583UL,   97971808UL, 3445630818UL,
             822646021UL,  844827188UL, 3065031254UL, 3166318126UL, 2300983832UL,
            2251709321UL,  274267653UL, 2243231555UL, 2161236475UL, 2282271118UL,
            3921858132UL, 2497468803UL, 3158556880UL,  561740411UL, 4265883388UL,
            3061471540UL, 4270596555UL, 2022091249UL, 2719052497UL, 2214320191UL,
            1603495991UL,  379616965UL,  599003062UL, 2115484688UL, 2744216056UL,
             565061522UL, 3923412445UL,  413733948UL, 1867786437UL, 2706231924UL,
            3894232783UL, 2637135933UL, 3590645480UL, 1769525659UL,  135784527UL,
            1117351223UL,  187646255UL, 4243744512UL, 2831745988UL,  180521176UL,
            2966831424UL, 4153583784UL, 2368395432UL,  710730097UL, 2303744468UL,
             777615683UL, 2586293103UL, 1425694392UL,  337023247UL, 1130138042UL,
            2733619416UL, 2409353045UL,  805250003UL, 2445772358UL, 1632125264UL,
            2453317804UL, 3914037689UL, 3496190539UL, 3612800316UL, 2252268118UL,
            2341251035UL, 3326391324UL, 1710159132UL,  721335093UL, 1830725060UL,
            1630477302UL, 2976298625UL, 3053349000UL,  222793695UL, 2587918576UL,
            3747179265UL, 4000911840UL,  336544219UL, 4045457953UL, 2050139410UL,
            3064640381UL, 2955225409UL, 2817679824UL, 3223027060UL, 2303893358UL,
            3840287987UL, 3632674894UL, 1831319195UL, 1345007230UL, 1225184526UL,
            2417981680UL, 3117819471UL, 2859843506UL, 1056817170UL, 4052116406UL,
            3872183733UL, 3514499807UL,  813274787UL,  936349377UL, 2007359068UL,
            1253933179UL, 3155500873UL, 2096329073UL,  546642626UL,  665475055UL,
            1473073709UL, 2332233324UL, 3323558320UL,   95879818UL,  492840830UL,
            1920696869UL, 3771395899UL, 2576038047UL, 1011453165UL, 2681244132UL,
            2476955960UL, 2463332109UL,  781125076UL, 2028393533UL,  204521083UL,
            2320272404UL, 2809583732UL, 3289108397UL, 1856267893UL, 2391018094UL,
            4028779855UL,  808977986UL,  153155498UL, 2319616370UL, 1309228705UL,
            4028797170UL,  610769874UL, 1121362138UL, 1981447595UL,  325339652UL,
             610241177UL, 3475612926UL, 3872224904UL,  122718344UL, 1688488846UL,
            1278996204UL,  209382475UL, 1919230322UL,  386052258UL,  396279010UL,
            2576119162UL, 1178251560UL, 3232629172UL, 2789003460UL, 2962389702UL,
            1481114042UL, 1760721525UL, 4036142681UL, 3670570725UL, 3117283094UL,
            3165032966UL, 1646380023UL,  498747483UL, 2252669427UL,  822100766UL,
            1101134705UL, 2930081282UL,  637591399UL, 3040829742UL,  137805365UL,
             428511268UL,   22457782UL, 1702963968UL, 1038479242UL, 1046427834UL,
            2336657358UL, 3197439937UL, 1581079844UL, 4114478551UL, 1775898469UL,
            3625286893UL,  990848125UL, 4208853553UL, 3890606085UL, 2897119912UL,
            2729414723UL, 2008262926UL, 2899578180UL, 3513543681UL, 4120965189UL,
             217756721UL,  526680465UL, 4229365288UL, 3483579946UL,  172878397UL,
            1775988343UL, 2701094379UL, 3784563186UL, 3013726534UL, 2918169775UL,
             548996991UL, 2854852809UL, 4162015982UL, 3274014282UL,  338197965UL,
             761382689UL, 1064834258UL, 4001550105UL, 3350983253UL, 1407587469UL,
             317254599UL, 3248232859UL, 1290091253UL, 4011651573UL, 3227939736UL,
            2850615130UL,  821598723UL, 1808321986UL, 1349876116UL, 2429344939UL,
             249734354UL,   99269121UL, 1110843241UL,  521462481UL, 1129183658UL,
            1366431504UL,  773209265UL, 1685383896UL, 2218488528UL, 3584750972UL,
            3746609454UL, 1646222603UL, 1918617018UL, 1626226587UL, 1880734214UL,
            1725948264UL, 2071663621UL, 3057073805UL,  103432954UL, 2431529109UL,
            3091943973UL, 2611245506UL, 3584837020UL, 2903196112UL, 2004742767UL,
            2043894142UL, 1407953274UL, 1474555657UL,  152707034UL,   93618108UL,
             783046825UL, 3820152174UL,  344516296UL, 3292970244UL, 3114538551UL,
            1711409885UL, 2567261312UL, 1707970454UL, 1171700617UL, 2288151849UL,
            2099703889UL, 2664895095UL,  375598407UL, 1308750054UL, 2910310386UL,
            2392426188UL, 3709863199UL, 2150655288UL, 3819094880UL, 2063093521UL,
            2228295690UL, 3368794217UL,  610202037UL, 3890104132UL,  851713523UL,
            3310255686UL, 2582885461UL, 3505584812UL,  160527117UL, 3237023579UL,
             683953932UL, 2499798882UL, 2795490813UL, 3691528275UL, 2319728878UL,
            2978139121UL, 3587229750UL, 1552802700UL, 1555487280UL,  249949761UL,
            3800715047UL,  349143205UL, 2118420903UL, 1423850027UL, 1806771672UL,
            4126288455UL, 1829726551UL, 1635451152UL, 1509683305UL, 3394280785UL,
            1318548553UL, 1985957974UL, 1367744196UL, 3463392791UL, 2780736231UL,
            3894488561UL, 3157036262UL, 3491812767UL, 1724574180UL, 3645035493UL
        };

        private static readonly ulong[] ExpectedULongArray =
        {
            1556592192UL, 2713881341UL, 1840174392UL, 3468073604UL, 2004354026UL,
            1304494515UL,  366015052UL, 1011850603UL,   67279901UL, 1051755907UL,
            1308953792UL, 1479381587UL, 1197340276UL, 2749666614UL, 1052362076UL,
             168556043UL, 2392613760UL, 3444358776UL, 1926822224UL, 1889847275UL,
            3381829651UL, 3127256300UL,  575892644UL,  690779511UL, 2177747339UL,
             876361305UL, 1258924403UL, 1843502566UL, 2615657527UL, 4126312896UL,
            1995725090UL, 3314751056UL, 3983944544UL, 3639584965UL, 2937574811UL,
            2317092480UL, 3919684981UL, 2516099471UL, 1540111829UL, 2559931611UL,
            3884249792UL,  297435776UL, 2215000335UL, 3831860889UL, 2332779987UL,
            3771083128UL, 2982917666UL, 1289897207UL, 2760622557UL,  669535824UL,
            3936118862UL, 3080364742UL, 2880890828UL, 4053594458UL, 3802721715UL,
            1540829749UL,  118351242UL, 4275259452UL, 1646758339UL, 3671481171UL,
            1236634677UL, 2645527235UL, 2562942478UL, 1347268862UL, 1297927267UL,
            2057465222UL, 4134548012UL, 1663980978UL, 2955981563UL, 2196700436UL,
            4028526500UL, 1538256092UL, 2628052013UL, 2777368251UL, 1222279597UL,
            2555975830UL,  300176348UL, 2145743946UL, 1323578746UL,  100427171UL,
            3726128684UL, 1044809119UL, 3590086589UL, 2617649711UL, 3493503829UL,
            1511057261UL,  162787675UL, 3301664653UL, 1545579015UL,  431280049UL,
            2853789101UL,  882465036UL, 1950759228UL, 3393129265UL, 2160602242UL,
            2727551730UL, 1706287957UL, 2838736133UL, 3145962937UL,  936223657UL,
            1018931109UL, 3208024647UL,  825834480UL, 1644623576UL, 1699087361UL,
            4252038431UL,   45500998UL,  850117698UL, 1871595684UL, 3948521913UL,
             617638223UL, 3658742302UL,  484443012UL, 2581115585UL, 2640369858UL,
            2904554187UL, 1759213578UL,  626588168UL, 2108795136UL, 1662136808UL,
            4245639883UL, 3855741236UL,  184411390UL, 2730827585UL, 2514070377UL,
            2871180667UL, 2751576522UL, 4279016004UL, 3486055042UL, 4050547537UL,
            1925322977UL, 2299933396UL, 3340458091UL, 1624389220UL, 1595119545UL,
            2146273476UL, 2694418184UL, 4095728020UL, 2692711813UL, 1326086380UL,
             599457867UL,  779504759UL, 3679544128UL, 3753749243UL, 1663274771UL,
            2299160373UL, 3580891083UL, 1859575966UL, 4228385133UL, 3261029369UL,
             695799349UL,  757696528UL, 2731276496UL, 3655816581UL, 3079602515UL,
            2143052304UL,  195651560UL, 3010985352UL, 2360090997UL, 2460054883UL,
            1008575913UL,  680965846UL,  933678835UL, 2664829675UL, 3574567239UL,
            1260731953UL, 3639664216UL, 4185254176UL, 3474803226UL,   40909797UL,
            2776750904UL, 3381944459UL, 4076464616UL, 2976399875UL, 2082668522UL,
            1598726088UL, 1734386267UL, 2611279300UL,  311205417UL, 3201176228UL,
            2893289137UL, 2797032131UL, 3238017077UL, 2092301401UL, 1034273519UL,
            1594528635UL, 1387314785UL,  662922052UL, 2201696947UL, 2923335212UL,
            2001691302UL, 4086698764UL, 2369139061UL, 1161293709UL, 2762333179UL,
            2662554687UL,  441789430UL, 3882191772UL, 1090234286UL, 3032622786UL,
            3211037413UL,   84667620UL, 2486078138UL,  907175135UL, 4065918788UL,
             702591331UL, 3029424030UL, 1371185732UL, 1148570789UL, 4102140991UL,
            1749582049UL, 2932276825UL, 4275102115UL, 2213736392UL, 2771782100UL,
            3728394678UL,  490178165UL, 1142566982UL,  739097413UL,  307975374UL,
            1806950837UL, 3482941664UL, 3376674231UL, 1139030188UL, 1555369950UL,
            4225610701UL, 2335363123UL,  157204999UL, 4293004658UL, 1372903021UL,
              94129649UL, 2527962256UL, 2262382944UL,  317501595UL,  159987373UL,
            3134579863UL,  542363170UL, 3321915644UL, 1606412388UL,  775721925UL,
            3574943011UL, 2461558839UL, 1599787942UL, 2798340814UL,  608716087UL,
            3178427745UL, 3985211542UL, 2880905942UL,  386971705UL,  474882803UL,
            4291702277UL, 2546092383UL, 3359045870UL,  295135838UL,   79296164UL,
             158785280UL,  805773175UL, 1092883771UL,   40230847UL, 2229695891UL,
            4005864302UL,  369523482UL, 1624215995UL, 1381575190UL, 1726775216UL,
            2214858332UL, 1436336172UL, 3897680116UL,  397583087UL,  669286525UL,
            3287180651UL,  943956992UL, 1934103213UL, 2476851219UL, 3288209383UL,
            3681612823UL, 2865943811UL, 1954339107UL, 4117844749UL, 1843974779UL,
            1267008904UL, 2658133774UL,   44899186UL,  755345233UL,  686968410UL,
            1521676891UL,  477471911UL, 3484034910UL, 2961029682UL, 2395398949UL,
            2134539233UL,  724312398UL, 2980142509UL, 2229312550UL, 3015342419UL,
            3692389090UL, 3253106465UL,  599588717UL, 3901588102UL, 2808797698UL,
             411869396UL, 1441761210UL, 2752638839UL,  285692855UL, 2657232529UL,
            1338089778UL,  642485740UL,  946549366UL, 2125760281UL, 1778513071UL,
            1595296458UL, 4235010082UL, 2660035414UL,  327777864UL, 2926366692UL,
            2931249289UL, 2495474510UL, 3876711805UL, 1685925498UL,  231150709UL,
            2958482926UL, 1971683076UL, 4079743342UL,  748560863UL, 1887203170UL,
            3220415930UL, 4121053773UL, 1588037852UL, 3581847110UL, 1012143696UL,
             779630500UL,  442260588UL, 1745834896UL, 4067857205UL, 4129456946UL,
             154033209UL,  660650104UL, 2871872439UL,   56130217UL, 1455233133UL,
            1962920819UL, 4134320395UL, 2388115110UL, 2136692741UL, 3666696255UL,
              24896330UL, 3662800383UL,  777053154UL, 1406737975UL, 3399473000UL,
             602143869UL,  125932812UL,  217366196UL, 2101891074UL, 1779033414UL,
            4200432798UL, 2683028545UL, 3623312792UL, 3653437900UL, 4193268247UL,
            2911723447UL, 1513559233UL, 4056045416UL, 1675540301UL, 3171641093UL,
              46860421UL, 4275427720UL, 2536235218UL, 3763038404UL, 3839875348UL,
            1817994307UL, 4224499090UL, 3348832099UL, 1175797126UL,  900920824UL,
             989697993UL, 2391175418UL, 2379211744UL, 2740068049UL,  633981162UL,
             936041259UL, 3633858468UL, 1801734952UL, 3395137285UL,  444281683UL,
            4139311686UL, 2592788790UL, 2455135746UL,  631339200UL, 3847460057UL,
             445228257UL, 1520487218UL, 2685955887UL, 2154370095UL, 1239497087UL,
            2522314627UL,  277166598UL, 1861562672UL, 1320104828UL, 1957660813UL,
            3906785664UL,   84531427UL, 2373255275UL,  192060126UL, 3566142336UL,
            4091831891UL, 2210606995UL, 3718733452UL, 1840881409UL, 2052909453UL,
             507369601UL, 3355435953UL, 2767829533UL,  404764671UL, 2105227200UL,
            3838201187UL, 2539918099UL, 2026220113UL, 1455844682UL, 3746975315UL,
            1096911848UL, 1224562255UL,  379067298UL, 4073739285UL, 1423209946UL,
            3447333417UL, 1269625850UL, 2066300766UL, 2869355360UL, 2117956727UL,
             921477967UL, 3913819321UL, 2993262661UL, 4048466912UL, 3321625084UL,
            2514494509UL, 1899020827UL, 2617748077UL, 2825275571UL, 2652230110UL,
            2262498157UL,  695237212UL, 1890351188UL,  254707354UL, 4107111399UL,
            3209646005UL, 2560392237UL, 1714108466UL, 2123120224UL,   36734592UL,
            1762117499UL, 3429054523UL, 2802979686UL, 3468819662UL, 4052485302UL,
             607659670UL, 1392665609UL,  148102101UL, 2057122833UL, 1408599635UL,
             404849067UL,  337151853UL, 2259179235UL, 1450297807UL,   13037092UL,
            3560908091UL, 1809049720UL, 2958361884UL, 1897612139UL, 3095752630UL,
            2549311506UL, 1971758214UL, 1602398570UL, 1683338829UL, 2789927009UL,
            3767015724UL, 2346243151UL, 4123552368UL, 2567093056UL,  203200826UL,
            2360560686UL,  114672545UL, 2952878555UL, 3580479836UL, 1253681850UL,
             207028493UL, 2742443921UL, 1217910520UL,  444724257UL, 2402025906UL,
            3276700120UL,  409810719UL, 2560033210UL, 1603048388UL, 1813071228UL,
            1470593154UL, 1745253272UL, 2195212307UL,  377190361UL, 2328288183UL,
             401382585UL, 2450634194UL, 2006291461UL, 3825372027UL, 1722367338UL,
            2692832577UL, 1050697614UL, 4119566598UL, 3028428293UL,  101061524UL,
             915217911UL, 3408472996UL, 2965960632UL,  847616616UL,  355432445UL,
            1075726646UL, 2378879589UL, 3516710254UL, 1563294375UL,  424413191UL,
            1111576600UL,  835097676UL, 2434532301UL, 2607859622UL,  941446560UL,
            2251966337UL, 4260262135UL, 2422487394UL, 3720498193UL, 2910310630UL,
            2301973528UL, 1940810754UL,  344319114UL, 1547152173UL,  640456954UL,
            1074707927UL, 1834890322UL, 1607982657UL,  417992674UL, 1090397871UL,
            2009422622UL, 3191440508UL, 1432705879UL,  783663814UL, 3796644066UL,
             791779766UL, 1508136140UL,  335075191UL, 3979612823UL, 3794303784UL,
             238855885UL,  446618201UL, 2790581314UL, 2833699754UL, 2009297696UL,
            4194656370UL, 1694699230UL, 1271428251UL, 3724397074UL, 1608472508UL,
             142528536UL,  997716174UL, 3803341249UL, 1128167233UL, 2687605024UL,
            2625356025UL, 2055168913UL, 1594254167UL, 3243768967UL, 2564427840UL,
            1281827896UL, 1916378262UL, 1641520660UL, 1963068911UL, 3272856472UL,
            1178319485UL, 2921090963UL, 2977623121UL,  535152467UL, 1044304423UL,
             901561798UL, 2424344635UL, 4221077707UL, 1808585834UL, 2755513906UL,
            3355577025UL, 2438113106UL, 1649093895UL,  568063824UL, 1173751673UL,
            3951226879UL, 1928825599UL, 2356443733UL, 3413904573UL, 1739787840UL,
            4270093290UL, 4130641756UL, 1684246347UL, 1023035457UL,  550970779UL,
            3290367637UL, 3743204221UL, 2421963305UL, 2482593584UL, 1996236391UL,
            2455170315UL,  162039676UL, 3393556387UL, 2116827952UL,  376133197UL,
            2921810488UL, 1254918826UL, 2449953243UL, 1968684081UL, 3354383140UL,
            1370643236UL, 1770810819UL, 3603108351UL, 1485228068UL, 2524941749UL,
             809600614UL, 3321121622UL, 1875866389UL, 1706152319UL,  299551028UL,
             977280966UL, 3007045557UL, 2180066992UL, 3741215075UL, 2609076651UL,
            3359153717UL, 2000559785UL, 1034425798UL, 3553206650UL, 1571671634UL,
            2049056120UL,  590790859UL, 3246963209UL, 2774711201UL,  765394947UL,
            4286794664UL, 1661649947UL,   96550471UL, 2598119254UL,  146138455UL,
            4242668163UL,  102790499UL,  585811010UL, 1167123242UL,  203713764UL,
             456188028UL, 3168161413UL, 1807786708UL, 3220206279UL, 2508484604UL,
             624550581UL, 2637177121UL, 3241105352UL, 3843262209UL, 3747737858UL,
            3076728900UL, 1467914958UL, 3099613203UL,  878511215UL, 3838000079UL,
             554463654UL,  673201757UL, 3805957607UL, 2364115996UL,  283960872UL,
             621872052UL,  523765086UL, 1975138089UL,  733205552UL,  849951398UL,
            2449654800UL, 1262858164UL, 4071152536UL, 1099282290UL, 3213619352UL,
            2540257149UL, 1564432552UL, 1928011443UL, 2745777573UL,  480577109UL,
            2919947635UL, 1906916132UL, 2602859872UL,  748271270UL, 3183487421UL,
            2779529741UL, 2141777137UL, 2368763772UL, 2787238865UL, 2449111643UL,
            4098749624UL,   80885680UL,  927736798UL, 2796906309UL, 3717377139UL,
            3495152189UL,  507003952UL, 1071984666UL, 1356967752UL, 3768351186UL,
            1248595023UL, 1604471054UL,  754349737UL, 2385813735UL, 3824816244UL,
            1832713010UL, 3042912486UL, 3444161026UL, 3722439852UL, 1102219726UL,
            3635252707UL, 2479114205UL,  602394730UL, 4165973019UL, 1757739650UL,
             290838357UL, 1951647351UL, 1383596666UL, 1704648841UL, 1054912780UL,
            2835686760UL, 2486021870UL, 4125857188UL, 1651556820UL, 2109948316UL,
             307218957UL, 2581812831UL, 2860961938UL, 4235291043UL, 2180932086UL,
            2428540824UL, 3855477946UL, 2993328505UL,  818228660UL, 2717327011UL,
            3278006137UL, 3046951748UL, 2118245185UL, 1671287569UL, 1808293087UL,
            1639141986UL, 1614709642UL, 3102980783UL,   80946040UL,  156132284UL,
            3273988635UL,  463704798UL,  443458026UL, 1350781302UL,  162942451UL,
            3240980847UL, 1096304380UL, 1244482180UL,   18815122UL, 3128268952UL,
             441792506UL, 3796914178UL, 2664051115UL, 3199159047UL,   41929707UL,
             885197932UL, 2266128873UL, 2987789757UL, 3379864480UL, 4182706709UL,
            1200872350UL, 3283870806UL, 1655889729UL, 2985647331UL,   18874732UL,
            1544173242UL, 2649931979UL, 4089915939UL,  671308686UL,  959190883UL,
            1969903421UL, 1432216572UL, 2463884262UL, 2995132517UL,   97025504UL,
            2858545788UL, 3015887053UL,   60915684UL,  174291011UL, 3462170330UL,
             991244574UL,  705674783UL, 4267835414UL, 3543140859UL, 1415906014UL,
             956368536UL,  176110722UL, 3247658272UL,  673487243UL, 3645377817UL,
            3861037016UL, 1723622684UL,  961347192UL, 3516470162UL,  695627514UL,
            3228936384UL, 1230738239UL, 1859810813UL, 3262871388UL, 2362347996UL,
            1968586373UL,  265085439UL,  644084010UL, 1001415002UL, 1333790203UL,
            3517737980UL, 3195724787UL, 2265754813UL, 1845182455UL, 4120730508UL,
            4290541093UL, 2886015724UL, 1924732003UL, 3999671706UL, 3838402651UL,
            1981035560UL, 1643352826UL, 2170070968UL,  726214772UL, 4077433186UL,
            1602289983UL, 2741116677UL, 2355817517UL, 3400587509UL, 1820368051UL,
             577116249UL,  869934995UL, 3620362636UL, 3057237272UL, 1977100821UL,
            2041319904UL, 3970370837UL, 2843947037UL, 1629161388UL, 2103758655UL,
            3787550875UL, 3684856700UL, 3136178047UL, 2681908188UL, 2857917430UL,
            1120834666UL, 2239870052UL,  905409072UL, 2964581312UL, 2067602345UL,
            2705035383UL, 1100673578UL, 1619715848UL, 2726873618UL, 2823831567UL,
            1398204160UL, 3074693876UL, 3941921311UL, 3987811376UL, 3137528005UL,
            4278780713UL, 2383373510UL, 1395190952UL, 2007030616UL,  698489535UL,
             724495519UL, 2542942239UL, 1633306940UL, 1924685933UL, 2351551465UL,
            3393733686UL, 3977993546UL, 1981176475UL, 3407916967UL, 2246791509UL,
            1167114087UL, 1200105585UL, 3939850748UL, 1979047945UL,  938015226UL,
            3794154494UL,  257644866UL,  195309899UL, 3681716935UL, 1517319699UL,
            3980402282UL, 2417540492UL, 1040716686UL, 2139866247UL, 3461903022UL,
            2718025409UL, 3735779798UL, 1335999149UL, 1304186696UL,  859875403UL,
             364456909UL, 3018556848UL,  821525018UL,  675165687UL, 4189447268UL,
            1652928276UL, 2954511997UL, 1515584047UL,   96669577UL, 1767449383UL,
            2584965196UL, 3789809599UL, 2992874174UL, 1936010922UL, 2382026211UL,
            2417057736UL, 2161138556UL, 1717127568UL, 2363543864UL, 3622553290UL,
            2418648935UL, 1575015841UL, 1401096459UL, 1013762322UL,  390785017UL,
            4236163519UL, 2722095626UL,  292053172UL,  535701659UL, 2441697597UL,
            1269979192UL, 1847939069UL, 1720949988UL, 1252649200UL,  720837751UL,
            4284728874UL, 3153810484UL, 2969469487UL,  536339527UL, 4268928374UL,
            4108017776UL, 1249838852UL, 3375962852UL, 2022128590UL, 2700344542UL,
             923640229UL, 1461565844UL,  942318758UL,   92486581UL, 1163645995UL,
             684876949UL, 3241807576UL,  317693855UL, 1298234403UL, 1163254400UL,
            3525767463UL,  468056238UL, 4080096339UL, 2399926912UL, 4043250518UL,
             435185531UL, 2977625717UL, 4139974839UL, 1004735238UL, 2082093241UL,
            3798956451UL, 3160950934UL,  469248200UL, 3593066883UL,  294156713UL,
            2060665322UL,  225533871UL,  240630624UL,  988450315UL, 2646753624UL,
            1521876974UL, 3761205673UL,  879347907UL, 1577977838UL, 1502071712UL,
             816635195UL, 3796095593UL, 4151953092UL, 3636831062UL, 3259976164UL,
            2787187451UL, 1311239585UL,   49123830UL, 2987307464UL, 1290024926UL,
            2746445588UL, 1794262040UL,  396903876UL,  232876554UL, 2682545876UL,
            2518876032UL, 2415705441UL, 4058432246UL, 1897269176UL, 2249840353UL
        };

        /// <summary>
        /// Taken from http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/index.html,
        /// <para />
        /// SFMT-src-1.3.3.zip, SFMT.607.out.txt.
        /// </summary>
        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_NextUInt_ReferenceImplementationTest()
        {
            // int ulongLength = ExpectedULong.Length;
            const int ulongLength = 100;
            var gen = new MersenneTwisterSfmt607UniformRandom(1234);
            for (int i = 0; i < ulongLength; ++i)
            {
                ulong expected = ExpectedULong[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation uint: index={i}, actual={actual} expected={expected}"));
            }

            // int ulongArrayLength = ExpectedULongArray.Length;
            const int ulongArrayLength = 100;
            gen = new MersenneTwisterSfmt607UniformRandom(new[] { 0x1234, 0x5678, 0x9abc, 0xdef0 });
            for (int i = 0; i < ulongArrayLength; ++i)
            {
                ulong expected = ExpectedULongArray[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation array: index={i}, actual={actual} expected={expected}"));
            }
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_NextDouble_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt607UniformRandom(Seed);
            double expected = 0.5;

            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 4;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 6;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(4, 8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_NextInt_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt607UniformRandom(Seed);

            double expected = int.MaxValue / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 400d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 600d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(400, 800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_NextBoolean_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt607UniformRandom(Seed);

            double expected = Count / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextBoolean() ? 1 : 0;
            }

            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_NextBytes_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt607UniformRandom(Seed);

            double expected = 128;
            double actual = 0;
            var array = new byte[32];

            for (int i = 0; i < Count; ++i)
            {
                gen.NextBytes(array);
                actual = array.Aggregate(actual, (current, b) => current + b);
            }

            actual /= Count * 32;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_Seed_SameSeed_SameValue()
        {
            var gen1 = new MersenneTwisterSfmt607UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt607UniformRandom(Seed);
            int actual = gen2.NextInt();

            Assert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_Seed_DifferentSeed_DifferentValue()
        {
            var gen1 = new MersenneTwisterSfmt607UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt44497UniformRandom(Seed + 1);
            int actual = gen2.NextInt();

            Assert.AreNotEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_CanReset_ReturnsTrue()
        {
            var gen = new MersenneTwisterSfmt607UniformRandom();

            Assert.IsTrue(gen.CanReset);
        }

        [TestMethod]
        public void MersenneTwisterSfmt607UniformRandom_Reset_ValueGeneratedThenReset_SameValueGenerated()
        {
            var gen = new MersenneTwisterSfmt607UniformRandom();
            int expected = gen.NextInt();

            gen.Reset();
            int actual = gen.NextInt();

            Assert.AreEqual(expected, actual);
        }
    }
}
