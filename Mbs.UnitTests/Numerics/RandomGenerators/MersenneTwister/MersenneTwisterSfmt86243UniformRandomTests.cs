using System.Linq;
using Mbs.Numerics.Random;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static System.FormattableString;

namespace Mbs.UnitTests.Numerics.RandomGenerators
{
    [TestClass]
    public class MersenneTwisterSfmt86243UniformRandomTests
    {
        private const int Seed = 12345;
        private const int Count = 5000;

        private static readonly ulong[] ExpectedULong =
        {
             729010956UL, 4245516629UL, 2851064434UL,  363057815UL, 4150273260UL,
             802798522UL,  976169071UL, 3393068005UL, 3351056475UL, 2112374092UL,
            2951503395UL,   75264394UL, 3725198372UL, 3171075061UL, 4054667720UL,
            1970282238UL, 2826304822UL,  103324300UL, 1192438872UL, 1645653767UL,
            3276917106UL, 1837939138UL, 3134877800UL, 2607296330UL, 1268482729UL,
            2287079542UL, 1979339044UL, 1955581610UL,  881350673UL, 1823446539UL,
            4048330951UL, 3240075473UL,  118504416UL,  129971735UL, 3591962661UL,
            2091536776UL, 4274939420UL, 1863737156UL, 1265039931UL, 2781464376UL,
             910720625UL, 1800307101UL, 2661350362UL, 1662715020UL,  763261808UL,
            4190901248UL, 3240306562UL, 4071392780UL, 3521238710UL, 2216729195UL,
            2681794184UL, 3704686067UL, 1371630197UL, 1425644030UL, 3214704688UL,
            3409026067UL, 3890926247UL, 1877897829UL, 1214572652UL, 4100786555UL,
            2136104558UL, 1577549957UL, 3713059767UL,  687516317UL, 3474974503UL,
            3987985113UL,  256501997UL, 4031868903UL, 2957819669UL, 2516381723UL,
            3710683262UL, 3903566687UL, 1802116397UL, 3447346253UL,  817250261UL,
            2174395407UL, 1157688427UL,  833430586UL, 1326443572UL, 3317666696UL,
            1989394575UL,  177775310UL, 1326133551UL, 1740093500UL, 1606094052UL,
            3953810581UL, 1161317742UL, 3840154932UL,  239393099UL, 1758212452UL,
            2875981548UL, 1246818203UL, 2828412702UL, 1043079420UL, 3689339235UL,
            3952173912UL, 2266523411UL, 2097168210UL, 2424942254UL, 1977723931UL,
            3191248427UL, 1141148931UL, 2159755709UL, 3163859128UL, 1963754045UL,
            3039521849UL, 2267589370UL,  654469580UL, 3596215250UL, 2001266227UL,
            2863096384UL, 3634136799UL,  679081172UL, 3343228716UL, 3934885515UL,
            3107771246UL, 1617014000UL, 1084059423UL, 3412393079UL,  414885861UL,
            3240116095UL, 3392583127UL, 3068401547UL, 2344996209UL, 3082244636UL,
            2191607617UL, 2883406675UL, 4215546335UL, 3911079206UL, 4057967123UL,
             283341933UL, 1825707351UL, 2761341934UL, 2745563273UL, 2411202686UL,
            2245672085UL, 3028564336UL, 2067237660UL, 1262025285UL, 2431187699UL,
            3343572994UL, 4168260037UL, 1982927877UL, 4031455885UL, 1056162342UL,
            1972927344UL,  754392849UL, 2230139411UL, 2079936925UL, 3743828108UL,
            4126556308UL, 3575289489UL, 2452908300UL, 3518576153UL, 3043225427UL,
             708606088UL, 1678373786UL, 1034219615UL, 2970746029UL, 1701232684UL,
            2201103679UL, 4046337686UL, 2670360177UL, 1398398336UL, 1434766889UL,
             386371989UL, 1626226263UL,  492400945UL,  481950391UL, 1460878895UL,
            2628214666UL,   32289354UL,  725695154UL, 2364791700UL, 4147904097UL,
            1330666671UL,  951572257UL, 4071746789UL, 3472089248UL, 1024391664UL,
            2870237847UL, 2220169758UL, 1458643991UL,  830628738UL, 4203519645UL,
            2158683768UL, 3709772869UL,  404705230UL, 3939314002UL, 1103584614UL,
            4126061147UL, 1901021337UL, 2461209386UL, 2595029040UL, 1891531232UL,
            3316358683UL, 2334074771UL, 1903339503UL,   63429741UL,  836860961UL,
            3923685094UL, 3891307686UL, 4283600816UL, 1560907700UL, 1700586486UL,
            4027428226UL,  389182566UL, 3670491119UL, 3043511022UL, 3298652151UL,
            1549588263UL,  360800661UL, 1032595419UL, 2181736673UL, 2391118495UL,
            3215035908UL, 3641500686UL, 2981094278UL, 1462339155UL, 3669218017UL,
             747623658UL, 1310489742UL, 1661043588UL, 2163895602UL, 3922398827UL,
            2279556901UL, 1656918269UL, 2674387238UL, 2446094403UL, 1095853624UL,
            2009826539UL, 2956799056UL, 2308543818UL, 1400656324UL, 1067418943UL,
            3509245063UL, 2691006827UL, 3696168052UL, 3639848521UL, 2704738475UL,
            3657965231UL, 3531869387UL, 3213091703UL, 1230098623UL, 1764041643UL,
            1318921975UL,  305982504UL, 3180433163UL, 2730063134UL, 3742799449UL,
            2317197147UL,  197078888UL,  839071640UL,  888019515UL, 2229014632UL,
            2173551210UL, 2144468959UL, 3091463255UL,  664070932UL, 1307118288UL,
            2053036022UL, 2738928606UL, 1699931212UL, 1060293457UL, 3942095912UL,
             776198701UL,  505412647UL, 3493765645UL,  829893884UL, 4218593896UL,
            3859797268UL, 1277761100UL, 3078428845UL, 3060646271UL, 1279588255UL,
             509968865UL, 2429696176UL, 1638741938UL, 2735497608UL, 3118275229UL,
            2973402167UL, 1796599314UL, 2822753828UL, 3074430055UL, 2972512995UL,
            2243015695UL, 3479222174UL, 1242301285UL, 2866876508UL, 2293528727UL,
            3936735978UL, 3668861260UL, 1082401638UL, 4107997703UL, 3134202231UL,
            2831454223UL, 3621360765UL, 1943611588UL, 2772460896UL, 4185398010UL,
            1004507088UL, 4018759773UL, 3821877289UL, 2389953204UL, 3886463573UL,
            3373595801UL, 2492703200UL,  647435995UL, 3664523778UL, 3980639492UL,
            4100788114UL, 1445534383UL, 3480168898UL,  405585975UL, 4271719706UL,
            3448968408UL, 2238517786UL, 1669484731UL, 2123645126UL, 3453964614UL,
            2617074879UL,   13995529UL, 1381016801UL, 2528612293UL, 1331221517UL,
            1477363636UL, 3926557641UL, 2237361776UL, 2346477954UL,   53455005UL,
            1071265630UL, 3265780151UL, 2766486889UL, 3726613115UL, 2531736866UL,
            2910433974UL, 3595223566UL, 4275493813UL, 3209923272UL,  497970084UL,
             855160633UL, 2425828858UL,   57729569UL, 2398339897UL,  268041903UL,
            3734888826UL,   91235453UL, 2345061755UL, 3595316747UL,  685652234UL,
            3531007132UL, 4090360456UL, 3341498190UL,  383924394UL, 4030577791UL,
            2456025320UL, 1998244838UL,  482407387UL, 2944560147UL, 3955236550UL,
            4008437911UL, 2464349259UL,  455158039UL,  490555617UL,  840706181UL,
            2978647503UL, 1804206358UL, 1025005403UL, 2142837153UL, 2309021659UL,
            1847609206UL, 3518581333UL,  108081811UL,  992944563UL, 3498090648UL,
            2994051750UL, 2991940712UL,  758795200UL, 1448280814UL,  888276860UL,
            3470929408UL, 3145149528UL,  483815082UL, 2823832788UL, 3764323061UL,
            2144188577UL, 3670832015UL,  344906016UL, 1874881610UL, 1082160472UL,
             203711731UL, 3254093292UL,  365574161UL,  911275170UL,  615087091UL,
            1242348040UL, 1330138764UL, 3638990628UL, 3672526066UL, 3004026353UL,
            2175177269UL, 3340195954UL, 3911004560UL,  956880536UL,  312377411UL,
             280838375UL, 2864682921UL, 1832506819UL, 1775787578UL, 3016957190UL,
             186310818UL, 3483990367UL, 4159255940UL, 2651833909UL, 1283932244UL,
            1512006886UL, 2103626414UL,  209688809UL, 2652161551UL, 2461547664UL,
            2620510199UL,  645182508UL, 2058247389UL, 1394959005UL,  136956934UL,
            1155807397UL, 3701803893UL,  184596033UL, 3688850764UL, 3581259789UL,
            2834785331UL, 1720826765UL, 1135293870UL, 4197167465UL, 2837977447UL,
            2845229313UL, 3654632919UL, 1743103177UL,  583096433UL, 1844273856UL,
            3880118263UL, 2210301412UL,  558291137UL, 3162955681UL, 1733939067UL,
            3740476151UL, 1579067969UL, 2141789151UL, 3677512135UL, 1483341249UL,
             956880446UL, 4250192148UL, 2637623631UL, 1493912249UL, 2537223037UL,
            3246604399UL, 2895045064UL, 3475724970UL, 1857821732UL, 1466989523UL,
            4158684710UL,  905806571UL, 3016878587UL,  875032262UL, 1058447535UL,
            1475580338UL, 3045563026UL, 4024347645UL, 3809538152UL,  361863533UL,
            3955301503UL, 3836208842UL,   69482559UL, 2249036788UL, 3129568965UL,
               1200753UL, 2391268154UL, 3511230203UL, 1768492378UL, 4116779442UL,
             293792430UL, 1667422872UL, 4264595309UL, 2534933783UL,  701873615UL,
            1757791677UL,  448307575UL, 4007528520UL, 4007513845UL, 2779548099UL,
            1560781623UL,  550777012UL, 2698938147UL,  801405929UL, 2927098133UL,
            3730253117UL, 1260454516UL, 2603372086UL, 1157755133UL, 3432365810UL,
             407480530UL, 1294231974UL, 3297404415UL, 2612149380UL,  738197407UL,
            3892088373UL, 2341602773UL,    7592194UL,  348342543UL, 3342111872UL,
            3521969406UL, 2734056325UL,  751069145UL, 3972010741UL, 3899949399UL,
            3155733721UL, 2549441157UL, 2809118078UL, 1492263425UL, 2607114222UL,
            2515464697UL,  367700352UL,  818293454UL, 3477949309UL, 1762073966UL,
            2657244603UL, 3213965552UL, 1001612746UL, 1036362360UL, 2271269021UL,
              98908859UL,  939819937UL,  843394200UL, 3968314675UL,  830345119UL,
            2821766013UL, 4142088541UL, 2744143338UL, 3818660546UL, 3323527541UL,
            1470664619UL, 3674784285UL, 3895701971UL, 1060102331UL, 4141523920UL,
            2492162101UL, 2353153078UL, 1132385908UL, 1838838398UL, 1627034847UL,
             748395117UL, 1949555789UL,  954483925UL, 1968656545UL, 1987154068UL,
            2818175581UL, 2775828346UL,  499336891UL, 2028392560UL, 1470060285UL,
            2518056657UL, 1654542697UL, 3345563418UL,  552345174UL, 4189901821UL,
            3780872161UL, 3853103084UL, 4234929235UL,  536089383UL, 3103678518UL,
             718238933UL, 1331331083UL, 1435090206UL, 1889684288UL, 1462774461UL,
            1537819088UL, 2572325365UL,  370331116UL, 2725029072UL,  756922289UL,
            3608759848UL, 3948633836UL, 3789181628UL, 3327241266UL, 1635558909UL,
            2211726424UL, 1587643204UL, 2077448904UL, 3373812985UL, 4051582185UL,
            3132370070UL,  377711482UL,  992004943UL, 1003802471UL, 2493164736UL,
            1781250968UL, 4148826668UL,  812982322UL, 2276021433UL, 2081555884UL,
            2861351479UL,  421702633UL, 3094615582UL, 2065430361UL, 1294405142UL,
            1470055929UL, 1065051109UL, 3422154346UL,  510532463UL,  584484083UL,
            1605964174UL, 2978459459UL, 4062994652UL,  592525574UL, 2816167511UL,
            3806542768UL, 1839580221UL, 2366229748UL, 2809729394UL, 2086631212UL,
            3886315615UL, 4120460884UL, 3363911317UL, 3866152539UL,  924199459UL,
            3918265448UL, 3675032787UL, 2103485162UL, 3570626418UL, 4205051978UL,
            1229346744UL, 1483779908UL, 2994240418UL, 1296460692UL,  969956593UL,
            3107695883UL, 2748959663UL, 4044113738UL,  767194251UL, 3288615551UL,
            3625423774UL, 1102298349UL, 2726790491UL, 3919602997UL, 3876653085UL,
             752097278UL, 1272297311UL, 1424989193UL, 3485650104UL, 2708742514UL,
            2209576765UL,  231814313UL, 3769493048UL, 1519951132UL, 3005702085UL,
             492505731UL,  315603780UL, 1521149790UL, 1836206806UL,    8923089UL,
            3849311358UL, 3856139290UL, 1006598280UL, 2442103768UL, 3740655309UL,
            3110544479UL, 2326773515UL, 2912274838UL, 3955847546UL, 1102953895UL,
            2795144531UL, 2664788818UL, 1297485889UL, 2975844926UL,  471418468UL,
            3364065649UL, 2457504318UL, 1390435412UL,  130517954UL,  776248116UL,
            3225796107UL, 1551933429UL, 1515865777UL, 2058126181UL, 1068451002UL,
            1905363428UL, 4084892408UL,  960467460UL, 1484204142UL, 3857504453UL,
             947683105UL,  636184077UL, 2958017175UL, 4247848375UL,  588168350UL,
            1377797941UL, 1593939803UL,  714732730UL, 4127411544UL, 3144714541UL,
             310200065UL, 1153028864UL,  630717440UL,  474192919UL,  583394638UL,
            2206060302UL, 2051227633UL, 3356470620UL,  206793455UL,  299622012UL,
             547759498UL,  518154368UL, 1287476184UL, 1668907344UL, 2398107896UL,
            2261319555UL, 3052930212UL, 1275920809UL, 2265433157UL, 2970292714UL,
            4198496198UL,  298206029UL, 1923974956UL, 4021416493UL, 3291131619UL,
            2732097473UL, 1841884448UL, 3698918219UL, 1937141518UL, 3891483873UL,
            3442683595UL, 2094678316UL,  721967122UL, 2002904374UL, 1541332768UL,
            1886968642UL, 2151165910UL, 2472474128UL, 3972590168UL,  378327601UL,
            4082985483UL, 1992757200UL, 3844461420UL, 3483041022UL, 1455851379UL,
             498308106UL, 3258630228UL, 1977086874UL,  598580485UL, 2802264261UL,
            2824852478UL, 2687114899UL, 1815099863UL, 1255085601UL, 2542289479UL,
            3748141675UL, 3290276363UL, 2189933079UL, 1654265127UL, 2803680420UL,
            4248276931UL, 1243875867UL, 2241173763UL, 3038297380UL, 1597301639UL,
            2190196158UL, 2496219619UL, 2119114031UL, 2403493446UL, 1102203512UL,
            1460097018UL,  584419755UL, 4059382205UL, 2374358877UL, 1476960232UL,
            1383481623UL, 3449132780UL, 2111366846UL, 3411377385UL, 3872603731UL,
            1399408425UL, 3203153665UL, 1083384435UL,  201295826UL, 1427860254UL,
            4081776486UL,  320259891UL, 3924338797UL, 2864392125UL, 3495053400UL,
            2999890342UL,  995543149UL, 3213994701UL, 1339779519UL,  258066582UL,
            1819748230UL, 3257648050UL, 1305483209UL, 1240684732UL, 2691672352UL,
            1713056899UL, 2164157758UL, 1778642761UL, 3162455645UL,  447994277UL,
            1335690983UL, 2151511043UL, 1381539085UL, 3196339150UL, 1674815487UL,
            1319762492UL,  700701192UL, 3428082639UL, 3518808088UL, 1749810767UL,
            3422519286UL, 2432877187UL,  770737794UL, 4059924715UL, 2195426623UL,
             259935033UL, 4167398154UL, 3324349141UL,  739599641UL, 3845440202UL,
            3545350790UL, 3612324675UL, 2192230155UL, 1548175971UL,  937162094UL,
             203279111UL,  393686178UL, 4168364525UL, 1599778598UL, 2233988210UL,
            2630437051UL,  515739758UL, 1228695103UL, 1711770102UL, 3982132583UL,
            1622416320UL, 3224168482UL, 1161443667UL,  186554552UL, 4219595220UL,
            2513774714UL, 4222912597UL, 3233812998UL, 3055654171UL, 3961857144UL,
            2565297041UL, 3743687880UL,  868973910UL, 2217774352UL, 2699858314UL,
            2124304791UL,  721186157UL,  212484339UL, 4037384865UL,  524514500UL,
            1436777513UL, 1225661161UL, 2642161873UL, 1487431520UL, 2940228565UL,
            2080942134UL,  908374070UL, 2820970552UL, 1594228495UL,  604039131UL,
            1504532155UL, 2510624986UL, 3034247087UL, 2532269705UL,  220741335UL,
            1127623311UL, 2547541078UL,  126704043UL, 3092086086UL, 3639117079UL,
            1148159661UL, 3734337273UL, 3521598637UL, 3693492906UL, 1125551373UL,
            3847604950UL,  367502671UL, 4143880100UL, 2781734525UL,  811685177UL,
            1939954097UL, 3298647545UL,  141074408UL, 4229084407UL, 3127462752UL,
             467242827UL, 2611487694UL,  457899207UL, 3674387256UL, 3389423083UL,
            3761844294UL, 3127319307UL,  110735185UL,  668485394UL,   68929538UL,
             440108597UL, 2359099634UL, 3921057811UL, 1062337191UL, 2057462132UL,
             757735442UL,  721661736UL, 1075969837UL, 1373986067UL, 3127600229UL,
             265107800UL, 1254380190UL, 2503509045UL,  267081199UL, 1469044117UL,
             918804406UL,  512292947UL, 2553144455UL, 1427553643UL, 1920872478UL,
            2241527618UL, 2556155948UL, 3035212247UL, 4074653117UL,   15041492UL,
            1164794895UL,  320094188UL, 1918433870UL, 2083084809UL, 3168846156UL,
            2652084277UL,  322821672UL, 2894596186UL, 2964847989UL, 2744014862UL,
            2201570264UL, 3977857627UL, 3380703105UL, 3174277560UL,  195439905UL,
            4173380805UL,  212478290UL, 3748429722UL, 1003643790UL,  105725427UL,
            2268847723UL, 2756816290UL,  124651683UL,  973414226UL, 2218060667UL,
            3771155392UL, 3653038793UL,   97751670UL, 2719070801UL, 2269904449UL,
            2649780074UL, 1581241935UL, 4125964342UL,  648976279UL, 2772488746UL,
            3612590868UL, 2975870828UL, 2862756677UL, 2963847772UL,  278116730UL,
            1526571968UL, 2432559256UL,  447115025UL,  100891833UL, 1470984623UL,
            3053438437UL, 1057147666UL, 3842358627UL, 3629670374UL, 3627859257UL,
            3641245524UL,  554945544UL,  412029681UL, 2509880133UL, 1564568268UL,
            4006513335UL, 1088660626UL,  752462740UL, 4186652972UL, 3432980371UL,
            3910985535UL,  100094501UL, 3120362616UL, 1854432382UL,  314688154UL,
             522122712UL, 3026095676UL, 3681962735UL, 1851548627UL, 2153846465UL
        };

        private static readonly ulong[] ExpectedULongArray =
        {
            1213401037UL, 1002219625UL, 3788189515UL,   93095675UL, 1795375119UL,
            1808998847UL, 4076462670UL, 1269636572UL,  373702949UL, 3356118227UL,
            3950917039UL, 1031381744UL, 1194934186UL, 3292904843UL, 3270983098UL,
            4013778474UL, 3819662841UL, 3810490693UL, 2451963113UL,  794766842UL,
             940337222UL, 1333176417UL, 2492894110UL, 3815163219UL, 1954977255UL,
            4081804223UL, 2056609068UL,  572576408UL, 1489430565UL, 1332009465UL,
            2274262584UL, 2603751473UL, 1622933372UL, 1392147195UL, 1452768864UL,
            3805590192UL, 4174204325UL,  178363955UL, 3753630707UL, 3694261297UL,
            3746868623UL,  809795660UL, 1587666085UL, 3047614531UL, 2544206440UL,
             271172382UL, 3577649978UL, 3782077959UL, 1080058267UL, 1609836193UL,
            2395740271UL, 3301016495UL, 2742038099UL, 3721735030UL, 2582511269UL,
            1620909122UL, 2247508014UL,  831480346UL, 3883723715UL,  522929941UL,
            1232038779UL, 2682273014UL, 1769584739UL, 1058456033UL,    6337615UL,
            2609862123UL, 3957258151UL,  508083088UL, 3067603061UL, 1238577947UL,
            1540705381UL, 2363860633UL, 1646973919UL, 2697693571UL, 2094758834UL,
             997864129UL, 3674187401UL, 3555146101UL, 2513681524UL, 2427901422UL,
            4139582134UL, 1249778801UL, 2933775913UL, 1208745439UL,  833054245UL,
             226037094UL, 3361439176UL, 2360034639UL,  731605689UL,  764942843UL,
            2394647425UL,  923867126UL, 4242388902UL, 2271245870UL, 1117874031UL,
            2365323303UL, 2347482462UL, 3033036290UL, 2303957295UL, 1765201161UL,
            4141588795UL,  422117451UL, 2299940481UL,  230156325UL, 4012497835UL,
            3747882391UL, 2934073988UL, 1091932655UL,  342353629UL,    5586442UL,
            3584836627UL, 3656266524UL, 3528714782UL, 4142382649UL, 2464628244UL,
            1297683482UL, 2426249706UL,  575471389UL,  381694163UL, 3351210869UL,
             885374272UL, 1849329256UL, 1419416589UL, 1880533361UL, 3953304143UL,
             897229606UL, 4250664871UL, 4013803380UL, 3290132224UL, 1646393872UL,
            4093440915UL,  280719033UL, 2047322779UL, 1356847086UL,  886856583UL,
            1593677749UL, 3476521925UL, 1970050786UL, 2358740102UL, 1311182559UL,
            2869125693UL,  211865142UL, 4069373597UL, 3554212940UL,  166889574UL,
            4285007264UL, 3050291917UL, 3950870595UL, 1028938734UL, 3486397217UL,
            1896930485UL,  332027367UL,  425164142UL, 4051587231UL, 3868242151UL,
            4216664206UL, 1652064451UL, 1324674794UL,  985265162UL, 4095434235UL,
             597665698UL, 3783258350UL, 2797146500UL, 2006908765UL, 3359031041UL,
            3908532852UL, 3733853616UL, 2335115317UL, 4156443603UL,  858075300UL,
            3399928503UL,  652790337UL, 2026749703UL,  935005793UL, 4246320173UL,
            1080203296UL, 3293981718UL,  983876287UL,  411173312UL, 3019821437UL,
            1983789230UL,  218616616UL,  323041965UL, 2215013039UL, 1401362246UL,
            2622149389UL, 3015201269UL, 1883429325UL,  325278760UL, 3680641326UL,
            2747217382UL, 1598855851UL, 1215319906UL, 3976809275UL, 3831807375UL,
            3385761537UL, 1964266316UL, 2142040207UL, 2502117845UL,  908785041UL,
            1705515573UL, 1915231606UL, 1270163815UL, 2824068016UL, 3610830587UL,
             724504274UL,  308147842UL, 3432514289UL, 1624095708UL, 2718149267UL,
            3175810064UL, 3608031230UL,  764529199UL, 1288567466UL, 2055305201UL,
            2031751267UL, 4028468099UL, 1693536571UL, 3316411300UL, 2605553626UL,
            2902169638UL, 2287627627UL,  934898594UL,  464375985UL, 1110793572UL,
            2578052236UL,  604058164UL, 3850731763UL,  759290885UL,  640351056UL,
             855968309UL,  121241201UL, 1377248171UL, 3471452241UL,  989724146UL,
            1874965893UL, 2818024967UL, 1099221252UL, 2575897924UL, 1211288100UL,
            3386309408UL, 3980049659UL,  121399517UL, 1022796858UL, 1416027009UL,
            1094149839UL,  536118347UL,  457632147UL, 1015209083UL,  464261658UL,
             641239573UL, 1753875184UL, 1323212669UL, 3646085356UL, 1394493575UL,
             164907016UL, 2568646193UL, 1298591334UL, 2596978376UL, 2713346823UL,
            2235719212UL, 3404874420UL, 2926483015UL,  817521639UL, 2325337599UL,
            1190194336UL, 1121711051UL, 2871987415UL, 1996392102UL, 3732019047UL,
            2057754050UL, 1285797620UL, 3525747015UL, 3599316192UL, 1311557910UL,
            4073156812UL, 3334963259UL,  501862533UL, 3187185148UL, 2834493700UL,
            1962918922UL, 3193906273UL, 2607994135UL,  623782957UL, 2954186234UL,
            3505476359UL, 1037699835UL,  528251538UL, 3827319387UL,  537623337UL,
            1608895986UL, 1044022733UL, 2299981400UL, 3038608441UL,  997582371UL,
             723669727UL, 4197437247UL, 3681222029UL, 2193076438UL,  115962248UL,
            4011967047UL, 3467475503UL, 2072481816UL,  126311702UL,  876614208UL,
            3478515577UL, 2646238025UL,   19562665UL,  378399552UL, 3642937993UL,
            2058611917UL, 2111004394UL, 1926866103UL, 2887742563UL,  618906666UL,
            4258407965UL, 2958263973UL, 2419816644UL, 3314626229UL, 1442458721UL,
             558076912UL, 3053848791UL, 3333535560UL,  995592633UL, 1047922908UL,
            2356500762UL, 4207275767UL,  376639869UL, 3529066690UL, 4222332910UL,
            3156552049UL, 1462554360UL,  986966587UL, 1767928657UL, 1429222119UL,
             977695158UL, 2526255648UL, 2982685435UL, 3869803532UL, 1095012039UL,
             267680546UL, 2845102093UL, 1082566213UL, 1332136828UL,  522815606UL,
            4139687737UL,  330964150UL, 3454169628UL, 2201079869UL, 1740196729UL,
            2349409998UL, 2818834539UL, 2120939493UL, 3376126758UL, 2946051667UL,
               4924567UL, 2111031725UL, 3824175290UL, 2473266075UL, 2428982960UL,
            3102587221UL, 3690443407UL,  506689177UL, 2798344888UL, 3525715741UL,
            1539031458UL, 3636702492UL, 1470941841UL,  175810149UL, 2827707744UL,
            2903465077UL, 1650959247UL, 3437601585UL, 3034497372UL,  472118010UL,
            4051978563UL, 1901031796UL, 1409064727UL, 1971741620UL, 2527435792UL,
            3672974796UL, 1393942329UL, 3819796441UL, 1556101329UL, 2052248169UL,
            2557936496UL, 1848902047UL, 2235898955UL, 3973767610UL, 1690868146UL,
            3077322427UL, 2608200001UL,  833944767UL, 3998542921UL, 2008926979UL,
            3802104409UL, 2450570315UL, 2426406043UL, 2198590908UL, 3979654780UL,
            1561617744UL, 1323118922UL, 4070281713UL,  284790709UL, 4141515358UL,
             736142438UL,  329507857UL, 3052265563UL, 2317825753UL, 1742462174UL,
            1594087153UL, 4088013046UL, 4254983338UL,  429583236UL,  972856373UL,
             628743711UL, 2381102700UL, 1051287930UL,  627333394UL, 1597449252UL,
            1382413907UL,  782354833UL, 3434647006UL, 1226629497UL,  906647676UL,
            3929130393UL, 3973610462UL,  342835343UL, 1928368793UL, 1394796823UL,
            1934497469UL, 4289189187UL, 1315021676UL, 2031856979UL, 3587930678UL,
             868328634UL,  694962903UL, 3165451711UL, 3251192370UL,  235342767UL,
            1510092975UL, 4044997301UL, 3984157879UL, 1375892399UL, 1731198083UL,
             897183534UL, 3802763805UL,  814589972UL,  142299678UL, 1207574729UL,
            2721196600UL, 3012142849UL, 3377965874UL, 3938002659UL, 3456025350UL,
            2487959559UL,  904765592UL, 2292812414UL, 2599274412UL, 2178549968UL,
            3271888617UL, 2907425088UL, 1128303638UL, 1801894018UL,  869026091UL,
            2035727974UL, 3148527216UL, 2516657100UL,  942617434UL, 4270550483UL,
            2321278085UL,   11963886UL, 1159717858UL,  953580654UL, 4175912858UL,
            4179683786UL, 2182988288UL, 2504001291UL, 1082949763UL, 1612523311UL,
            1215231374UL, 4175744445UL,  880012230UL, 3989047066UL,  453294526UL,
             586221520UL, 3768508464UL, 1827725669UL, 4241587799UL,  441082319UL,
            1298770459UL, 2497310139UL, 4196896920UL, 1577701951UL, 4254714667UL,
             862249229UL, 2012903970UL, 2096820613UL, 1990849796UL, 1703270117UL,
             852272511UL, 3229237980UL, 3697809515UL,  867672785UL,   17221026UL,
             288848412UL, 2088315744UL, 1440742383UL, 3844911232UL, 2986498221UL,
             814099612UL, 2062983048UL,  229264819UL, 2079291882UL,  323917132UL,
             243717768UL,  356852074UL,  201866217UL,  504556726UL, 3315205738UL,
             450701405UL, 4134049543UL,  856165036UL, 2961305615UL, 1651574742UL,
            2092328938UL,  913251909UL, 2932915112UL,  692676614UL,  691196510UL,
            2546180050UL, 4083776864UL, 2480694391UL, 3163041102UL, 2432664524UL,
            1725997673UL, 3546933482UL,  992733299UL,  592525824UL,  295713684UL,
            2993483017UL,  297440700UL, 3517389226UL, 3599068943UL, 2280378170UL,
            3472102781UL, 2823687084UL, 1072311987UL, 3571812747UL,  550522631UL,
             204762998UL,  965995049UL, 2603455559UL, 2759877645UL, 2499285182UL,
            1878178774UL, 4125269177UL, 3992081280UL, 3879467901UL, 3731604236UL,
            3424565176UL, 2420188662UL, 1230680928UL,  224329290UL, 1789127563UL,
            2356611594UL, 4232337703UL,  437915186UL,  527139689UL,  317221748UL,
            2820346665UL, 2371412394UL, 1091430547UL,  362811554UL, 3954005242UL,
             589811487UL, 3922172475UL, 3682858225UL, 1305600294UL,  330864566UL,
            3811823509UL,  969630425UL, 2242311394UL, 2120243236UL, 3945642955UL,
             444052283UL,  129657022UL,  961406690UL, 4012095830UL, 1569950408UL,
            3057580478UL,   85571849UL, 4169424671UL, 1045676313UL, 4192235593UL,
             155093330UL, 1287782822UL,  186319587UL, 1070205521UL, 1351656704UL,
             701839079UL, 4164473197UL, 1426746528UL, 4013088441UL, 1424854980UL,
            4257176207UL, 2098556313UL, 2714455545UL,  881819196UL, 2149812594UL,
            4224374605UL,  153249521UL,  762156887UL, 3911390861UL, 2314558009UL,
            1509054394UL,  598675012UL, 4193138277UL, 2822137310UL, 1277707950UL,
            2399873326UL,  600095973UL, 1046837556UL, 1727252309UL, 1921065218UL,
            2451546993UL, 4286744527UL, 2429014699UL,  917512105UL, 2146476202UL,
            3314509263UL, 2240592149UL, 1399312633UL, 1924468513UL,  860594147UL,
            2402718697UL, 1090036732UL, 3451548256UL,  631863464UL, 3760041460UL,
             708486403UL, 3771336539UL,  604445173UL,  939789219UL,   80036401UL,
            3590064041UL, 1695161011UL, 3984992088UL, 2535160053UL, 1048040763UL,
             842173014UL,  879261125UL, 3263255701UL, 2693326530UL, 2787136932UL,
            2203029018UL, 2527879816UL,  721332286UL, 3943249838UL, 1439267105UL,
            3407165594UL, 2652438420UL, 2510159896UL, 1895686121UL, 3010461540UL,
            2019063783UL,  377456939UL, 4058553802UL, 3985549007UL, 3990648065UL,
              35891133UL, 1084255889UL, 4058741536UL, 3017262213UL,  854733992UL,
            2961817127UL, 1566191274UL, 1269974535UL, 1061385893UL, 1934296790UL,
            3414627357UL, 1207154213UL, 2169063962UL, 3645713217UL,    1479522UL,
            2689985438UL, 1634530225UL,  864065277UL, 2672726682UL,  859689319UL,
             635323776UL, 3365255313UL, 1569018822UL, 4217263691UL, 4042097075UL,
            3695316210UL, 4138227098UL,  629666892UL, 1351285517UL, 1934369390UL,
            2162647800UL, 2099295887UL, 1271763036UL, 1883303738UL, 2253158917UL,
            2571830301UL, 2021354299UL, 4245348230UL,  930564723UL,  717657347UL,
             860626062UL, 2635560677UL, 3610527454UL,  608615661UL,  869271169UL,
            1236749490UL,  220395479UL, 1578173002UL, 3119440492UL, 4102908789UL,
            2883369051UL,  443494207UL, 3066476468UL, 2053051671UL, 3495052118UL,
            2931697191UL, 2445226742UL, 1168952815UL, 2722178203UL,  227518833UL,
            1821405664UL, 1984333173UL,  178408471UL, 1649711654UL, 2741506961UL,
            3736312552UL, 3057151173UL, 3610556956UL, 3408112927UL, 1335860450UL,
            3378168144UL, 3939908355UL, 3599806580UL,  879059944UL, 3157765948UL,
            3569390375UL, 3320093939UL,  453056499UL,  294491075UL, 3502570840UL,
            2351671522UL, 2097831502UL,  520013670UL, 4122641375UL,  360833785UL,
            4032004203UL,  605909800UL, 2821812620UL,  768719594UL,  192414323UL,
            1688520714UL,  157860104UL, 3327948248UL, 1240329952UL, 3212947902UL,
             976889466UL, 3548320346UL, 1762646325UL,  342962173UL, 1003544616UL,
              65126654UL,  471424221UL, 4061906609UL,  350603531UL, 2047537397UL,
            2460383607UL, 1124011704UL, 2239298963UL, 2401787777UL, 2395657063UL,
            2809606252UL, 4011206815UL, 2103078498UL,  849681665UL, 3239658138UL,
             454377878UL,  318962394UL,  134678707UL, 1645848595UL, 3688219627UL,
            1119459724UL, 2212606443UL,  243069356UL, 4096678109UL, 4049950924UL,
            1430188855UL, 3376687605UL, 2713071284UL,  397063508UL,  202199470UL,
            3207123536UL, 3523498674UL, 2144158622UL, 1156392159UL, 2897908607UL,
            1400157671UL, 2394352073UL,  990056620UL, 3144770445UL, 1536804654UL,
            4089632658UL, 4055427606UL, 2183978336UL, 2970981982UL, 3525778176UL,
            3366552852UL, 3242943082UL, 2117204540UL, 3996086902UL, 2746280565UL,
            1949889669UL, 2949740123UL, 3138662162UL,   50154986UL,   94445067UL,
            3860163230UL, 1398775754UL, 1275595861UL, 3221456668UL, 1615414812UL,
            1426209298UL, 1509166518UL, 2886331650UL, 1361931038UL, 4247915749UL,
            2235497887UL, 1145437786UL, 2190827817UL, 4167305565UL, 3361795949UL,
            4120512272UL,  517650201UL, 2794964517UL, 4067973019UL,  799550940UL,
            2100720011UL, 1656535186UL, 3554801317UL, 2273864605UL, 3721246389UL,
            1848650174UL, 4111661788UL,  252555371UL, 1479149169UL, 4207511886UL,
            3771592078UL, 1085550976UL, 1444352474UL,  361783830UL,  197262084UL,
            1872651058UL,  510129635UL,  643408024UL, 2380283299UL, 3537991311UL,
            4108692298UL, 2712439525UL, 4185893506UL, 3127244235UL, 1545177637UL,
             775067312UL, 1234633845UL, 2293720577UL, 3778045647UL, 1893569650UL,
             955596059UL, 3130502632UL, 3512322487UL, 2457236623UL, 3247250980UL,
            3633960328UL, 2429641312UL,  577152631UL, 3611721077UL, 1890309659UL,
             875637133UL, 2890867574UL,  152541005UL, 1205356740UL,  856777352UL,
            1962130546UL, 4228049260UL, 1832751323UL, 1136560654UL, 2320155579UL,
             749675601UL, 3954333865UL, 1704165610UL, 2177165756UL, 1966195240UL,
            3547474042UL,  501064771UL,  290232796UL, 3418362513UL, 1609407374UL,
            2133025968UL, 3544255562UL, 4049262104UL, 4016434687UL, 2026338560UL,
            1105071235UL, 3970613579UL, 3009120745UL,  117571106UL, 2728067687UL,
            4254524777UL, 3624601829UL,  684100681UL, 3881760944UL, 2157408568UL,
            1633150817UL, 3607482443UL, 1195137474UL,  838063811UL, 2671430283UL,
            3779028933UL,  184059818UL, 1998815784UL,  754698425UL,  879596005UL,
             855239848UL, 1318366942UL, 2498942515UL,  687484589UL, 1378955192UL,
             895763157UL, 3400833754UL, 2912732490UL, 2791045459UL,  639561355UL,
             638097599UL,  991007343UL, 1112019452UL, 1450713999UL,  851566038UL,
            3014206548UL, 1019682192UL,  259110455UL, 4013700475UL, 1137615360UL,
            2333427341UL, 1665782564UL,  407615411UL, 1645678339UL, 1712572929UL,
             427221509UL, 1115350847UL,  183410243UL, 3117255003UL, 2926399354UL,
             357446483UL, 3130495927UL, 1177477989UL, 1487365345UL, 3225554801UL,
            2764909127UL, 1893438844UL, 1433636831UL, 1121233427UL,  212375185UL,
            2235354016UL,  440100203UL, 1201781269UL, 1401424411UL, 4256059105UL,
            3476447550UL, 3958909757UL,  603116189UL, 1992155441UL, 1450512874UL,
            1301692771UL, 2969787235UL, 4092530603UL, 1954938445UL,  873105978UL,
            3346443957UL,  300451651UL,  517315823UL, 3784036939UL,  166169681UL,
            3888022637UL, 3342589770UL, 4248214348UL, 3902418067UL, 1571362573UL,
             778966034UL, 3710173278UL, 4226663802UL, 2983892053UL,  625306958UL
        };

        /// <summary>
        /// Taken from http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT/index.html,
        /// <para />
        /// SFMT-src-1.3.3.zip, SFMT.86243.out.txt.
        /// </summary>
        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_NextUInt_ReferenceImplementationTest()
        {
            // int ulongLength = ExpectedULong.Length;
            const int ulongLength = 100;
            var gen = new MersenneTwisterSfmt86243UniformRandom(1234);
            for (int i = 0; i < ulongLength; ++i)
            {
                ulong expected = ExpectedULong[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation uint: index={i}, actual={actual} expected={expected}"));
            }

            // int ulongArrayLength = ExpectedULongArray.Length;
            const int ulongArrayLength = 100;
            gen = new MersenneTwisterSfmt86243UniformRandom(new[] { 0x1234, 0x5678, 0x9abc, 0xdef0 });
            for (int i = 0; i < ulongArrayLength; ++i)
            {
                ulong expected = ExpectedULongArray[i];
                ulong actual = gen.NextUInt();
                Assert.AreEqual(expected, actual,
                    Invariant($"Reference implementation array: index={i}, actual={actual} expected={expected}"));
            }
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_NextDouble_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt86243UniformRandom(Seed);
            double expected = 0.5;

            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 4;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 6;
            actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextDouble(4, 8);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_NextInt_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt86243UniformRandom(Seed);

            double expected = int.MaxValue / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt();
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 1: actual={actual}, expected={expected}"));

            expected = 400d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value 2: actual={actual}, expected={expected}"));

            expected = 600d;
            actual = 0d;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextInt(400, 800);
            }

            actual /= Count;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value 3: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_NextBoolean_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt86243UniformRandom(Seed);

            double expected = Count / 2d;
            double actual = 0;
            for (int i = 0; i < Count; ++i)
            {
                actual += gen.NextBoolean() ? 1 : 0;
            }

            Doubles.AreEqual(expected / actual, 1, 1e-1,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_NextBytes_GeneratedMany_MeanHasCorrectValue()
        {
            var gen = new MersenneTwisterSfmt86243UniformRandom(Seed);

            double expected = 128;
            double actual = 0;
            var array = new byte[32];

            for (int i = 0; i < Count; ++i)
            {
                gen.NextBytes(array);
                actual = array.Aggregate(actual, (current, b) => current + b);
            }

            actual /= Count * 32;
            Doubles.AreEqual(expected / actual, 1, 1e-2,
                Invariant($"Mean value: actual={actual}, expected={expected}"));
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_Seed_SameSeed_SameValue()
        {
            var gen1 = new MersenneTwisterSfmt86243UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt86243UniformRandom(Seed);
            int actual = gen2.NextInt();

            Assert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_Seed_DifferentSeed_DifferentValue()
        {
            var gen1 = new MersenneTwisterSfmt86243UniformRandom(Seed);
            int expected = gen1.NextInt();

            var gen2 = new MersenneTwisterSfmt86243UniformRandom(Seed + 1);
            int actual = gen2.NextInt();

            Assert.AreNotEqual(expected, actual);
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_CanReset_ReturnsTrue()
        {
            var gen = new MersenneTwisterSfmt86243UniformRandom();

            Assert.IsTrue(gen.CanReset);
        }

        [TestMethod]
        public void MersenneTwisterSfmt86243UniformRandom_Reset_ValueGeneratedThenReset_SameValueGenerated()
        {
            var gen = new MersenneTwisterSfmt86243UniformRandom();
            int expected = gen.NextInt();

            gen.Reset();
            int actual = gen.NextInt();

            Assert.AreEqual(expected, actual);
        }
    }
}
